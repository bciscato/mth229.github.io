<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>MTH229 with Julia - 10&nbsp; Numeric integration with Julia</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./mth232.html" rel="next">
<link href="./extrema.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Numeric integration with Julia</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">MTH229 with Julia</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/MTH229/mth229.github.io/tree/master/quarto/" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">MTH229 notes</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./calculator.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Julia as a calculator</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Functions in Julia</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./graphing.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Graphing functions with Julia</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./zeros.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Solving for zeros with julia</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./limits.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Investigating limits with Julia</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./derivatives.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Approximate derivatives in Julia</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./first-second-derivatives.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Exploring first and second derivatives with Julia</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./newton.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Newton’s method using julia</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./extrema.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Maximization and minimization with Julia</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./integration.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Numeric integration with Julia</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">MTH232 and 233</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mth232.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Notes on MTH 232 and Julia</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mth233.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Notes on MTH 233 and Julia</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="toc-section-number">10.1</span>  Introduction</a></li>
  <li><a href="#riemann-sums" id="toc-riemann-sums" class="nav-link" data-scroll-target="#riemann-sums"><span class="toc-section-number">10.2</span>  Riemann sums</a>
  <ul class="collapse">
  <li><a href="#practice" id="toc-practice" class="nav-link" data-scroll-target="#practice"><span class="toc-section-number">10.2.1</span>  Practice</a></li>
  </ul></li>
  <li><a href="#integrate-function" id="toc-integrate-function" class="nav-link" data-scroll-target="#integrate-function"><span class="toc-section-number">10.3</span>  Integrate function</a>
  <ul class="collapse">
  <li><a href="#the-integrate-function-in-action" id="toc-the-integrate-function-in-action" class="nav-link" data-scroll-target="#the-integrate-function-in-action"><span class="toc-section-number">10.3.1</span>  The integrate function in action</a></li>
  <li><a href="#left-versus-right" id="toc-left-versus-right" class="nav-link" data-scroll-target="#left-versus-right"><span class="toc-section-number">10.3.2</span>  left versus right</a></li>
  <li><a href="#practice-1" id="toc-practice-1" class="nav-link" data-scroll-target="#practice-1"><span class="toc-section-number">10.3.3</span>  Practice</a></li>
  </ul></li>
  <li><a href="#improvements-to-the-rectangle-method" id="toc-improvements-to-the-rectangle-method" class="nav-link" data-scroll-target="#improvements-to-the-rectangle-method"><span class="toc-section-number">10.4</span>  Improvements to the rectangle method</a>
  <ul class="collapse">
  <li><a href="#trapezoid-and-simpsons-rule" id="toc-trapezoid-and-simpsons-rule" class="nav-link" data-scroll-target="#trapezoid-and-simpsons-rule"><span class="toc-section-number">10.4.1</span>  Trapezoid and Simpson’s rule</a></li>
  <li><a href="#simpsons-rule" id="toc-simpsons-rule" class="nav-link" data-scroll-target="#simpsons-rule"><span class="toc-section-number">10.4.2</span>  Simpson’s rule</a></li>
  <li><a href="#error" id="toc-error" class="nav-link" data-scroll-target="#error"><span class="toc-section-number">10.4.3</span>  Error</a></li>
  <li><a href="#practice-2" id="toc-practice-2" class="nav-link" data-scroll-target="#practice-2"><span class="toc-section-number">10.4.4</span>  Practice</a></li>
  </ul></li>
  <li><a href="#the-quadgk-function" id="toc-the-quadgk-function" class="nav-link" data-scroll-target="#the-quadgk-function"><span class="toc-section-number">10.5</span>  The quadgk function</a>
  <ul class="collapse">
  <li><a href="#practice-3" id="toc-practice-3" class="nav-link" data-scroll-target="#practice-3"><span class="toc-section-number">10.5.1</span>  Practice</a></li>
  </ul></li>
  <li><a href="#applications" id="toc-applications" class="nav-link" data-scroll-target="#applications"><span class="toc-section-number">10.6</span>  Applications</a>
  <ul class="collapse">
  <li><a href="#volume-as-a-function-of-radius." id="toc-volume-as-a-function-of-radius." class="nav-link" data-scroll-target="#volume-as-a-function-of-radius."><span class="toc-section-number">10.6.1</span>  Volume as a function of radius.</a></li>
  <li><a href="#practice-4" id="toc-practice-4" class="nav-link" data-scroll-target="#practice-4"><span class="toc-section-number">10.6.2</span>  Practice</a></li>
  </ul></li>
  <li><a href="#example-arc-length" id="toc-example-arc-length" class="nav-link" data-scroll-target="#example-arc-length"><span class="toc-section-number">10.7</span>  Example, arc length</a>
  <ul class="collapse">
  <li><a href="#example-the-catenary-shape" id="toc-example-the-catenary-shape" class="nav-link" data-scroll-target="#example-the-catenary-shape"><span class="toc-section-number">10.7.1</span>  Example: the catenary shape</a></li>
  <li><a href="#practice-5" id="toc-practice-5" class="nav-link" data-scroll-target="#practice-5"><span class="toc-section-number">10.7.2</span>  Practice</a></li>
  </ul></li>
  <li><a href="#gauss-quadrature-using-weights" id="toc-gauss-quadrature-using-weights" class="nav-link" data-scroll-target="#gauss-quadrature-using-weights"><span class="toc-section-number">10.8</span>  Gauss quadrature, Using weights</a>
  <ul class="collapse">
  <li><a href="#adaptive-integration" id="toc-adaptive-integration" class="nav-link" data-scroll-target="#adaptive-integration"><span class="toc-section-number">10.8.1</span>  Adaptive integration</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/MTH229/mth229.github.io/edit/master/quarto/integration.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/MTH229/mth229.github.io/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Numeric integration with Julia</span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<div class="cell" data-execution_count="1">
<div class="cell-output cell-output-error">
<pre><code>LoadError: ArgumentError: Package SymPy not found in current path.
- Run `import Pkg; Pkg.add("SymPy")` to install the SymPy package.</code></pre>
</div>
</div>
<p><br> A notebook for this material: <a href="https://raw.githubusercontent.com/mth229/229-projects/master/10-integration.ipynb">ipynb</a> <a href="./229-projects/10-integration.html">(Pluto html)</a> <a href="./229-projects/10-integration-pluto-commentary.html">(With commentary)</a></p>
<section id="introduction" class="level2" data-number="10.1">
<h2 data-number="10.1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">10.1</span> Introduction</h2>
<p>Let <span class="math inline">\(f(x)\)</span> be some non-negative, continuous function over the interval <span class="math inline">\([a,b]\)</span>. The area under the graph of <span class="math inline">\(f(x)\)</span> is given by the definite integral:</p>
<p><span class="math display">\[
\text{Area under f} = \int_a^b f(x) dx
\]</span></p>
<p>Computing this area is <em>often</em> made easier with the Fundamental Theorem of Calculus which states in one form that one can compute a definite integral through knowledge of an antiderivative. In particular, if <span class="math inline">\(F(x)\)</span> is an antiderivative for <span class="math inline">\(f(x)\)</span>, a continuous function, then</p>
<p><span class="math display">\[
\int_a^b f(x) dx = F(b) - F(a).
\]</span></p>
<p>This is great as long as some antiderivative is known. There are several different techniques for finding antiderivatives. The <code>integrate</code> function in the <code>SymPy</code> package can do many of them:</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">MTH229</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Plots</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>ERROR: LoadError: InitError: </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>PyError (PyImport_ImportModule

The Python package sympy could not be imported by pyimport. Usually this means
that you did not install sympy in the Python version being used by PyCall.

PyCall is currently configured to use the Python version at:

/opt/hostedtoolcache/Python/3.10.6/x64/bin/python3

and you should use whatever mechanism you usually use (apt-get, pip, conda,
etcetera) to install the Python package containing the sympy module.

One alternative is to re-configure PyCall to use a different Python
version on your system: set ENV["PYTHON"] to the path/name of the python
executable you want to use, run Pkg.build("PyCall"), and re-launch Julia.

Another alternative is to configure PyCall to use a Julia-specific Python
distribution via the Conda.jl package (which installs a private Anaconda
Python distribution), which has the advantage that packages can be installed
and kept up-to-date via Julia.  As explained in the PyCall documentation,
set ENV["PYTHON"]="", run Pkg.build("PyCall"), and re-launch Julia. Then,
To install the sympy module, you can use `pyimport_conda("sympy", PKG)`,
where PKG is the Anaconda package that contains the module sympy,
or alternatively you can use the Conda package directly (via
`using Conda` followed by `Conda.add` etcetera).

) &lt;class 'ModuleNotFoundError'&gt;
ModuleNotFoundError("No module named 'sympy'")

Stacktrace:
  [1] pyimport(name::</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>String)
    @ PyCall ~/.julia/packages/PyCall/ygXW2/src/PyCall.jl:558
  [2] pyimport_conda(modulename::String, condapkg::String, channel::String)
    @ PyCall ~/.julia/packages/PyCall/ygXW2/src/PyCall.jl:716
  [3] pyimport_conda
    @ ~/.julia/packages/PyCall/ygXW2/src/PyCall.jl:715 [inlined]
  [4] __init__()
    @ SymPy ~/.julia/packages/SymPy/7cg6m/src/SymPy.jl:128
  [5] _include_from_serialized(pkg::Base.PkgId, path::String, depmods::Vector{Any})
    @ Base ./loading.jl:831
  [6] _require_search_from_serialized(pkg::Base.PkgId, sourcepath::String, build_id::UInt64)
    @ Base ./loading.jl:1039
  [7] _require(pkg::Base.PkgId)
    @ Base ./loading.jl:1315
  [8] _require_prelocked(uuidkey::Base.PkgId)
    @ Base ./loading.jl:1200
  [9] macro expansion
    @ ./loading.jl:1180 [inlined]
 [10] macro expansion
    @ ./lock.jl:223 [inlined]
 [11] require(into::Module, mod::Symbol)
    @ Base ./loading.jl:1144
 [12] include
    @ ./Base.jl:419 [inlined]
 [13] include_package_for_output(pkg::Base.PkgId, input::String, depot_path::Vector{String}, dl_load_path::Vector{String}, load_path::Vector{String}, concrete_deps::Vector{Pair{Base.PkgId, UInt64}}, source::Nothing)
    @ Base ./loading.jl:1554
 [14] top-level scope
    @ stdin:1
during initialization of module SymPy
in expression starting at /home/runner/.julia/packages/MTH229/6VRYU/src/MTH229.jl:1
in expression starting at stdin:1</code></pre>
</div>
<div class="cell-output cell-output-error">
<pre><code>LoadError: Failed to precompile MTH229 [ebaf19f5-aa55-568f-9bb2-d6722dad893b] to /home/runner/.julia/compiled/v1.8/MTH229/jl_QsyzMD.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(x) <span class="op">=</span> x<span class="op">^</span><span class="fl">3</span> <span class="op">-</span> <span class="fu">cos</span>(x) <span class="op">+</span> <span class="fu">x*log</span>(x)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="pp">@syms</span> x</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">integrate</span>(<span class="fu">f</span>(x), x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>LoadError: LoadError: UndefVarError: @syms not defined
in expression starting at In[5]:2</code></pre>
</div>
</div>
<p>To find the definite integral, say from <span class="math inline">\(1\)</span> to <span class="math inline">\(10\)</span> we have:</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">integrate</span>(<span class="fu">f</span>(x), (x, <span class="fl">1</span>, <span class="fl">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: x not defined</code></pre>
</div>
</div>
<p>If all functions had antiderivatives that could be found symbolically, there wouldn’t be much more to say. However, it is a fact of life that not all nice functions will have an antiderivative in a convenient form. A test for such functions is provided in <a href="http://en.wikipedia.org/wiki/Risch_algorithm">Risch’s algorithm</a>. In cases where no workable antiderivative is available, the above approach is of no help. Rather, to find the area one can turn to numeric approximations that progressively get better as more approximations are taken.</p>
<p>One such approximation is given by the familiar Riemann sums, which we will look at here. However, the problem of trying to find the area of geometric figures did not start with Riemann some 150 years ago, indeed it has a much longer history. In the time of Pythagorus the idea of calculating area was one of being able to construct a square of equal area to a figure. This was known as <em>quadrature</em>. Finding such answers for figures bounded by curves was difficult, though <a href="http://en.wikipedia.org/wiki/The_Quadrature_of_the_Parabola">Archimedes</a> effectively computed the area under <span class="math inline">\(f(x) = x^2\)</span> about 2,000 years before Riemann sums using triangles, not rectangles to approximate the area. By medieval Europe, the term <em>quadrature</em> evolved to be the computation of an area by any means. For example, <a href="http://en.wikipedia.org/wiki/Quadrature_(mathematics)">Galileo and Roberval</a> found the area bounded by a cycloid arch. Along the way, other approximations were used. We will see those due to Simpson and Gauss, both predating Riemann.</p>
</section>
<section id="riemann-sums" class="level2" data-number="10.2">
<h2 data-number="10.2" class="anchored" data-anchor-id="riemann-sums"><span class="header-section-number">10.2</span> Riemann sums</h2>
<p>In 1854 Riemann was the first to give a rigorous definition of the integral of a continuous function on a closed interval, the problem we wish to solve here, using the concept of a <em>Riemann sum</em>. A Riemann sum is one of the simplest to understand approximations to the area under a curve. The basic idea is that the interval <span class="math inline">\([a,b]\)</span> is partitioned through points <span class="math inline">\(a = x_0 &lt; x_1 &lt; \cdots x_n = b\)</span> and the area under <span class="math inline">\(f(x)\)</span> between <span class="math inline">\(x_i\)</span> and <span class="math inline">\(x_{i+1}\)</span> is approximated by a rectangle with the base <span class="math inline">\(x_{i+1} - x_i\)</span> and height given by <span class="math inline">\(f(x_i^*)\)</span>, where <span class="math inline">\(x_i^*\)</span> is some point in the interval <span class="math inline">\([x_i, x_{i+1}]\)</span>. Typical choices are the left point or the right point of the interval, or the <span class="math inline">\(x\)</span> value which minizes or maximizes <span class="math inline">\(f\)</span> over the interval. The figure shows these four choices for some sample function. For a <em>Riemann integrable</em> function, such as a continuous function on <span class="math inline">\([a,b]\)</span>, any of the choices will yield the same value as the partition’s mesh shrinks to <span class="math inline">\(0\)</span>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figures/integration/riemann_choice.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Riemann</figcaption><p></p>
</figure>
</div>
<p>As with other limits, we can numerically approximate the limit by computing the Riemann sum for some partition. The steps for this include:</p>
<ul>
<li>creating a partition of <span class="math inline">\([a,b]\)</span>. We will use evenly spaced points for convenience.</li>
<li>Selecting the <span class="math inline">\(x_i^*\)</span> within the partition</li>
<li>Computing the values <span class="math inline">\(f(x_i^*)(x_{i+1} - x_i)\)</span> for each <span class="math inline">\(i\)</span></li>
<li>adding these values up</li>
</ul>
<p>If we partition <span class="math inline">\([a,b]\)</span> into <span class="math inline">\(n\)</span> same sized intervals, then each has length <span class="math inline">\(\delta = (b-a)/n\)</span> and so the points are separated by this amount. As such, we can choose our <span class="math inline">\(a = x_0 &lt; x_1 &lt; \dots &lt; x_n = b\)</span> with commands like:</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>a, b, n <span class="op">=</span> <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">5</span>;</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>delta <span class="op">=</span> (b<span class="op">-</span>a)<span class="op">/</span>n;</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>xs <span class="op">=</span> a <span class="op">.+</span> (<span class="fl">0</span><span class="op">:</span>n) <span class="op">*</span> delta</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>1.0:0.4:3.0</code></pre>
</div>
</div>
<p>To apply a function to a range of values, we may use a map, a comprehension, a <code>for</code> loop or the “dot” notation. We will use broadcasting here. Recall, the syntax:</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(x) <span class="op">=</span> x<span class="op">^</span><span class="fl">2</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>fxs <span class="op">=</span> <span class="fu">f</span>.(xs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>6-element Vector{Float64}:
 1.0
 1.9599999999999997
 3.24
 4.840000000000001
 6.760000000000001
 9.0</code></pre>
</div>
</div>
<p>Now to add the numbers up. For this task, the <code>sum</code> function is available</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(fxs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>26.8</code></pre>
</div>
</div>
<p>Okay, just one subtlety, we really only want the points</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>[ a <span class="op">.+</span> (<span class="fl">0</span><span class="op">:</span>n<span class="op">-</span><span class="fl">1</span>) <span class="op">*</span> delta ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>1-element Vector{StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}:
 1.0:0.4:2.6</code></pre>
</div>
</div>
<p>for the left Riemann sum and the points</p>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>[ a <span class="op">.+</span> (<span class="fl">1</span><span class="op">:</span>n) <span class="op">*</span> delta ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>1-element Vector{StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}:
 1.4:0.4:3.0</code></pre>
</div>
</div>
<p>for the right.</p>
<p>Putting this together, here are commands to approximate the area under the curve <span class="math inline">\(f(x)=x^2\)</span> using 10 left Riemann sums:</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(x) <span class="op">=</span> x<span class="op">^</span><span class="fl">2</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>a, b, n <span class="op">=</span> <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">10</span>;        <span class="co">## note n=10</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>delta <span class="op">=</span> (b <span class="op">-</span> a)<span class="op">/</span>n;         <span class="co">## nothing to change below here</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>xs <span class="op">=</span> a <span class="op">.+</span> (<span class="fl">0</span><span class="op">:</span>n<span class="op">-</span><span class="fl">1</span>) <span class="op">*</span> delta;          <span class="co">## n, right is 1:n * delta</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>fxs <span class="op">=</span> <span class="fu">f</span>.(xs);</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(fxs) <span class="op">*</span> delta</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>7.88</code></pre>
</div>
</div>
<p>We compare this value to the known value from the Fundamental Theorem of Calculus, as <span class="math inline">\(F(x) = x^3/3\)</span> is an antiderivative:</p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">F</span>(x) <span class="op">=</span> x<span class="op">^</span><span class="fl">3</span><span class="op">/</span><span class="fl">3</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">F</span>(b) <span class="op">-</span> <span class="fu">F</span>(a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>8.666666666666666</code></pre>
</div>
</div>
<p>Boy, not too close. We need a better approximation of course. This can be achieved by using larger values for <code>n</code>.</p>
<section id="practice" class="level3" data-number="10.2.1">
<h3 data-number="10.2.1" class="anchored" data-anchor-id="practice"><span class="header-section-number">10.2.1</span> Practice</h3>
<section id="question" class="level4">
<h4 class="anchored" data-anchor-id="question">Question</h4>
<p>Repeat with n=100</p>
<p>For the same problem, let <span class="math inline">\(n=100\)</span>. What do you get?</p>
<div class="cell" data-execution_count="13">
<div class="cell-output cell-output-display" data-execution_count="14">
<form class="mx-2 my-3 mw-100" name="WeaveQuestion" data-id="a6806Zmm" data-controltype="">
  <div class="form-group ">
    <div class="controls">
      <div class="form" id="controls_a6806Zmm">
        <div style="padding-top: 5px">
    <br>
<div class="input-group">
    <input id="a6806Zmm" type="number" class="form-control" placeholder="Numeric answer">
</div>

    
        </div>
      </div>
      <div id="a6806Zmm_message" style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text="text/javascript">
document.getElementById("a6806Zmm").addEventListener("change", function() {
  var correct = (Math.abs(this.value - 8.5868) <= 0.0001);
  var msgBox = document.getElementById('a6806Zmm_message');
    if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_a6806Zmm")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_a6806Zmm")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

});

</script>
</div>
</div>
</section>
<section id="question-1" class="level4">
<h4 class="anchored" data-anchor-id="question-1">Question</h4>
<p>Repeat with n=1,000</p>
<p>For the same problem, let <span class="math inline">\(n=1000\)</span>. What do you get?</p>
<div class="cell" data-execution_count="14">
<div class="cell-output cell-output-display" data-execution_count="15">
<form class="mx-2 my-3 mw-100" name="WeaveQuestion" data-id="k1Am1P01" data-controltype="">
  <div class="form-group ">
    <div class="controls">
      <div class="form" id="controls_k1Am1P01">
        <div style="padding-top: 5px">
    <br>
<div class="input-group">
    <input id="k1Am1P01" type="number" class="form-control" placeholder="Numeric answer">
</div>

    
        </div>
      </div>
      <div id="k1Am1P01_message" style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text="text/javascript">
document.getElementById("k1Am1P01").addEventListener("change", function() {
  var correct = (Math.abs(this.value - 8.658668) <= 0.0001);
  var msgBox = document.getElementById('k1Am1P01_message');
    if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_k1Am1P01")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_k1Am1P01")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

});

</script>
</div>
</div>
</section>
<section id="question-2" class="level4">
<h4 class="anchored" data-anchor-id="question-2">Question</h4>
<p>Repeat with n=10,000</p>
<p>For the same problem, let <span class="math inline">\(n=10,000\)</span>. is the difference between the answer and the actual answer within <span class="math inline">\(0.001\)</span>?</p>
<div class="cell" data-execution_count="15">
<div class="cell-output cell-output-display" data-execution_count="16">
<form class="mx-2 my-3 mw-100" name="WeaveQuestion" data-id="XUXTC3i2" data-controltype="">
  <div class="form-group ">
    <div class="controls">
      <div class="form" id="controls_XUXTC3i2">
        <div style="padding-top: 5px">
    <div class="form-check">
    <label class="form-check-label" for="radio_XUXTC3i2_1">
      <input class="form-check-input" type="radio" name="radio_XUXTC3i2" id="radio_XUXTC3i2_1" value="1">
      
      <span class="label-body px-1">
        true
      </span>
    </label>
</div>
<div class="form-check">
    <label class="form-check-label" for="radio_XUXTC3i2_2">
      <input class="form-check-input" type="radio" name="radio_XUXTC3i2" id="radio_XUXTC3i2_2" value="2">
      
      <span class="label-body px-1">
        false
      </span>
    </label>
</div>

    
        </div>
      </div>
      <div id="XUXTC3i2_message" style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text="text/javascript">
document.querySelectorAll('input[name="radio_XUXTC3i2"]').forEach(function(rb) {
rb.addEventListener("change", function() {
    var correct = rb.value == 1;
    var msgBox = document.getElementById('XUXTC3i2_message');
      if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_XUXTC3i2")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_XUXTC3i2")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

})});

</script>
</div>
</div>
</section>
<section id="question-3" class="level4">
<h4 class="anchored" data-anchor-id="question-3">Question</h4>
<p>How big should n be? (Strang)</p>
<p>Let <span class="math inline">\(f(x) = (10 + \cos(2\pi x))^{-1}\)</span>. For the integral over <span class="math inline">\([0,1]\)</span>, the known answer is <span class="math inline">\(1/\sqrt{99}\)</span>. How big must <span class="math inline">\(n\)</span> be so that the error in the Riemann sum is less than <span class="math inline">\(10^{-8}\)</span>?</p>
<div class="cell" data-execution_count="16">
<div class="cell-output cell-output-display" data-execution_count="17">
<form class="mx-2 my-3 mw-100" name="WeaveQuestion" data-id="Xi7An8UB" data-controltype="">
  <div class="form-group ">
    <div class="controls">
      <div class="form" id="controls_Xi7An8UB">
        <div style="padding-top: 5px">
    <div class="form-check">
    <label class="form-check-label" for="radio_Xi7An8UB_1">
      <input class="form-check-input" type="radio" name="radio_Xi7An8UB" id="radio_Xi7An8UB_1" value="1">
      
      <span class="label-body px-1">
        5
      </span>
    </label>
</div>
<div class="form-check">
    <label class="form-check-label" for="radio_Xi7An8UB_2">
      <input class="form-check-input" type="radio" name="radio_Xi7An8UB" id="radio_Xi7An8UB_2" value="2">
      
      <span class="label-body px-1">
        10000
      </span>
    </label>
</div>
<div class="form-check">
    <label class="form-check-label" for="radio_Xi7An8UB_3">
      <input class="form-check-input" type="radio" name="radio_Xi7An8UB" id="radio_Xi7An8UB_3" value="3">
      
      <span class="label-body px-1">
        10
      </span>
    </label>
</div>
<div class="form-check">
    <label class="form-check-label" for="radio_Xi7An8UB_4">
      <input class="form-check-input" type="radio" name="radio_Xi7An8UB" id="radio_Xi7An8UB_4" value="4">
      
      <span class="label-body px-1">
        1000
      </span>
    </label>
</div>
<div class="form-check">
    <label class="form-check-label" for="radio_Xi7An8UB_5">
      <input class="form-check-input" type="radio" name="radio_Xi7An8UB" id="radio_Xi7An8UB_5" value="5">
      
      <span class="label-body px-1">
        100
      </span>
    </label>
</div>

    
        </div>
      </div>
      <div id="Xi7An8UB_message" style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text="text/javascript">
document.querySelectorAll('input[name="radio_Xi7An8UB"]').forEach(function(rb) {
rb.addEventListener("change", function() {
    var correct = rb.value == 3;
    var msgBox = document.getElementById('Xi7An8UB_message');
      if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_Xi7An8UB")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_Xi7An8UB")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

})});

</script>
</div>
</div>
</section>
</section>
</section>
<section id="integrate-function" class="level2" data-number="10.3">
<h2 data-number="10.3" class="anchored" data-anchor-id="integrate-function"><span class="header-section-number">10.3</span> Integrate function</h2>
<p>Here we write a function to do the integration. This needs the basic inputs of</p>
<ul>
<li>a function,</li>
<li>the interval’s start and end value, and</li>
<li>the number of equal-sized subintervals.</li>
</ul>
<p>In addition, we allow for the possibility of using different methods to approximate the area over a sub interval. Different possibilities are:</p>
<ul>
<li>using a rectangle with the left endpoint to determine the height (<code>method="left"</code>)</li>
<li>using a rectangle with the right endpoint to determine the height (<code>method="right"</code>)</li>
<li>using a trapezoid formed by joining the left and right endpoints (<code>method="trapezoid"</code>)</li>
<li>making the cap a quadratic polynomial that goes through the left and right endpoints and the midpoint (<code>method="simpsons"</code>)</li>
</ul>
<p>This function is defined in <code>MTH229</code>:</p>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">riemann</span>(f<span class="op">::</span><span class="dt">Function</span>, a<span class="op">::</span><span class="dt">Real</span>, b<span class="op">::</span><span class="dt">Real</span>, n<span class="op">::</span><span class="dt">Int</span>; method<span class="op">=</span><span class="st">"right"</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> method <span class="op">==</span> <span class="st">"right"</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>     meth <span class="op">=</span> (f,l,r) <span class="op">-&gt;</span> <span class="fu">f</span>(r) <span class="op">*</span> (r<span class="op">-</span>l)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">elseif</span> method <span class="op">==</span> <span class="st">"left"</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>     meth<span class="op">=</span> (f,l,r) <span class="op">-&gt;</span> <span class="fu">f</span>(l) <span class="op">*</span> (r<span class="op">-</span>l)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">elseif</span> method <span class="op">==</span> <span class="st">"trapezoid"</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>     meth <span class="op">=</span> (f,l,r) <span class="op">-&gt;</span> (<span class="fl">1</span><span class="op">/</span><span class="fl">2</span>) <span class="op">*</span> (<span class="fu">f</span>(l) <span class="op">+</span> <span class="fu">f</span>(r)) <span class="op">*</span> (r<span class="op">-</span>l)</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">elseif</span> method <span class="op">==</span> <span class="st">"simpsons"</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>     meth <span class="op">=</span> (f,l,r) <span class="op">-&gt;</span> (<span class="fl">1</span><span class="op">/</span><span class="fl">6</span>) <span class="op">*</span> (<span class="fu">f</span>(l) <span class="op">+</span> <span class="fl">4</span><span class="fu">*</span>(<span class="fu">f</span>((l<span class="op">+</span>r)<span class="op">/</span><span class="fl">2</span>)) <span class="op">+</span> <span class="fu">f</span>(r)) <span class="op">*</span> (r<span class="op">-</span>l)</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  xs <span class="op">=</span> <span class="fu">range</span>(a, b, length<span class="op">=</span>n<span class="op">+</span><span class="fl">1</span>)</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>  lrs <span class="op">=</span> <span class="fu">zip</span>(<span class="bu">Iterators</span>.<span class="fu">take</span>(xs, n), <span class="bu">Iterators</span>.<span class="fu">rest</span>(xs, <span class="fl">1</span>))</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(<span class="fu">meth</span>(f, l, r) <span class="cf">for</span> (l,r) <span class="kw">in</span> lrs)</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="the-integrate-function-in-action" class="level3" data-number="10.3.1">
<h3 data-number="10.3.1" class="anchored" data-anchor-id="the-integrate-function-in-action"><span class="header-section-number">10.3.1</span> The integrate function in action</h3>
<p>The basic usage of the <code>riemann</code> function is straightforward. Here we approximate the integral of <span class="math inline">\(e^{-x^2}\)</span> from <span class="math inline">\(0\)</span> to <span class="math inline">\(3\)</span> using <span class="math inline">\(10,000\)</span> subintervals:</p>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(x) <span class="op">=</span>  <span class="fu">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="fl">2</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">riemann</span>(f, <span class="fl">0</span>, <span class="fl">3</span>, <span class="fl">10_000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: riemann not defined</code></pre>
</div>
</div>
<p>How big should the number of intervals be? More intervals will give better answers, but unlike Newton’s method we have no stopping criteria. For this problem, we look at various values based on <code>n</code>:</p>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>[<span class="fu">riemann</span>(f, <span class="fl">0</span>, <span class="fl">3</span>, n) for n <span class="kw">in</span> [<span class="fl">100</span>, <span class="fl">1000</span>, <span class="fl">10000</span>, <span class="fl">100000</span>]]   <span class="co">## or use 10.^(2:5)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: riemann not defined</code></pre>
</div>
</div>
<p>We see a value around <span class="math inline">\(0.886\)</span> as the answer.</p>
</section>
<section id="left-versus-right" class="level3" data-number="10.3.2">
<h3 data-number="10.3.2" class="anchored" data-anchor-id="left-versus-right"><span class="header-section-number">10.3.2</span> left versus right</h3>
<p>Using different methods allows us to compare the right and left Riemann sums. Let’s do so for the monotonic function <span class="math inline">\(e^x\)</span> over the interval <span class="math inline">\([0,2]\)</span>.</p>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(x) <span class="op">=</span> <span class="fu">exp</span>(x)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>ns <span class="op">=</span> [<span class="fl">10</span><span class="op">^</span>i for i <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>]</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>ys <span class="op">=</span> [<span class="fu">riemann</span>(f, <span class="fl">0</span>, <span class="fl">2</span>, n, method<span class="op">=</span><span class="st">"right"</span>) <span class="op">-</span> <span class="fu">riemann</span>(f, <span class="fl">0</span>, <span class="fl">2</span>, n, method<span class="op">=</span><span class="st">"left"</span>) for n <span class="kw">in</span> ns];</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>[ns ys]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: riemann not defined</code></pre>
</div>
</div>
<p>Since these are also the minimum and maximum Riemann sums, the above gives a bound on the error in the approximations. We can see it converges quite slowly, in that there are quite a few computations needed to get even a modest bound. (<span class="math inline">\(100,000\)</span> for <span class="math inline">\(0.00013\)</span>).</p>
</section>
<section id="practice-1" class="level3" data-number="10.3.3">
<h3 data-number="10.3.3" class="anchored" data-anchor-id="practice-1"><span class="header-section-number">10.3.3</span> Practice</h3>
<section id="question-4" class="level4">
<h4 class="anchored" data-anchor-id="question-4">Question</h4>
<p>Compute the integral of <span class="math inline">\(e^{-x^2}\)</span> over <span class="math inline">\([0,1]\)</span> using a right Riemann sum with <span class="math inline">\(n=10_000\)</span>. What is your answer?</p>
<div class="cell" data-execution_count="21">
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: riemann not defined</code></pre>
</div>
</div>
</section>
<section id="question-5" class="level4">
<h4 class="anchored" data-anchor-id="question-5">Question</h4>
<p>Compute the integral of <span class="math inline">\((1 + \cos(x)^2)^{1/2}\)</span> over the interval <span class="math inline">\([0, \pi]\)</span> using a right Riemann sum with <span class="math inline">\(n=10,000\)</span>. What is your answer?</p>
<div class="cell" data-execution_count="22">
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: riemann not defined</code></pre>
</div>
</div>
</section>
<section id="question-6" class="level4">
<h4 class="anchored" data-anchor-id="question-6">Question</h4>
<p>Repeat the above analysis comparing the right and left Riemann sums for <span class="math inline">\(f(x)=e^x\)</span> over <span class="math inline">\([0,2]\)</span>. However, this time multiply by <span class="math inline">\(n\)</span>, as follows:</p>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>ns <span class="op">=</span> [<span class="fl">10</span><span class="op">^</span>i for i <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>]</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(x) <span class="op">=</span> <span class="fu">exp</span>(x)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>[n <span class="op">*</span> (<span class="fu">riemann</span>(f, <span class="fl">0</span>, <span class="fl">2</span>, n, method<span class="op">=</span><span class="st">"right"</span>) <span class="op">-</span> <span class="fu">riemann</span>(f, <span class="fl">0</span>, <span class="fl">2</span>, n, method<span class="op">=</span><span class="st">"left"</span>)) for n <span class="kw">in</span> ns]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: riemann not defined</code></pre>
</div>
</div>
<p>This shows what?</p>
<div class="cell" data-execution_count="24">
<div class="cell-output cell-output-display" data-execution_count="24">
<form class="mx-2 my-3 mw-100" name="WeaveQuestion" data-id="sVthaI0w" data-controltype="">
  <div class="form-group ">
    <div class="controls">
      <div class="form" id="controls_sVthaI0w">
        <div style="padding-top: 5px">
    <div class="form-check">
    <label class="form-check-label" for="radio_sVthaI0w_1">
      <input class="form-check-input" type="radio" name="radio_sVthaI0w" id="radio_sVthaI0w_1" value="1">
      
      <span class="label-body px-1">
        That it is constant says the difference between right and left Riemann sums goes to 0 like 1/n
      </span>
    </label>
</div>
<div class="form-check">
    <label class="form-check-label" for="radio_sVthaI0w_2">
      <input class="form-check-input" type="radio" name="radio_sVthaI0w" id="radio_sVthaI0w_2" value="2">
      
      <span class="label-body px-1">
        That it is constant says the difference between right and left Riemann sums is constant.
      </span>
    </label>
</div>
<div class="form-check">
    <label class="form-check-label" for="radio_sVthaI0w_3">
      <input class="form-check-input" type="radio" name="radio_sVthaI0w" id="radio_sVthaI0w_3" value="3">
      
      <span class="label-body px-1">
        That it is constant says the difference between right and left Riemann sums never goes to 0
      </span>
    </label>
</div>

    
        </div>
      </div>
      <div id="sVthaI0w_message" style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text="text/javascript">
document.querySelectorAll('input[name="radio_sVthaI0w"]').forEach(function(rb) {
rb.addEventListener("change", function() {
    var correct = rb.value == 1;
    var msgBox = document.getElementById('sVthaI0w_message');
      if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_sVthaI0w")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_sVthaI0w")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

})});

</script>
</div>
</div>
</section>
</section>
</section>
<section id="improvements-to-the-rectangle-method" class="level2" data-number="10.4">
<h2 data-number="10.4" class="anchored" data-anchor-id="improvements-to-the-rectangle-method"><span class="header-section-number">10.4</span> Improvements to the rectangle method</h2>
<p>The basic left or right Riemann sum will converge, but the convergence is really slow. The value of using rectangles over a grid to approximate area is for theoretical computations, for numeric computations better approximations were known well before Riemann. We mention a few:</p>
<ul>
<li>The trapezoid rule and Simpson’s rule approximate the area under the curve better, as instead of a rectangle they use a trapezoid (linear fit between two points) or a quadratic fit between the two points.)</li>
<li>Gauss quadrature uses non-evenly selected points within the range and a weighting which is exact for polynomials of a given degree.</li>
<li>Adaptive methods pick a non-uniform set of points to use based on where a function is less well behaved.</li>
</ul>
<section id="trapezoid-and-simpsons-rule" class="level3" data-number="10.4.1">
<h3 data-number="10.4.1" class="anchored" data-anchor-id="trapezoid-and-simpsons-rule"><span class="header-section-number">10.4.1</span> Trapezoid and Simpson’s rule</h3>
<p>The trapezoid rule simply replaces the approximation of the area in a subinterval by a trapezoid, as opposed to a rectangle.</p>
<p>We can use this as follows. Let’s approximate the area under the curve <span class="math inline">\(y=5x^4\)</span> between <span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span> (with known answer <span class="math inline">\(1\)</span>):</p>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(x) <span class="op">=</span> <span class="fl">5</span>x<span class="op">^</span><span class="fl">4</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">riemann</span>(f, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1000</span>, method<span class="op">=</span><span class="st">"trapezoid"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: riemann not defined</code></pre>
</div>
</div>
<p>Pretty close to 1 with just 1,000 subintervals.</p>
<p>We now compare the error with the left Riemann sum for the same size <span class="math inline">\(n\)</span>:</p>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>ns <span class="op">=</span> [<span class="fl">10</span><span class="op">^</span>i for i <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>]</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>left_r <span class="op">=</span> [<span class="fu">riemann</span>(f, <span class="fl">0</span>, <span class="fl">1</span>, n) for n <span class="kw">in</span> ns];</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>trapezoid_r <span class="op">=</span> [<span class="fu">riemann</span>(f, <span class="fl">0</span>, <span class="fl">1</span>, n, method<span class="op">=</span><span class="st">"trapezoid"</span>) for n <span class="kw">in</span> ns];</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>[ns (<span class="fl">1</span>)<span class="op">.-</span>left_r (<span class="fl">1</span>)<span class="op">.-</span>trapezoid_r]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: riemann not defined</code></pre>
</div>
</div>
<p>One can see that the errors are much smaller for the trapezoid method.</p>
</section>
<section id="simpsons-rule" class="level3" data-number="10.4.2">
<h3 data-number="10.4.2" class="anchored" data-anchor-id="simpsons-rule"><span class="header-section-number">10.4.2</span> Simpson’s rule</h3>
<p>The trapezoid rule can be viewed as a simple linear approximation to the function <span class="math inline">\(f(x)\)</span> over the subinterval <span class="math inline">\([a, b]\)</span>. That is, replace the function with the secant line between these two values and integrate the replacement. With this viewpoint, it is possible that other easy-to-integrate function approximations will lead to improved approximate integrals. Simpson’s method can be viewed in just this way. It replaces <span class="math inline">\(f\)</span> by the parabola going through <span class="math inline">\((a, f(a))\)</span>, <span class="math inline">\((c, f( c))\)</span> and <span class="math inline">\((b, f(b))\)</span> where <span class="math inline">\(c=(a+b)/2\)</span> is the midpoint between <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>.</p>
<p>We compare how accurate we get with this rule for the same <code>f</code> as before:</p>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>simpsons_r <span class="op">=</span> [<span class="fu">riemann</span>(f, <span class="fl">0</span>, <span class="fl">1</span>, n, method<span class="op">=</span><span class="st">"simpsons"</span>) for n <span class="kw">in</span> ns];</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>[ns (<span class="fl">1</span>)<span class="op">.-</span>left_r (<span class="fl">1</span>)<span class="op">.-</span>trapezoid_r (<span class="fl">1</span>)<span class="op">.-</span>simpsons_r]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: riemann not defined</code></pre>
</div>
</div>
<p>As can be seen, for this function approximating with a parabola is much quicker to converge. That is, <span class="math inline">\(n\)</span> can be smaller yet the same accuracy is maintained. (Of course, there are more computations involved for each, so the number of operations needed may or may not be fewer, that would require some analysis.)</p>
</section>
<section id="error" class="level3" data-number="10.4.3">
<h3 data-number="10.4.3" class="anchored" data-anchor-id="error"><span class="header-section-number">10.4.3</span> Error</h3>
<p>It can be shown that the <a href="http://en.wikipedia.org/wiki/Simpson%27s_rule#Error">error for Simpson’s method</a> is bounded by</p>
<p><span class="math display">\[
\frac{1}{90}\frac{1}{2^5} M (b-a)^5 \frac{1}{n^4},
\]</span></p>
<p>where <span class="math inline">\(M\)</span> is a bound on the fourth derivative. As we increase <span class="math inline">\(n\)</span>, the error gets small at a quick rate. By contrast, the error for the trapezoid method will be like <span class="math inline">\(n^{-2}\)</span> and the left Riemann sum like <span class="math inline">\(n^{-1}\)</span>.</p>
</section>
<section id="practice-2" class="level3" data-number="10.4.4">
<h3 data-number="10.4.4" class="anchored" data-anchor-id="practice-2"><span class="header-section-number">10.4.4</span> Practice</h3>
<section id="question-7" class="level4">
<h4 class="anchored" data-anchor-id="question-7">Question</h4>
<p>The trapezoid rule has no error for linear functions and Simpson’s rule has no error for quadratic functions. Verify the latter by computing the following:</p>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(x) <span class="op">=</span> x<span class="op">^</span><span class="fl">2</span>; <span class="fu">F</span>(x) <span class="op">=</span> x<span class="op">^</span><span class="fl">3</span><span class="op">/</span><span class="fl">3</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">riemann</span>(f, <span class="fl">0</span>, <span class="fl">10</span>, <span class="fl">100</span>, method<span class="op">=</span><span class="st">"simpsons"</span>) <span class="op">-</span> (<span class="fu">F</span>(<span class="fl">10</span>) <span class="op">-</span> <span class="fu">F</span>(<span class="fl">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: riemann not defined</code></pre>
</div>
</div>
<p>How accurate is the approximation? Around</p>
<div class="cell" data-execution_count="29">
<div class="cell-output cell-output-display" data-execution_count="29">
<form class="mx-2 my-3 mw-100" name="WeaveQuestion" data-id="bqQJwdVa" data-controltype="">
  <div class="form-group ">
    <div class="controls">
      <div class="form" id="controls_bqQJwdVa">
        <div style="padding-top: 5px">
    <div class="form-check">
    <label class="form-check-label" for="radio_bqQJwdVa_1">
      <input class="form-check-input" type="radio" name="radio_bqQJwdVa" id="radio_bqQJwdVa_1" value="1">
      
      <span class="label-body px-1">
        <code>1e-8</code>
      </span>
    </label>
</div>
<div class="form-check">
    <label class="form-check-label" for="radio_bqQJwdVa_2">
      <input class="form-check-input" type="radio" name="radio_bqQJwdVa" id="radio_bqQJwdVa_2" value="2">
      
      <span class="label-body px-1">
        <code>1e-10</code>
      </span>
    </label>
</div>
<div class="form-check">
    <label class="form-check-label" for="radio_bqQJwdVa_3">
      <input class="form-check-input" type="radio" name="radio_bqQJwdVa" id="radio_bqQJwdVa_3" value="3">
      
      <span class="label-body px-1">
        <code>1e-12</code>
      </span>
    </label>
</div>
<div class="form-check">
    <label class="form-check-label" for="radio_bqQJwdVa_4">
      <input class="form-check-input" type="radio" name="radio_bqQJwdVa" id="radio_bqQJwdVa_4" value="4">
      
      <span class="label-body px-1">
        <code>1e-14</code>
      </span>
    </label>
</div>
<div class="form-check">
    <label class="form-check-label" for="radio_bqQJwdVa_5">
      <input class="form-check-input" type="radio" name="radio_bqQJwdVa" id="radio_bqQJwdVa_5" value="5">
      
      <span class="label-body px-1">
        <code>1e-16</code>
      </span>
    </label>
</div>
<div class="form-check">
    <label class="form-check-label" for="radio_bqQJwdVa_6">
      <input class="form-check-input" type="radio" name="radio_bqQJwdVa" id="radio_bqQJwdVa_6" value="6">
      
      <span class="label-body px-1">
        <code>0</code>
      </span>
    </label>
</div>

    
        </div>
      </div>
      <div id="bqQJwdVa_message" style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text="text/javascript">
document.querySelectorAll('input[name="radio_bqQJwdVa"]').forEach(function(rb) {
rb.addEventListener("change", function() {
    var correct = rb.value == 4;
    var msgBox = document.getElementById('bqQJwdVa_message');
      if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_bqQJwdVa")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_bqQJwdVa")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

})});

</script>
</div>
</div>
</section>
<section id="question-8" class="level4">
<h4 class="anchored" data-anchor-id="question-8">Question</h4>
<p>Compare the difference between the trapezoid rule and Simpson’s rule when integrating <span class="math inline">\(\cos(x)\)</span> from <span class="math inline">\(0\)</span> to <span class="math inline">\(\pi/6\)</span>. How big is the difference when <span class="math inline">\(n=10,000\)</span>?</p>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>a, b, n <span class="op">=</span> <span class="fl">0</span>, <span class="cn">pi</span><span class="op">/</span><span class="fl">6</span>, <span class="fl">10_000</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">riemann</span>(cos, a, b, n, method<span class="op">=</span><span class="st">"trapezoid"</span>) <span class="op">-</span> <span class="fu">riemann</span>(cos, a, b, n, method<span class="op">=</span><span class="st">"simpsons"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: riemann not defined</code></pre>
</div>
</div>
<p>How big is the difference?</p>
<div class="cell" data-execution_count="31">
<div class="cell-output cell-output-display" data-execution_count="31">
<form class="mx-2 my-3 mw-100" name="WeaveQuestion" data-id="GzBELzPp" data-controltype="">
  <div class="form-group ">
    <div class="controls">
      <div class="form" id="controls_GzBELzPp">
        <div style="padding-top: 5px">
    <div class="form-check">
    <label class="form-check-label" for="radio_GzBELzPp_1">
      <input class="form-check-input" type="radio" name="radio_GzBELzPp" id="radio_GzBELzPp_1" value="1">
      
      <span class="label-body px-1">
        <code>1e-8</code>
      </span>
    </label>
</div>
<div class="form-check">
    <label class="form-check-label" for="radio_GzBELzPp_2">
      <input class="form-check-input" type="radio" name="radio_GzBELzPp" id="radio_GzBELzPp_2" value="2">
      
      <span class="label-body px-1">
        <code>1e-10</code>
      </span>
    </label>
</div>
<div class="form-check">
    <label class="form-check-label" for="radio_GzBELzPp_3">
      <input class="form-check-input" type="radio" name="radio_GzBELzPp" id="radio_GzBELzPp_3" value="3">
      
      <span class="label-body px-1">
        <code>1e-12</code>
      </span>
    </label>
</div>
<div class="form-check">
    <label class="form-check-label" for="radio_GzBELzPp_4">
      <input class="form-check-input" type="radio" name="radio_GzBELzPp" id="radio_GzBELzPp_4" value="4">
      
      <span class="label-body px-1">
        <code>1e-14</code>
      </span>
    </label>
</div>
<div class="form-check">
    <label class="form-check-label" for="radio_GzBELzPp_5">
      <input class="form-check-input" type="radio" name="radio_GzBELzPp" id="radio_GzBELzPp_5" value="5">
      
      <span class="label-body px-1">
        <code>1e-16</code>
      </span>
    </label>
</div>
<div class="form-check">
    <label class="form-check-label" for="radio_GzBELzPp_6">
      <input class="form-check-input" type="radio" name="radio_GzBELzPp" id="radio_GzBELzPp_6" value="6">
      
      <span class="label-body px-1">
        <code>0</code>
      </span>
    </label>
</div>

    
        </div>
      </div>
      <div id="GzBELzPp_message" style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text="text/javascript">
document.querySelectorAll('input[name="radio_GzBELzPp"]').forEach(function(rb) {
rb.addEventListener("change", function() {
    var correct = rb.value == 2;
    var msgBox = document.getElementById('GzBELzPp_message');
      if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_GzBELzPp")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_GzBELzPp")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

})});

</script>
</div>
</div>
</section>
<section id="question-." class="level4">
<h4 class="anchored" data-anchor-id="question-.">Question ….</h4>
<p>Using Simpson’s rule and <code>n=1000</code> compute the integral of <span class="math inline">\(f(x) = 1/(1+x^2)\)</span> between <span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span>.</p>
<div class="cell" data-execution_count="32">
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: riemann not defined</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="the-quadgk-function" class="level2" data-number="10.5">
<h2 data-number="10.5" class="anchored" data-anchor-id="the-quadgk-function"><span class="header-section-number">10.5</span> The quadgk function</h2>
<p><code>Julia</code> provides the <code>quadgk</code> function to do adaptive Gauss-Konrod quadrature, a modern, fast and accurate means to compute 1-dimensional integrals numerically. This is in the <code>QuadGK</code> package which is loaded with <code>MTH229</code>.</p>
<p>The use is straightforward, and similar to <code>riemann</code> above: you specify a function object, and the limits of integration. You don’t specify <span class="math inline">\(n\)</span> – as this is computed adaptively – but you can optionally specify a tolerance which controls the accuracy, though we don’t do so here. For example, a typical usage might be:</p>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>a, err <span class="op">=</span> <span class="fu">quadgk</span>(sin, <span class="fl">0</span>, <span class="cn">pi</span>)     <span class="co">## 2 is exact</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: quadgk not defined</code></pre>
</div>
</div>
<p>Two values are returned, the answer and an estimate of the error. In the above, <span class="math inline">\(2\)</span> is the exact answer to this integral, the estimated value a just a bit more <span class="math inline">\(2\)</span>, but is estimated to be off my no more than the second value, <span class="math inline">\(1.78 \cdot 10^{-12}\)</span>.</p>
<p>If just the answer is of interest, then it can be extracted using <em>index notation</em>:</p>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quadgk</span>(sin, <span class="fl">0</span>, <span class="cn">pi</span>)[<span class="fl">1</span>]       <span class="co"># [1] picks out the first component or two</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: quadgk not defined</code></pre>
</div>
</div>
<hr>
<p>For another illustration, since Archimedes the known answer for <span class="math inline">\(\int_0^1 x^2 dx\)</span> is <span class="math inline">\(1/3\)</span>. We see that <code>quadgk</code> gets it right for all the digits:</p>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quadgk</span>(x <span class="op">-&gt;</span> x<span class="op">^</span><span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: quadgk not defined</code></pre>
</div>
</div>
<p>The <code>riemann</code> function is good for pedagogical purposes, but the <code>quadgk</code> function should be used instead of the <code>riemann</code> function – besides being built-in to <code>julia</code> it is more accurate, more robust, fast, and less work to use.</p>
<p>(That <code>quadgk</code> is exact with polynomials is no surprise, as the underlying choice of nodes and weights makes it so for polynomials of certain degree.)</p>
<section id="practice-3" class="level3" data-number="10.5.1">
<h3 data-number="10.5.1" class="anchored" data-anchor-id="practice-3"><span class="header-section-number">10.5.1</span> Practice</h3>
<section id="question-use-quadgk" class="level4">
<h4 class="anchored" data-anchor-id="question-use-quadgk">Question: Use quadgk</h4>
<p>Let <span class="math inline">\(f(x) = \exp(-4 \cdot |x-1/2|)\)</span>. Find the integral over <span class="math inline">\([0,1]\)</span> using <code>quadgk</code>:</p>
<div class="cell" data-execution_count="36">
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: quadgk not defined</code></pre>
</div>
</div>
</section>
<section id="question-use-quadgk-1" class="level4">
<h4 class="anchored" data-anchor-id="question-use-quadgk-1">Question: use quadgk</h4>
<p>Let <span class="math inline">\(f(x) = \sin(100\pi x)/(\pi x)\)</span>. Find the integral over <span class="math inline">\([0,1]\)</span> using <code>quadgk</code>:</p>
<div class="cell" data-execution_count="37">
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: quadgk not defined</code></pre>
</div>
</div>
</section>
<section id="question-9" class="level4">
<h4 class="anchored" data-anchor-id="question-9">Question</h4>
<p>Let <span class="math inline">\(f(x) = \sin(100\pi x)/(\pi x)\)</span>. Using <span class="math inline">\(1,000\)</span> points, find the right-Riemann integral over <span class="math inline">\([0,1]\)</span>.</p>
<div class="cell" data-execution_count="38">
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: riemann not defined</code></pre>
</div>
</div>
<p>(The answer via Riemann sums isn’t even correct to 4 decimal points, due to the highly oscillatory nature of the function.)</p>
</section>
<section id="question-10" class="level4">
<h4 class="anchored" data-anchor-id="question-10">Question</h4>
<p>How far off is this Riemann estimate, when <span class="math inline">\(n=100,000\)</span>?</p>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(x) <span class="op">=</span> <span class="fl">1</span><span class="op">/</span>(<span class="fl">1</span> <span class="op">+</span> x<span class="op">^</span><span class="fl">4</span>)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">quadgk</span>(f, <span class="fl">0</span>, <span class="fl">1</span>)[<span class="fl">1</span>] <span class="op">-</span> <span class="fu">riemann</span>(f, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">100_000</span>);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: quadgk not defined</code></pre>
</div>
</div>
<div class="cell" data-execution_count="40">
<div class="cell-output cell-output-display" data-execution_count="40">
<form class="mx-2 my-3 mw-100" name="WeaveQuestion" data-id="LMSIJhVm" data-controltype="">
  <div class="form-group ">
    <div class="controls">
      <div class="form" id="controls_LMSIJhVm">
        <div style="padding-top: 5px">
    <div class="form-check">
    <label class="form-check-label" for="radio_LMSIJhVm_1">
      <input class="form-check-input" type="radio" name="radio_LMSIJhVm" id="radio_LMSIJhVm_1" value="1">
      
      <span class="label-body px-1">
        Roughly <code>1e-6</code>
      </span>
    </label>
</div>
<div class="form-check">
    <label class="form-check-label" for="radio_LMSIJhVm_2">
      <input class="form-check-input" type="radio" name="radio_LMSIJhVm" id="radio_LMSIJhVm_2" value="2">
      
      <span class="label-body px-1">
        Roughly <code>1e-12</code>
      </span>
    </label>
</div>
<div class="form-check">
    <label class="form-check-label" for="radio_LMSIJhVm_3">
      <input class="form-check-input" type="radio" name="radio_LMSIJhVm" id="radio_LMSIJhVm_3" value="3">
      
      <span class="label-body px-1">
        Roughly <code>1e-4</code>
      </span>
    </label>
</div>

    
        </div>
      </div>
      <div id="LMSIJhVm_message" style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text="text/javascript">
document.querySelectorAll('input[name="radio_LMSIJhVm"]').forEach(function(rb) {
rb.addEventListener("change", function() {
    var correct = rb.value == 1;
    var msgBox = document.getElementById('LMSIJhVm_message');
      if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_LMSIJhVm")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_LMSIJhVm")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

})});

</script>
</div>
</div>
</section>
<section id="question-11" class="level4">
<h4 class="anchored" data-anchor-id="question-11">Question</h4>
<p>The <code>quadgk</code> function allows you to specify issues where there are troubles. For example, we know that <span class="math inline">\(f(x) = \sin(x)/x\)</span> has an issue at 0. Directly trying this integral <code>quadgk(x-&gt;sin(x)/x, -pi, pi)</code> will fail, but you can specify the issue at <span class="math inline">\(0\)</span> as follows <code>quadgk(x -&gt; sin(x)/x, -pi, 0, pi)</code>. Do so. What is the value of the result:</p>
<div class="cell" data-execution_count="41">
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: quadgk not defined</code></pre>
</div>
</div>
</section>
<section id="question-12" class="level4">
<h4 class="anchored" data-anchor-id="question-12">Question</h4>
<p>Let <span class="math inline">\(f(x) = |x - 0.3|^{-1/4}\)</span>. We wish to find <span class="math inline">\(\int_0^1 f(x) dx\)</span>. The problem with this function is the singularity at <span class="math inline">\(x=0.3\)</span>. (That is, the function is not continuous, so has no guarantee that an integral over a closed domain exists.) However, some such integrals do exist, and the <code>quadgk</code> function can integrate around such singularities by spelling them out in the domain of integration. Just specify the trouble spots between the endpoints:</p>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(x) <span class="op">=</span> <span class="fu">abs</span>(x <span class="op">-</span> <span class="fl">0.3</span>)<span class="op">^</span>(<span class="op">-</span><span class="fl">1</span><span class="op">/</span><span class="fl">4</span>)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>val <span class="op">=</span> <span class="fu">quadgk</span>(f, <span class="fl">0</span>, <span class="fl">0.3</span>, <span class="fl">1</span>);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: quadgk not defined</code></pre>
</div>
</div>
<p>Following the above, what answer do you get?</p>
<div class="cell" data-execution_count="43">
<div class="cell-output cell-output-display" data-execution_count="43">
<form class="mx-2 my-3 mw-100" name="WeaveQuestion" data-id="yqQoMhET" data-controltype="">
  <div class="form-group ">
    <div class="controls">
      <div class="form" id="controls_yqQoMhET">
        <div style="padding-top: 5px">
    <br>
<div class="input-group">
    <input id="yqQoMhET" type="number" class="form-control" placeholder="Numeric answer">
</div>

    
        </div>
      </div>
      <div id="yqQoMhET_message" style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text="text/javascript">
document.getElementById("yqQoMhET").addEventListener("change", function() {
  var correct = (Math.abs(this.value - 8.66586668) <= 0.0001);
  var msgBox = document.getElementById('yqQoMhET_message');
    if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_yqQoMhET")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_yqQoMhET")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

});

</script>
</div>
</div>
</section>
</section>
</section>
<section id="applications" class="level2" data-number="10.6">
<h2 data-number="10.6" class="anchored" data-anchor-id="applications"><span class="header-section-number">10.6</span> Applications</h2>
<p>There are many more applications of the integral beyond computing areas under the curve. Here we discuss two:</p>
<ul>
<li>finding the volume of a figure with rotational symmetry (a glass in our example) and</li>
<li>finding the arc length of a line.</li>
</ul>
<p>In each case one integrates a function related to the one describing the problem. If you keep this straight, the applications are no different than above.</p>
<section id="volume-as-a-function-of-radius." class="level3" data-number="10.6.1">
<h3 data-number="10.6.1" class="anchored" data-anchor-id="volume-as-a-function-of-radius."><span class="header-section-number">10.6.1</span> Volume as a function of radius.</h3>
<p>The volume of a solid of revolution about the <span class="math inline">\(y\)</span>-axis is illustrated <a href="https://www.khanacademy.org/math/integral-calculus/solid_revolution_topic/disc-method/v/disc-method-around-y-axis">here</a>.</p>
<p>This figure shows a volume of revolution (a glass) with an emphasis on the radius of the solid. The volume can be determined if the radius is known.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figures/integration/integration-glass.jpg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Glass</figcaption><p></p>
</figure>
</div>
<p>The basic formula requires the description of the radius as a function of <span class="math inline">\(x\)</span> (if oriented as the figure) or the height, <span class="math inline">\(h\)</span>, (if oriented as in real life). Suppose we specify the radius with <span class="math inline">\(r(h)\)</span>, then the following formula holds with <span class="math inline">\(b\)</span> the total height.</p>
<p><span class="math display">\[
V(b) = \int_0^b \pi r(h)^2 dh.
\]</span></p>
<p>For a symmetrical drinking vessel, like most every glass you drink from, the volume can be computed from a formula if a function describing the radius is known. For a given glass, let <span class="math inline">\(r(h)\)</span> give the radius as a function of height. Then, as above, the volume of the vessel as a function of height, <span class="math inline">\(b\)</span>, is given by an integral:</p>
<p><span class="math display">\[
V(b) = \int_0^b \pi (r(h))^2 dh
\]</span></p>
<p>We wish to look at our intuition relating the height of the fluid in the vessel compared to the percentage of fluid of the whole. A basic question might be: If the vessel is filled half way by height, is the volume half of the total, more or less?</p>
<p>The answer, of course, depends on the shape of the glass. That is the shape of the function <span class="math inline">\(r(h)\)</span>. Note, if <span class="math inline">\(r(h)\)</span> is a constant – the glass is a cylinder – then the half-height mark is also the half-volume mark. Not so in general.</p>
<p>For a standard measuring cup, the answer for different <code>b</code>’s is printed on the side:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figures/integration/measuring_cup.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Measuring cup</figcaption><p></p>
</figure>
</div>
<p>With the formula for the volume of a solid of revolution we can compute this marks numerically if we know the radius as a function of height.</p>
<p>In Glass Shape Influences Consumption Rate for <a href="http://www.plosone.org/article/info%3Adoi%2F10.1371%2Fjournal.pone.0043007">Alcoholic Beverages</a> the authors demonstrate that the shape of the glass can have an effect on the rate of consumption, presumably people drink faster when they aren’t sure how much they have left. In particular, they comment that people have difficulty judging the half-finished-by-volume mark.</p>
<p>This figure shows some of the wide variety of beer-serving glasses:</p>
<p><a href="figures/integration/beer_glasses.jpg">Beer glasses</a></p>
<p>We work with metric units, as there is a natural relation between volume in cm<span class="math inline">\(^3\)</span> and liquid measure (1 liter = 1000 cm<span class="math inline">\(^3\)</span>, so a 16-oz pint glass is roughly <span class="math inline">\(450\)</span> cm<span class="math inline">\(^3\)</span>.)</p>
<p>Let two glasses be given as follows. A typical pint glass with linearly increasing radius:</p>
<p><span class="math display">\[
r(h) = 3 + \frac{1}{5}h, \quad 0 \leq h \leq b;
\]</span></p>
<p>and a curved edge one:</p>
<p><span class="math display">\[
s(h) = 3 + \log(1 + h), \quad 0 \leq h \leq b
\]</span></p>
<p><a href="figures/integration/glass-half-full.png">Half full</a></p>
<p>One could also consider a fluted one, such as appears in the comparison noted in the article.</p>
<section id="question-13" class="level4">
<h4 class="anchored" data-anchor-id="question-13">Question</h4>
<p>Which of these functions might describe a fluted glass where the radius changes faster as the height gets bigger, that is the radius is a <em>concave up</em> function?</p>
<div class="cell" data-execution_count="44">
<div class="cell-output cell-output-display" data-execution_count="44">
<form class="mx-2 my-3 mw-100" name="WeaveQuestion" data-id="FjuQtLPa" data-controltype="">
  <div class="form-group ">
    <div class="controls">
      <div class="form" id="controls_FjuQtLPa">
        <div style="padding-top: 5px">
    <div class="form-check">
    <label class="form-check-label" for="radio_FjuQtLPa_1">
      <input class="form-check-input" type="radio" name="radio_FjuQtLPa" id="radio_FjuQtLPa_1" value="1">
      
      <span class="label-body px-1">
        <code>r(h) = 2 + h/10, 0 &lt;= h &lt;= 10</code>
      </span>
    </label>
</div>
<div class="form-check">
    <label class="form-check-label" for="radio_FjuQtLPa_2">
      <input class="form-check-input" type="radio" name="radio_FjuQtLPa" id="radio_FjuQtLPa_2" value="2">
      
      <span class="label-body px-1">
        <code>r(h) = 2 + (h/10)^2, 0 &lt;= h &lt;= 10</code>
      </span>
    </label>
</div>
<div class="form-check">
    <label class="form-check-label" for="radio_FjuQtLPa_3">
      <input class="form-check-input" type="radio" name="radio_FjuQtLPa" id="radio_FjuQtLPa_3" value="3">
      
      <span class="label-body px-1">
        <code>r(h) = 2 + sqrt(h/10), 0 &lt;= h &lt;= 10</code>
      </span>
    </label>
</div>

    
        </div>
      </div>
      <div id="FjuQtLPa_message" style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text="text/javascript">
document.querySelectorAll('input[name="radio_FjuQtLPa"]').forEach(function(rb) {
rb.addEventListener("change", function() {
    var correct = rb.value == 2;
    var msgBox = document.getElementById('FjuQtLPa_message');
      if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_FjuQtLPa")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_FjuQtLPa")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

})});

</script>
</div>
</div>
<hr>
<p>For the two types of glasses in the figure, we create functions in <code>julia</code> as follows:</p>
<div class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">r</span>(h) <span class="op">=</span> <span class="fl">3</span> <span class="op">+</span> h<span class="op">/</span><span class="fl">5</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">s</span>(h) <span class="op">=</span> <span class="fl">3</span> <span class="op">+</span> <span class="fu">log</span>(<span class="fl">1</span> <span class="op">+</span> h)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="fu">r_vol</span>(b) <span class="op">=</span> <span class="fu">quadgk</span>(x <span class="op">-&gt;</span> <span class="fu">pi*r</span>(x)<span class="op">^</span><span class="fl">2</span>, <span class="fl">0</span>, b)[<span class="fl">1</span>]</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="fu">s_vol</span>(b) <span class="op">=</span> <span class="fu">quadgk</span>(x <span class="op">-&gt;</span> <span class="fu">pi*s</span>(x)<span class="op">^</span><span class="fl">2</span>, <span class="fl">0</span>, b)[<span class="fl">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="45">
<pre><code>s_vol (generic function with 1 method)</code></pre>
</div>
</div>
<p>Then we can easily find the volume as a function of height. For example at 10cm we have:</p>
<div class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">r_vol</span>(<span class="fl">10</span>), <span class="fu">s_vol</span>(<span class="fl">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: quadgk not defined</code></pre>
</div>
</div>
<p>However, to find <span class="math inline">\(b\)</span> that makes the glass <span class="math inline">\(450\)</span> cm<span class="math inline">\(^3\)</span> requires us to solve an equation involving an integral for <span class="math inline">\(b\)</span>:</p>
<p><span class="math display">\[
V(b) = \int_0^b \pi r(h)^2 dh = 450.
\]</span></p>
<p>Not to worry, we can use <code>find_zero</code> from the <code>Roots</code> package for that (again, this is loaded with the <code>MTH229</code> package). To solve for when <code>V(b) = r_vol(b) - 450 = 0</code> we have</p>
<div class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>r_b <span class="op">=</span> <span class="fu">find_zero</span>(x <span class="op">-&gt;</span> <span class="fu">r_vol</span>(x) <span class="op">-</span> <span class="fl">450</span>,  <span class="fl">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: find_zero not defined</code></pre>
</div>
</div>
<p>So <span class="math inline">\(b\)</span> is basically <span class="math inline">\(9.17\)</span>. Given this, how much volume is left at <code>b/2</code>?</p>
<div class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">r_vol</span>(r_b<span class="op">/</span><span class="fl">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: r_b not defined</code></pre>
</div>
</div>
<p>Which is what percent of the whole?</p>
<div class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">r_vol</span>(r_b<span class="op">/</span><span class="fl">2</span>) <span class="op">/</span> <span class="fu">r_vol</span>(r_b) <span class="op">*</span> <span class="fl">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: r_b not defined</code></pre>
</div>
</div>
<p>As this height is often mistaken for the half-way by volume mark, people tend to drink these pints faster than they think.</p>
<p>Now compare to the height to get half the volume (225 ml):</p>
<div class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>r_half <span class="op">=</span> <span class="fu">find_zero</span>(x <span class="op">-&gt;</span> <span class="fu">r_vol</span>(x) <span class="op">-</span> <span class="fl">225</span>,  <span class="fl">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: find_zero not defined</code></pre>
</div>
</div>
<p>This value is more than half of <span class="math inline">\(b\)</span>:</p>
<div class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>r_half <span class="op">/</span> r_b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: r_half not defined</code></pre>
</div>
</div>
<p>At this height only half the volume is remaining (and not at 50% of the original height.)</p>
</section>
</section>
<section id="practice-4" class="level3" data-number="10.6.2">
<h3 data-number="10.6.2" class="anchored" data-anchor-id="practice-4"><span class="header-section-number">10.6.2</span> Practice</h3>
<section id="question-14" class="level4">
<h4 class="anchored" data-anchor-id="question-14">Question</h4>
<p>Compare the above for the curved glass, where <span class="math inline">\(s(h) = 3 + \log(1 + h)\)</span>.</p>
<p>What is the height of the glass, <code>b</code>, needed to make the volume 450?</p>
<div class="cell" data-execution_count="52">
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: find_zero not defined</code></pre>
</div>
</div>
</section>
<section id="question-15" class="level4">
<h4 class="anchored" data-anchor-id="question-15">Question</h4>
<p>Find the volume of the glass represented by <span class="math inline">\(s(h) = 3 + \log(1 + h), 0 \leq h \leq b\)</span> when the glass is filled to half its height. Report the value as a percentage of the total volume.</p>
<div class="cell" data-execution_count="53">
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: quadgk not defined</code></pre>
</div>
</div>
</section>
<section id="question-16" class="level4">
<h4 class="anchored" data-anchor-id="question-16">Question</h4>
<p>Now how high do you fill the glass to produce <em>half</em> the volume? Report your answer in terms of a percentage of <span class="math inline">\(b\)</span>, the height of the glass.</p>
<div class="cell" data-execution_count="54">
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: find_zero not defined</code></pre>
</div>
</div>
</section>
<section id="question-17" class="level4">
<h4 class="anchored" data-anchor-id="question-17">Question</h4>
<p>Consider this big Solo cup:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figures/integration/big-solo-cup.jpg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Solo cup</figcaption><p></p>
</figure>
</div>
<p>It has approximate dimensions: smaller radius 5 feet, upper radius 8 feet and height 15 feet. How many gallons is it? At <span class="math inline">\(8\)</span> pounds a gallon this would be pretty heavy!</p>
<p>Two facts are useful:</p>
<ul>
<li>a cubic foot is 7.48052 gallons</li>
<li>the radius as a function of height is <span class="math inline">\(r(h) = 5 + (3/15)\cdot h\)</span></li>
</ul>
<div class="cell" data-execution_count="55">
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: quadgk not defined</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="example-arc-length" class="level2" data-number="10.7">
<h2 data-number="10.7" class="anchored" data-anchor-id="example-arc-length"><span class="header-section-number">10.7</span> Example, arc length</h2>
<p>The basic indefinite integral for a positive function answers the amount of area under the curve over a given interval. However, the integral can be interpreted in many different ways. For example, one can use an integral to answer how long a curve is. Of course one can estimate this answer. For example, consider this curve:</p>
<div class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x <span class="op">-&gt;</span> x<span class="op">^</span><span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: plot not defined</code></pre>
</div>
</div>
<p>This curve has length no more than <span class="math inline">\(2 = 1 + 1\)</span> – the distance along the <span class="math inline">\(x\)</span> axis starting at <span class="math inline">\(0\)</span> to <span class="math inline">\(1\)</span> and then going up. It is also longer than <span class="math inline">\(\sqrt{2} = \sqrt{1^2 + 1^2}\)</span> – the straight line distance between the two endpoints. But how long is it?</p>
<p>In general, the <em>arc length</em> of the curve <span class="math inline">\(y=f(x)\)</span> between <span class="math inline">\(a \leq x \leq b\)</span> (or how long is the curve) is given through the formula</p>
<p><span class="math display">\[
l = \int_a^b \sqrt{1 + f'(x)^2} dx
\]</span></p>
<p>The formula is from the length of the hypotenuse of a right triangle with lengths <span class="math inline">\(1\)</span> and <span class="math inline">\(f'(x)\)</span>, This image suggests an approximation for the length and why the hypotenuse of some triangle might be involved.</p>
<p><a href="figures/integration/arclength.gif">Arc length</a></p>
<p>Rather than focus on a derivation, we do some examples illustrating that to compute the arclength of the graph of a function is relatively straightforward using numeric integration. For example, our answer for <span class="math inline">\(f(x) = x^2\)</span> is given by</p>
<div class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(x) <span class="op">=</span> x<span class="op">^</span><span class="fl">2</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="fu">quadgk</span>(x <span class="op">-&gt;</span> <span class="fu">sqrt</span>(<span class="fl">1</span> <span class="op">+</span> f<span class="op">'</span>(x)<span class="op">^</span><span class="fl">2</span>), <span class="fl">0</span>, <span class="fl">1</span>)      <span class="co"># using f' notation defined in MTH229</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: quadgk not defined</code></pre>
</div>
</div>
<p>(We use an <em>anonymous function</em> for the integrand which involved the derivative being found through <code>f'</code>. If the graph is described by <code>f</code>, then this expression be the same for all these problems.)</p>
<hr>
<p>Whereas, the length of the <span class="math inline">\(f(x) = \sin(x)\)</span> over <span class="math inline">\([0, \pi]\)</span> would be:</p>
<div class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(x) <span class="op">=</span> <span class="fu">sin</span>(x)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="fu">quadgk</span>(x <span class="op">-&gt;</span> <span class="fu">sqrt</span>(<span class="fl">1</span> <span class="op">+</span> f<span class="op">'</span>(x)<span class="op">^</span><span class="fl">2</span>), <span class="fl">0</span>, <span class="cn">pi</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: quadgk not defined</code></pre>
</div>
</div>
<p>Next we look at a more practical problem.</p>
<section id="example-the-catenary-shape" class="level3" data-number="10.7.1">
<h3 data-number="10.7.1" class="anchored" data-anchor-id="example-the-catenary-shape"><span class="header-section-number">10.7.1</span> Example: the catenary shape</h3>
<p>A <a href="http://en.wikipedia.org/wiki/Catenary">catenary shape</a> is the shape a hanging chain will take as it is suspended between two posts. It appears elsewhere, for example, power wires will also have this shape as they are suspended between towers. A formula for a catenary can be written in terms of the hyperbolic cosine, <code>cosh</code> in <code>julia</code> or exponentials.</p>
<p><span class="math display">\[
y = a \cosh(x/a) = a \cdot \frac{e^{x/a} + e^{-x/a}}{2}.
\]</span></p>
<p>Suppose we have the following wire hung between <span class="math inline">\(x=-1\)</span> and <span class="math inline">\(x=1\)</span> with <span class="math inline">\(a = 2\)</span>:</p>
<div class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(x; a<span class="op">=</span><span class="fl">2</span>) <span class="op">=</span> a <span class="op">*</span> <span class="fu">cosh</span>(x<span class="op">/</span>a)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(f, <span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: plot not defined</code></pre>
</div>
</div>
<p>How long is the chain? Looking at the graph we can guess an answer is between <span class="math inline">\(2\)</span> and <span class="math inline">\(2.5\)</span>, say, but it isn’t much work to get the answer:</p>
<div class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quadgk</span>(x <span class="op">-&gt;</span> <span class="fu">sqrt</span>(<span class="fl">1</span> <span class="op">+</span> f<span class="op">'</span>(x)<span class="op">^</span><span class="fl">2</span>), <span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: quadgk not defined</code></pre>
</div>
</div>
</section>
<section id="practice-5" class="level3" data-number="10.7.2">
<h3 data-number="10.7.2" class="anchored" data-anchor-id="practice-5"><span class="header-section-number">10.7.2</span> Practice</h3>
<section id="question-18" class="level4">
<h4 class="anchored" data-anchor-id="question-18">Question</h4>
<p>The sag in the chain is adjusted through the parameter <span class="math inline">\(a\)</span> – chains with larger <span class="math inline">\(a\)</span> have less sag.</p>
<p>Suppose your chain has parameter <code>a=3</code> what is the length? (Use <code>quadgk</code>)</p>
<div class="cell" data-execution_count="61">
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: quadgk not defined</code></pre>
</div>
</div>
</section>
<section id="question-in-the-artist-studio" class="level4">
<h4 class="anchored" data-anchor-id="question-in-the-artist-studio">Question: in the artist studio</h4>
<p>This picture of Jasper Johns <a href="http://www.artic.edu/aic/collections/artwork/184095">Near the Lagoon</a> was taken at The Art Institute Chicago.</p>
<p><a href="figures/integration/johns-catenary.jpg">Jasper Johns</a></p>
<p>The museum notes have</p>
<blockquote class="blockquote">
<p>For his Catenary series (1997–2003), of which Near the Lagoon is the largest and last work, Johns formed catenaries—a term used to describe the curve assumed by a cord suspended freely from two points—by tacking ordinary household string to the canvas or its supports.</p>
</blockquote>
<p>This particular catenary has a certain length. The basic dimensions are 78in wide and 118in drop. If our shifted function is</p>
<p><span class="math display">\[
f(x; a, b) = a \cosh(x/a) - b
\]</span></p>
<p>Then we have <span class="math inline">\(f(0) = -118\)</span> and <span class="math inline">\(f(78/2) = 0\)</span> using the origin midway between the two tops of the curve. Solving the first gives</p>
<p><span class="math display">\[
-118 = a - b \text{ or } b = a + 118.
\]</span></p>
<p>The second gives <span class="math inline">\(a \cdot \cosh(78/(2a)) - (a + 118) = 0\)</span>. This can be solved numerically for a:</p>
<div class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">catenary</span>(x; a<span class="op">=</span><span class="fl">1</span>, b<span class="op">=</span><span class="fl">0</span>) <span class="op">=</span> <span class="fu">a*cosh</span>(x<span class="op">/</span>a) <span class="op">-</span> b</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> <span class="fu">newton</span>(a <span class="op">-&gt;</span> <span class="fu">catenary</span>(<span class="fl">78</span><span class="op">/</span><span class="fl">2</span>, a<span class="op">=</span>a, b<span class="op">=</span><span class="fl">118</span> <span class="op">+</span> a), <span class="fl">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: newton not defined</code></pre>
</div>
</div>
<p>Rounding, we take <span class="math inline">\(a=13\)</span>. With these parameters (<span class="math inline">\(a=13\)</span>, <span class="math inline">\(b = 131\)</span>), compute the length of John’s catenary.</p>
<div class="cell" data-execution_count="63">
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: quadgk not defined</code></pre>
</div>
</div>
</section>
<section id="question-bridges-are-parabolas" class="level4">
<h4 class="anchored" data-anchor-id="question-bridges-are-parabolas">Question: bridges are parabolas</h4>
<p>Suspension bridges, like the Verrazano bridge, have different loading than a cable and hence a different shape. A parabola is the shape the cable takes under uniform loading.</p>
<p>The Verrazano-Narrows <a href="http://observer.com/2012/09/staten-island/s-i-8/">bridge</a> has a span of 1298m. Suppose the drop of the main cables is 147 meters over this span. Then the cable itself can be modeled as a parabola with</p>
<ul>
<li><span class="math inline">\(x\)</span>-intercepts <span class="math inline">\(a = 1298/2\)</span> and <span class="math inline">\(-a\)</span> and</li>
<li>vertex <span class="math inline">\((0,b)\)</span> with <span class="math inline">\(b=-147\)</span>.</li>
</ul>
<p>The parabola that fits these three points is</p>
<p><span class="math display">\[
y = \frac{-b}{a^2}(x^2 - a^2)
\]</span></p>
<p>Find the arc length of the cable in meters.</p>
<div class="cell" data-execution_count="64">
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: quadgk not defined</code></pre>
</div>
</div>
<p>In the picture of the Verrazano-Narrows <a href="http://observer.com/2012/09/staten-island/s-i-8/">bridge</a>, would the shape during construction be a parabola or a catenary?</p>
<div class="cell" data-execution_count="65">
<div class="cell-output cell-output-display" data-execution_count="65">
<form class="mx-2 my-3 mw-100" name="WeaveQuestion" data-id="hkwFvznQ" data-controltype="">
  <div class="form-group ">
    <div class="controls">
      <div class="form" id="controls_hkwFvznQ">
        <div style="padding-top: 5px">
    <div class="form-check">
    <label class="form-check-label" for="radio_hkwFvznQ_1">
      <input class="form-check-input" type="radio" name="radio_hkwFvznQ" id="radio_hkwFvznQ_1" value="1">
      
      <span class="label-body px-1">
        A parabola, as just mentioned
      </span>
    </label>
</div>
<div class="form-check">
    <label class="form-check-label" for="radio_hkwFvznQ_2">
      <input class="form-check-input" type="radio" name="radio_hkwFvznQ" id="radio_hkwFvznQ_2" value="2">
      
      <span class="label-body px-1">
        A catenary, basically, as in the picture there is basically no load on the cables.
      </span>
    </label>
</div>

    
        </div>
      </div>
      <div id="hkwFvznQ_message" style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text="text/javascript">
document.querySelectorAll('input[name="radio_hkwFvznQ"]').forEach(function(rb) {
rb.addEventListener("change", function() {
    var correct = rb.value == 2;
    var msgBox = document.getElementById('hkwFvznQ_message');
      if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_hkwFvznQ")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_hkwFvznQ")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

})});

</script>
</div>
</div>
</section>
<section id="question-the-tractrix" class="level4">
<h4 class="anchored" data-anchor-id="question-the-tractrix">Question: the tractrix</h4>
<p>A boat sits at the point <span class="math inline">\((a, 0)\)</span> and a man holds a rope taut attached to the boat at the origin <span class="math inline">\((0,0)\)</span>. The man walks on the <span class="math inline">\(y\)</span> axis. The position <span class="math inline">\(y\)</span> depends then on the position <span class="math inline">\(x\)</span> of the boat, and if the rope is taut, the position satisfies:</p>
<p><span class="math display">\[
y = a \ln\frac{a + \sqrt{a^2 - x^2}}{x} - \sqrt{a^2 - x^2}
\]</span></p>
<p>This can be entered into <code>julia</code> as:</p>
<div class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">g</span>(x, a) <span class="op">=</span> a <span class="op">*</span> <span class="fu">log</span>((a <span class="op">+</span> <span class="fu">sqrt</span>(a<span class="op">^</span><span class="fl">2</span> <span class="op">-</span> x<span class="op">^</span><span class="fl">2</span>))<span class="op">/</span>x) <span class="op">-</span> <span class="fu">sqrt</span>(a<span class="op">^</span><span class="fl">2</span> <span class="op">-</span> x<span class="op">^</span><span class="fl">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="66">
<pre><code>g (generic function with 1 method)</code></pre>
</div>
</div>
<p>Let <span class="math inline">\(a=12\)</span>, <span class="math inline">\(f(x) = g(x, a)\)</span>. Compute the length the bow of the boat has traveled between <span class="math inline">\(x=1\)</span> and <span class="math inline">\(x=a\)</span> using <code>quadgk</code>.</p>
<div class="cell" data-execution_count="67">
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: quadgk not defined</code></pre>
</div>
</div>
<p>(The most elementary description of this curve is in terms of the relationship <span class="math inline">\(dy/dx = -\sqrt{a^2-x^2}/x\)</span> which could be used in place of <code>f'</code> in your work.)</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
More on the tractrix
</div>
</div>
<div class="callout-body-container callout-body">
<p>Watch this <a href="https://simonsfoundation.org/multimedia/mathematical-impressions-bicycle-tracks/%22%3E%22bicycle%20tracks">video</a> to see an example of how the tractrix can be found in an everyday observation. Also <a href="http://calteches.library.caltech.edu/4007/1/Calculus.pdf">here</a>.</p>
</div>
</div>
</section>
</section>
</section>
<section id="gauss-quadrature-using-weights" class="level2" data-number="10.8">
<h2 data-number="10.8" class="anchored" data-anchor-id="gauss-quadrature-using-weights"><span class="header-section-number">10.8</span> Gauss quadrature, Using weights</h2>
<p>What components go into the <code>quadgk</code> function? This section covers some of the background.</p>
<p>The trapezoid rule can be rearranged to become:</p>
<p><span class="math display">\[
\delta f(x_0) + 2\delta f(x_2) + 2 \delta f(x_3) + \cdots + 2 \delta f(x_{n}) + \delta f(x_{n})
\]</span></p>
<p>where <span class="math inline">\(\delta = (b-a)/n\)</span>.</p>
<p>Whereas for even <span class="math inline">\(n\)</span>, Simpson’s rule can be written with:</p>
<p><span class="math display">\[
\delta f(x_0) + 4\delta f(x_1) + 2 \delta f(x_2) + \cdots +  4 \delta f(x_{n-2}) + 2 \delta f(x_{n-1}) + \delta f(x_{n})
\]</span></p>
<p>with <span class="math inline">\(\delta = (b-a)/n \cdot (1/6)\)</span>.</p>
<p>These both have the general form of</p>
<p><span class="math display">\[
\sum_k w_k \cdot f(x_k)
\]</span></p>
<p>where <span class="math inline">\(w_k\)</span> are weights and the <span class="math inline">\(x_k\)</span> some choice of points (nodes) – not necessarily evenly spaced, though that is so in the examples we’ve seen. So, an alternative way to do the trapezoid formula in <code>julia</code> for <span class="math inline">\(n=4\)</span> might be:</p>
<div class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>a, b, n <span class="op">=</span> <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">4</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>delta <span class="op">=</span> (b<span class="op">-</span>a)<span class="op">/</span>n</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(x) <span class="op">=</span> x<span class="op">^</span><span class="fl">2</span></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>wts <span class="op">=</span> [<span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">1</span>] <span class="op">*</span> delta <span class="co">## delta * [1, repeat([2],n-1), 1]'</span></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>xs <span class="op">=</span> a <span class="op">.+</span> (<span class="fl">0</span><span class="op">:</span>n) <span class="op">*</span> delta</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(w <span class="op">*</span> <span class="fu">f</span>(x) <span class="cf">for</span> (w,x) <span class="kw">in</span> <span class="fu">zip</span>(wts, xs))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="68">
<pre><code>0.6875</code></pre>
</div>
</div>
<p>The compact code of the last line to compute the approximate integral shows there are three important things in this form of the integral: the weights, the <em>nodes</em> or <span class="math inline">\(x\)</span> values, and the function. The use of equally spaced nodes has been used by us so far, but it need not be the case. If fact Gauss showed he could get similar answers faster if it wasn’t the case.</p>
<p>The Gauss nodes and weights are computable (http://en.wikipedia.org/wiki/Gaussian_quadrature). The main tools are the so-called Legendre polynomials, which can be defined recursively with Bonnet’s formula:</p>
<p><span class="math display">\[
P_0(x) = 1; P_1(x) = x; \quad  n P_{n}(x)  = (2(n-1)+1) x P_{n-1}(x) -(n-1) P_{n-2}(x).
\]</span></p>
<p>Using <code>julia</code>’s <code>Polynomials</code> package this can be implemented almost verbatim:</p>
<div class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> <span class="bu">Polynomials</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> <span class="bu">Polynomials</span>: Polynomial</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">lgp</span>(n<span class="op">::</span><span class="dt">Integer</span>)</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> n <span class="op">==</span> <span class="fl">0</span> <span class="cf">return</span> <span class="fu">Polynomial</span>([<span class="fl">1</span>]) <span class="cf">end</span></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> n <span class="op">==</span> <span class="fl">1</span> <span class="cf">return</span> <span class="fu">Polynomial</span>([<span class="fl">0</span>, <span class="fl">1</span>]) <span class="cf">end</span></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>    (<span class="fl">2</span><span class="fu">*</span>(n<span class="op">-</span><span class="fl">1</span>) <span class="op">+</span> <span class="fl">1</span>) <span class="op">/</span> n <span class="op">*</span> <span class="fu">lgp</span>(<span class="fl">1</span>) <span class="op">*</span> <span class="fu">lgp</span>(n<span class="op">-</span><span class="fl">1</span>) <span class="op">-</span> (n<span class="op">-</span><span class="fl">1</span>)<span class="op">/</span>n <span class="op">*</span> <span class="fu">lgp</span>(n<span class="op">-</span><span class="fl">2</span>)</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>LoadError: ArgumentError: Package Polynomials not found in current path.
- Run `import Pkg; Pkg.add("Polynomials")` to install the Polynomials package.</code></pre>
</div>
</div>
<p>This is used as,</p>
<div class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>p4 <span class="op">=</span> <span class="fu">lgp</span>(<span class="fl">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: lgp not defined</code></pre>
</div>
</div>
<p>The term <em>recursion</em> is applied to a function when it makes a reference to itself during a computation. With this function, don’t try it with values much bigger than <span class="math inline">\(20\)</span>, as the recursion can take a long time.</p>
<p>The nodes are the roots of the right polynomial. Here we have the values for <code>p4</code></p>
<div class="cell" data-execution_count="71">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>xs <span class="op">=</span> Polynomials.<span class="fu">roots</span>(p4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: Polynomials not defined</code></pre>
</div>
</div>
<p>(The Konrod part of <code>quadgk</code> changes the nodes so they can be reused during the refinement.)</p>
<p>Finally, the weights involve the derivative of <span class="math inline">\(P_n\)</span> through:</p>
<p><span class="math display">\[
w_i = \frac{2}{(1 - x_i^2) \cdot(P^{'}_n(x_i)/P_n(1))^2}
\]</span></p>
<p>These can be done simply with:</p>
<div class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">weights</span>(x) <span class="op">=</span> <span class="fl">2</span> <span class="op">/</span> ((<span class="fl">1</span> <span class="op">-</span> x<span class="op">^</span><span class="fl">2</span>) <span class="op">*</span> (Polynomials.<span class="fu">derivative</span>(p4)(x)<span class="op">/</span><span class="fu">p4</span>(<span class="fl">1</span>))<span class="op">^</span><span class="fl">2</span> )</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>ws <span class="op">=</span> [<span class="fu">weights</span>(xi) for xi <span class="kw">in</span> xs]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: Polynomials not defined</code></pre>
</div>
</div>
<p>From here <code>gauss_quadrature</code> will do the integration of <code>f</code> over the interval <span class="math inline">\([-1,1]\)</span>, though we can do it ourself quickly enough. Here we compute the integral of <span class="math inline">\(\cos(\pi/2 x)\)</span> over <span class="math inline">\([-1,1]\)</span> (you can check this is very close to the answer <span class="math inline">\(4/\pi\)</span> even with just 4 nodes):</p>
<pre><code>f(x) = cos(pi/2*x)
sum(w * f(x) for (w,x) in zip(ws, xs))</code></pre>
<section id="adaptive-integration" class="level3" data-number="10.8.1">
<h3 data-number="10.8.1" class="anchored" data-anchor-id="adaptive-integration"><span class="header-section-number">10.8.1</span> Adaptive integration</h3>
<p>Next, we a have a brief discussion about an alternative means to compute integrals. The following function <code>adapt</code> implements a basic <em>adaptive quadrature</em> method for integration. The basic idea is that for a subinterval <span class="math inline">\([a,b]\)</span> if the area of the trapezoid is not close to the area of Simpson’s parabolic estimate then the subinterval is split into two pieces <span class="math inline">\([a,c]\)</span> and <span class="math inline">\([c,b]\)</span> and the same question is asked. If the area is close the Simpson’s parabolic estimate is used to estimate the integral of <span class="math inline">\(f\)</span> over that subinterval.</p>
<p>Again, we see <em>recursion</em> when programming this algorithm. To avoid infinite loops during this, we use a limit below to keep track.</p>
<p>In general, the value of adaptive methods like this, is the function calls concentrate on areas where <span class="math inline">\(f\)</span> is not well approximated and where it is well approximated it just moves on. This approach works well for poorly behaved functions, as it has a more refined grid there.</p>
<div class="cell" data-execution_count="74">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">adapt</span>(f, a, b, limit)</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>    h <span class="op">=</span> b<span class="op">-</span>a</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>    c <span class="op">=</span> a <span class="op">+</span> (b <span class="op">-</span> a)<span class="op">/</span><span class="fl">2</span></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>    a1 <span class="op">=</span> (<span class="fu">f</span>(a) <span class="op">+</span> <span class="fu">f</span>(b)) <span class="op">*</span> h<span class="op">/</span><span class="fl">2</span>          <span class="co">## trapezoid</span></span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>    a2 <span class="op">=</span> (<span class="fu">f</span>(a) <span class="op">+</span> <span class="fl">4</span><span class="fu">f</span>(c) <span class="op">+</span> <span class="fu">f</span>(b)) <span class="op">*</span> h<span class="op">/</span><span class="fl">6</span>  <span class="co">## Simpson's parabola</span></span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="fu">isapprox</span>(a1, a2)</span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span>(a2)</span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> limit <span class="op">==</span> <span class="fl">0</span></span>
<span id="cb108-14"><a href="#cb108-14" aria-hidden="true" tabindex="-1"></a>        <span class="fu">println</span>(<span class="st">"limit reached for this interval [</span><span class="sc">$</span>a<span class="st">, </span><span class="sc">$</span>b<span class="st">]"</span>)</span>
<span id="cb108-15"><a href="#cb108-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span>(a2)</span>
<span id="cb108-16"><a href="#cb108-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb108-17"><a href="#cb108-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-18"><a href="#cb108-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">adapt</span>(f, a, c, limit <span class="op">-</span> <span class="fl">1</span>) <span class="op">+</span> <span class="fu">adapt</span>(f, c, b, limit<span class="op">-</span><span class="fl">1</span>)</span>
<span id="cb108-19"><a href="#cb108-19" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="74">
<pre><code>adapt (generic function with 1 method)</code></pre>
</div>
</div>
<p>Does it work? Let’s see it for the area of <span class="math inline">\(f(x) = x^2(1-x)^{10}\)</span> which is known to satisfy <span class="math inline">\(\beta(2+1, 10+1)\)</span></p>
<pre><code>out = adapt(x -&gt; x^2 * (1 -x)^10, 0, 1, 10)</code></pre>
<p>Not too far off (<code>1e-10</code>) from the known answer which is a beta function:</p>
<pre><code>out - beta(2 + 1, 10 + 1)</code></pre>
<p>(The use of <code>isapprox</code> above determines how accurate the values will be. This function uses two tolerances to test if the valus <code>x</code> and <code>y</code> are approximately the same. These could be changed easily enough so that more precise answers can be found.)</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
    var links = window.document.querySelectorAll('a:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./extrema.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Maximization and minimization with Julia</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./mth232.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Notes on MTH 232 and Julia</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>