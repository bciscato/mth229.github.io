<!DOCTYPE html>
<HTML lang = "en">
<HEAD>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  
  

  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]},
      TeX: { equationNumbers: { autoNumber: "AMS" } }
    });
  </script>

  <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>

  
<style>
pre.hljl {
    border: 1px solid #ccc;
    margin: 5px;
    padding: 5px;
    overflow-x: auto;
    color: rgb(68,68,68); background-color: rgb(251,251,251); }
pre.hljl > span.hljl-t { }
pre.hljl > span.hljl-w { }
pre.hljl > span.hljl-e { }
pre.hljl > span.hljl-eB { }
pre.hljl > span.hljl-o { }
pre.hljl > span.hljl-k { color: rgb(148,91,176); font-weight: bold; }
pre.hljl > span.hljl-kc { color: rgb(59,151,46); font-style: italic; }
pre.hljl > span.hljl-kd { color: rgb(214,102,97); font-style: italic; }
pre.hljl > span.hljl-kn { color: rgb(148,91,176); font-weight: bold; }
pre.hljl > span.hljl-kp { color: rgb(148,91,176); font-weight: bold; }
pre.hljl > span.hljl-kr { color: rgb(148,91,176); font-weight: bold; }
pre.hljl > span.hljl-kt { color: rgb(148,91,176); font-weight: bold; }
pre.hljl > span.hljl-n { }
pre.hljl > span.hljl-na { }
pre.hljl > span.hljl-nb { }
pre.hljl > span.hljl-nbp { }
pre.hljl > span.hljl-nc { }
pre.hljl > span.hljl-ncB { }
pre.hljl > span.hljl-nd { color: rgb(214,102,97); }
pre.hljl > span.hljl-ne { }
pre.hljl > span.hljl-neB { }
pre.hljl > span.hljl-nf { color: rgb(66,102,213); }
pre.hljl > span.hljl-nfm { color: rgb(66,102,213); }
pre.hljl > span.hljl-np { }
pre.hljl > span.hljl-nl { }
pre.hljl > span.hljl-nn { }
pre.hljl > span.hljl-no { }
pre.hljl > span.hljl-nt { }
pre.hljl > span.hljl-nv { }
pre.hljl > span.hljl-nvc { }
pre.hljl > span.hljl-nvg { }
pre.hljl > span.hljl-nvi { }
pre.hljl > span.hljl-nvm { }
pre.hljl > span.hljl-l { }
pre.hljl > span.hljl-ld { color: rgb(148,91,176); font-style: italic; }
pre.hljl > span.hljl-s { color: rgb(201,61,57); }
pre.hljl > span.hljl-sa { color: rgb(201,61,57); }
pre.hljl > span.hljl-sb { color: rgb(201,61,57); }
pre.hljl > span.hljl-sc { color: rgb(201,61,57); }
pre.hljl > span.hljl-sd { color: rgb(201,61,57); }
pre.hljl > span.hljl-sdB { color: rgb(201,61,57); }
pre.hljl > span.hljl-sdC { color: rgb(201,61,57); }
pre.hljl > span.hljl-se { color: rgb(59,151,46); }
pre.hljl > span.hljl-sh { color: rgb(201,61,57); }
pre.hljl > span.hljl-si { }
pre.hljl > span.hljl-so { color: rgb(201,61,57); }
pre.hljl > span.hljl-sr { color: rgb(201,61,57); }
pre.hljl > span.hljl-ss { color: rgb(201,61,57); }
pre.hljl > span.hljl-ssB { color: rgb(201,61,57); }
pre.hljl > span.hljl-nB { color: rgb(59,151,46); }
pre.hljl > span.hljl-nbB { color: rgb(59,151,46); }
pre.hljl > span.hljl-nfB { color: rgb(59,151,46); }
pre.hljl > span.hljl-nh { color: rgb(59,151,46); }
pre.hljl > span.hljl-ni { color: rgb(59,151,46); }
pre.hljl > span.hljl-nil { color: rgb(59,151,46); }
pre.hljl > span.hljl-noB { color: rgb(59,151,46); }
pre.hljl > span.hljl-oB { color: rgb(102,102,102); font-weight: bold; }
pre.hljl > span.hljl-ow { color: rgb(102,102,102); font-weight: bold; }
pre.hljl > span.hljl-p { }
pre.hljl > span.hljl-c { color: rgb(153,153,119); font-style: italic; }
pre.hljl > span.hljl-ch { color: rgb(153,153,119); font-style: italic; }
pre.hljl > span.hljl-cm { color: rgb(153,153,119); font-style: italic; }
pre.hljl > span.hljl-cp { color: rgb(153,153,119); font-style: italic; }
pre.hljl > span.hljl-cpB { color: rgb(153,153,119); font-style: italic; }
pre.hljl > span.hljl-cs { color: rgb(153,153,119); font-style: italic; }
pre.hljl > span.hljl-csB { color: rgb(153,153,119); font-style: italic; }
pre.hljl > span.hljl-g { }
pre.hljl > span.hljl-gd { }
pre.hljl > span.hljl-ge { }
pre.hljl > span.hljl-geB { }
pre.hljl > span.hljl-gh { }
pre.hljl > span.hljl-gi { }
pre.hljl > span.hljl-go { }
pre.hljl > span.hljl-gp { }
pre.hljl > span.hljl-gs { }
pre.hljl > span.hljl-gsB { }
pre.hljl > span.hljl-gt { }
</style>



  <style type="text/css">
  .admonition {
    padding: 15px;
    margin-bottom: 21px;
    border-left: 10px solid transparent;
}

.admonition .title {
    margin: 0;
    text-transform: uppercase;
    padding-left: 3px;
    border: 1px solid;
    border-style: hidden hidden solid;
}

.admonition .content {
    padding-left: .75em;
    padding-right: .75em;
    padding-top: 0.5em;
    margin-left: 0;
    border-left: 0;
    border-top: 0;
    min-height: 0;
}

.note {
    border-color: olive;
    background-color: #f6fffe;
}

.note .title {
    color: olive;
    border-color: olive;
}

.tip {
    border-color: blue;
    background-color: #f6fcff;
}

.tip .title {
    color: blue;
    border-color: blue;
}

.warning {
    border-color: orange;
    background-color: #fffeec;
}

.warning .title {
    color: orange;
    border-color: orange;
}

.important {
    border-color: red;
    background-color: #fffbfb;
}

.important .title {
    color: red;
    border-color: red;
}


@font-face {
  font-style: normal;
  font-weight: 300;
}
@font-face {
  font-style: normal;
  font-weight: 400;
}
@font-face {
  font-style: normal;
  font-weight: 600;
}
html {
  font-family: sans-serif; /* 1 */
  -ms-text-size-adjust: 100%; /* 2 */
  -webkit-text-size-adjust: 100%; /* 2 */
}
body {
  margin: 0;
}
article,
aside,
details,
figcaption,
figure,
footer,
header,
hgroup,
main,
menu,
nav,
section,
summary {
  display: block;
}
audio,
canvas,
progress,
video {
  display: inline-block; /* 1 */
  vertical-align: baseline; /* 2 */
}
audio:not([controls]) {
  display: none;
  height: 0;
}
[hidden],
template {
  display: none;
}
a:active,
a:hover {
  outline: 0;
}
abbr[title] {
  border-bottom: 1px dotted;
}
b,
strong {
  font-weight: bold;
}
dfn {
  font-style: italic;
}
h1 {
  font-size: 2em;
  margin: 0.67em 0;
}
mark {
  background: #ff0;
  color: #000;
}
small {
  font-size: 80%;
}
sub,
sup {
  font-size: 75%;
  line-height: 0;
  position: relative;
  vertical-align: baseline;
}
sup {
  top: -0.5em;
}
sub {
  bottom: -0.25em;
}
img {
  border: 0;
}
svg:not(:root) {
  overflow: hidden;
}
figure {
  margin: 1em 40px;
}
hr {
  -moz-box-sizing: content-box;
  box-sizing: content-box;
  height: 0;
}
pre {
  overflow: auto;
}
code,
kbd,
pre,
samp {
  font-family: monospace, monospace;
  font-size: 1em;
}
button,
input,
optgroup,
select,
textarea {
  color: inherit; /* 1 */
  font: inherit; /* 2 */
  margin: 0; /* 3 */
}
button {
  overflow: visible;
}
button,
select {
  text-transform: none;
}
button,
html input[type="button"], /* 1 */
input[type="reset"],
input[type="submit"] {
  -webkit-appearance: button; /* 2 */
  cursor: pointer; /* 3 */
}
button[disabled],
html input[disabled] {
  cursor: default;
}
button::-moz-focus-inner,
input::-moz-focus-inner {
  border: 0;
  padding: 0;
}
input {
  line-height: normal;
}
input[type="checkbox"],
input[type="radio"] {
  box-sizing: border-box; /* 1 */
  padding: 0; /* 2 */
}
input[type="number"]::-webkit-inner-spin-button,
input[type="number"]::-webkit-outer-spin-button {
  height: auto;
}
input[type="search"] {
  -webkit-appearance: textfield; /* 1 */
  -moz-box-sizing: content-box;
  -webkit-box-sizing: content-box; /* 2 */
  box-sizing: content-box;
}
input[type="search"]::-webkit-search-cancel-button,
input[type="search"]::-webkit-search-decoration {
  -webkit-appearance: none;
}
fieldset {
  border: 1px solid #c0c0c0;
  margin: 0 2px;
  padding: 0.35em 0.625em 0.75em;
}
legend {
  border: 0; /* 1 */
  padding: 0; /* 2 */
}
textarea {
  overflow: auto;
}
optgroup {
  font-weight: bold;
}
table {
  font-family: monospace, monospace;
  font-size : 0.8em;
  border-collapse: collapse;
  border-spacing: 0;
}
td,
th {
  padding: 0;
}
thead th {
    border-bottom: 1px solid black;
    background-color: white;
}
tr:nth-child(odd){
  background-color: rgb(248,248,248);
}


/*
* Skeleton V2.0.4
* Copyright 2014, Dave Gamache
* www.getskeleton.com
* Free to use under the MIT license.
* http://www.opensource.org/licenses/mit-license.php
* 12/29/2014
*/
.container {
  position: relative;
  width: 100%;
  max-width: 960px;
  margin: 0 auto;
  padding: 0 20px;
  box-sizing: border-box; }
.column,
.columns {
  width: 100%;
  float: left;
  box-sizing: border-box; }
@media (min-width: 400px) {
  .container {
    width: 85%;
    padding: 0; }
}
@media (min-width: 550px) {
  .container {
    width: 80%; }
  .column,
  .columns {
    margin-left: 4%; }
  .column:first-child,
  .columns:first-child {
    margin-left: 0; }

  .one.column,
  .one.columns                    { width: 4.66666666667%; }
  .two.columns                    { width: 13.3333333333%; }
  .three.columns                  { width: 22%;            }
  .four.columns                   { width: 30.6666666667%; }
  .five.columns                   { width: 39.3333333333%; }
  .six.columns                    { width: 48%;            }
  .seven.columns                  { width: 56.6666666667%; }
  .eight.columns                  { width: 65.3333333333%; }
  .nine.columns                   { width: 74.0%;          }
  .ten.columns                    { width: 82.6666666667%; }
  .eleven.columns                 { width: 91.3333333333%; }
  .twelve.columns                 { width: 100%; margin-left: 0; }

  .one-third.column               { width: 30.6666666667%; }
  .two-thirds.column              { width: 65.3333333333%; }

  .one-half.column                { width: 48%; }

  /* Offsets */
  .offset-by-one.column,
  .offset-by-one.columns          { margin-left: 8.66666666667%; }
  .offset-by-two.column,
  .offset-by-two.columns          { margin-left: 17.3333333333%; }
  .offset-by-three.column,
  .offset-by-three.columns        { margin-left: 26%;            }
  .offset-by-four.column,
  .offset-by-four.columns         { margin-left: 34.6666666667%; }
  .offset-by-five.column,
  .offset-by-five.columns         { margin-left: 43.3333333333%; }
  .offset-by-six.column,
  .offset-by-six.columns          { margin-left: 52%;            }
  .offset-by-seven.column,
  .offset-by-seven.columns        { margin-left: 60.6666666667%; }
  .offset-by-eight.column,
  .offset-by-eight.columns        { margin-left: 69.3333333333%; }
  .offset-by-nine.column,
  .offset-by-nine.columns         { margin-left: 78.0%;          }
  .offset-by-ten.column,
  .offset-by-ten.columns          { margin-left: 86.6666666667%; }
  .offset-by-eleven.column,
  .offset-by-eleven.columns       { margin-left: 95.3333333333%; }

  .offset-by-one-third.column,
  .offset-by-one-third.columns    { margin-left: 34.6666666667%; }
  .offset-by-two-thirds.column,
  .offset-by-two-thirds.columns   { margin-left: 69.3333333333%; }

  .offset-by-one-half.column,
  .offset-by-one-half.columns     { margin-left: 52%; }

}
html {
  font-size: 62.5%; }
body {
  font-size: 1.5em; /* currently ems cause chrome bug misinterpreting rems on body element */
  line-height: 1.6;
  font-weight: 400;
  font-family: "Raleway", "HelveticaNeue", "Helvetica Neue", Helvetica, Arial, sans-serif;
  color: #222; }
h1, h2, h3, h4, h5, h6 {
  margin-top: 0;
  margin-bottom: 2rem;
  font-weight: 300; }
h1 { font-size: 3.6rem; line-height: 1.2;  letter-spacing: -.1rem;}
h2 { font-size: 3.4rem; line-height: 1.25; letter-spacing: -.1rem; }
h3 { font-size: 3.2rem; line-height: 1.3;  letter-spacing: -.1rem; }
h4 { font-size: 2.8rem; line-height: 1.35; letter-spacing: -.08rem; }
h5 { font-size: 2.4rem; line-height: 1.5;  letter-spacing: -.05rem; }
h6 { font-size: 1.5rem; line-height: 1.6;  letter-spacing: 0; }

p {
  margin-top: 0; }
a {
  color: #1EAEDB; }
a:hover {
  color: #0FA0CE; }
.button,
button,
input[type="submit"],
input[type="reset"],
input[type="button"] {
  display: inline-block;
  height: 38px;
  padding: 0 30px;
  color: #555;
  text-align: center;
  font-size: 11px;
  font-weight: 600;
  line-height: 38px;
  letter-spacing: .1rem;
  text-transform: uppercase;
  text-decoration: none;
  white-space: nowrap;
  background-color: transparent;
  border-radius: 4px;
  border: 1px solid #bbb;
  cursor: pointer;
  box-sizing: border-box; }
.button:hover,
button:hover,
input[type="submit"]:hover,
input[type="reset"]:hover,
input[type="button"]:hover,
.button:focus,
button:focus,
input[type="submit"]:focus,
input[type="reset"]:focus,
input[type="button"]:focus {
  color: #333;
  border-color: #888;
  outline: 0; }
.button.button-primary,
button.button-primary,
input[type="submit"].button-primary,
input[type="reset"].button-primary,
input[type="button"].button-primary {
  color: #FFF;
  background-color: #33C3F0;
  border-color: #33C3F0; }
.button.button-primary:hover,
button.button-primary:hover,
input[type="submit"].button-primary:hover,
input[type="reset"].button-primary:hover,
input[type="button"].button-primary:hover,
.button.button-primary:focus,
button.button-primary:focus,
input[type="submit"].button-primary:focus,
input[type="reset"].button-primary:focus,
input[type="button"].button-primary:focus {
  color: #FFF;
  background-color: #1EAEDB;
  border-color: #1EAEDB; }
input[type="email"],
input[type="number"],
input[type="search"],
input[type="text"],
input[type="tel"],
input[type="url"],
input[type="password"],
textarea,
select {
  height: 38px;
  padding: 6px 10px; /* The 6px vertically centers text on FF, ignored by Webkit */
  background-color: #fff;
  border: 1px solid #D1D1D1;
  border-radius: 4px;
  box-shadow: none;
  box-sizing: border-box; }
/* Removes awkward default styles on some inputs for iOS */
input[type="email"],
input[type="number"],
input[type="search"],
input[type="text"],
input[type="tel"],
input[type="url"],
input[type="password"],
textarea {
  -webkit-appearance: none;
     -moz-appearance: none;
          appearance: none; }
textarea {
  min-height: 65px;
  padding-top: 6px;
  padding-bottom: 6px; }
input[type="email"]:focus,
input[type="number"]:focus,
input[type="search"]:focus,
input[type="text"]:focus,
input[type="tel"]:focus,
input[type="url"]:focus,
input[type="password"]:focus,
textarea:focus,
select:focus {
  border: 1px solid #33C3F0;
  outline: 0; }
label,
legend {
  display: block;
  margin-bottom: .5rem;
  font-weight: 600; }
fieldset {
  padding: 0;
  border-width: 0; }
input[type="checkbox"],
input[type="radio"] {
  display: inline; }
label > .label-body {
  display: inline-block;
  margin-left: .5rem;
  font-weight: normal; }
ul {
  list-style: circle; }
ol {
  list-style: decimal; }
ul ul,
ul ol,
ol ol,
ol ul {
  margin: 1.5rem 0 1.5rem 3rem;
  font-size: 90%; }
li > p {margin : 0;}
th,
td {
  padding: 12px 15px;
  text-align: left;
  border-bottom: 1px solid #E1E1E1; }
th:first-child,
td:first-child {
  padding-left: 0; }
th:last-child,
td:last-child {
  padding-right: 0; }
button,
.button {
  margin-bottom: 1rem; }
input,
textarea,
select,
fieldset {
  margin-bottom: 1.5rem; }
pre,
blockquote,
dl,
figure,
table,
p,
ul,
ol,
form {
  margin-bottom: 1.0rem; }
.u-full-width {
  width: 100%;
  box-sizing: border-box; }
.u-max-full-width {
  max-width: 100%;
  box-sizing: border-box; }
.u-pull-right {
  float: right; }
.u-pull-left {
  float: left; }
hr {
  margin-top: 3rem;
  margin-bottom: 3.5rem;
  border-width: 0;
  border-top: 1px solid #E1E1E1; }
.container:after,
.row:after,
.u-cf {
  content: "";
  display: table;
  clear: both; }

pre {
  display: block;
  padding: 9.5px;
  margin: 0 0 10px;
  font-size: 13px;
  line-height: 1.42857143;
  word-break: break-all;
  word-wrap: break-word;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre.hljl {
  margin: 0 0 10px;
  display: block;
  background: #f5f5f5;
  border-radius: 4px;
  padding : 5px;
}

pre.output {
  background: #ffffff;
}

pre.code {
  background: #ffffff;
}

pre.julia-error {
  color : red
}

code,
kbd,
pre,
samp {
  font-family: Menlo, Monaco, Consolas, "Courier New", monospace;
  font-size: 0.9em;
}


@media (min-width: 400px) {}
@media (min-width: 550px) {}
@media (min-width: 750px) {}
@media (min-width: 1000px) {}
@media (min-width: 1200px) {}

h1.title {margin-top : 20px}
img {max-width : 100%}
div.title {text-align: center;}

  </style>
</HEAD>

<BODY>
  <div class ="container">
    <div class = "row">
      <div class = "col-md-12 twelve columns">
        <div class="title">
          
          
          
        </div>

        <h1>Numeric integration with julia</h1>
<h2>Introduction</h2>
<p>Let <span class="math">$f(x)$</span> be some non-negative, continuous function over the interval <span class="math">$[a,b]$</span>. The area under the graph of <span class="math">$f(x)$</span> is given by the definite integral:</p>
<p class="math">\[
\text{Area under f} = \int_a^b f(x) dx
\]</p>
<p>Computing this area is <em>often</em> made easier with the Fundamental Theorem of Calculus which states in one form that one can compute a definite integral through knowledge of an antiderivative. In particular, if <span class="math">$F(x)$</span> is an antiderivative for <span class="math">$f(x)$</span>, a continuous function, then</p>
<p class="math">\[
\int_a^b f(x) dx = F(b) - F(a).
\]</p>
<p>This is great as long as some antiderivative is known. There are several different techniques for finding antiderivatives. The <code>integrate</code> function in the <code>SymPy</code> package can do many of them:</p>


<pre class='hljl'>
<span class='hljl-k'>using</span><span class='hljl-t'> </span><span class='hljl-n'>MTH229</span><span class='hljl-t'>
</span><span class='hljl-k'>using</span><span class='hljl-t'> </span><span class='hljl-n'>Plots</span><span class='hljl-t'>
</span><span class='hljl-nf'>plotly</span><span class='hljl-p'>()</span>
</pre>


<pre class="output">
Plots.PlotlyBackend&#40;&#41;
</pre>




<pre class='hljl'>
<span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-oB'>^</span><span class='hljl-ni'>3</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-nf'>cos</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-oB'>*</span><span class='hljl-nf'>log</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nd'>@syms</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-t'>
</span><span class='hljl-nf'>integrate</span><span class='hljl-p'>(</span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
4    2           2         
x    x ⋅log&#40;x&#41;   x          
── &#43; ───────── - ── - sin&#40;x&#41;
4        2       4
</pre>


<p>To find the definite integral, say from <span class="math">$1$</span> to <span class="math">$10$</span> we have:</p>


<pre class='hljl'>
<span class='hljl-nf'>integrate</span><span class='hljl-p'>(</span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>10</span><span class='hljl-p'>))</span>
</pre>


<pre class="output">
-sin&#40;10&#41; &#43; sin&#40;1&#41; &#43; 50⋅log&#40;10&#41; &#43; 2475
</pre>


<p>If all functions had antiderivatives that could be found symbolically, there wouldn&#39;t be much more to say.  However, it is a fact of life that not all nice functions will have an antiderivative in a convenient form. A test for such functions is provided in <a href="http://en.wikipedia.org/wiki/Risch_algorithm">Risch&#39;s algorithm</a>. In cases where no workable antiderivative is available, the above approach is of no help. Rather, to find the area one can turn to numeric approximations that progressively get better as more approximations are taken.</p>
<p>One such approximation is given by the familiar Riemann sums, which we will look at here. However, the problem of trying to find the area of geometric figures did not start with Riemann some 150 years ago, indeed it has a much longer history.  In the time of Pythagorus the idea of calculating area was one of being able to construct a square of equal area to a figure. This was known as <em>quadrature</em>.  Finding such answers for figures bounded by curves was difficult, though <a href="http://en.wikipedia.org/wiki/The_Quadrature_of_the_Parabola">Archimedes</a> effectively computed the area under <span class="math">$f(x) = x^2$</span> about 2,000 years before Riemann sums using triangles, not rectangles to approximate the area.  By medieval Europe, the term <em>quadrature</em> evolved to be the computation of an area by any means. For example, <a href="http://en.wikipedia.org/wiki/Quadrature_&#40;mathematics&#41;">Galileo and Roberval</a> found the area bounded by a cycloid arch. Along the way, other approximations were used.  We will see those due to Simpson and Gauss, both predating Riemann.</p>
<h2>Riemann sums</h2>
<p>In 1854 Riemann was the first to give a rigorous definition of the integral of a continuous function on a closed interval, the problem we wish to solve here, using the concept of a <em>Riemann sum</em>. A Riemann sum is one of the simplest to understand approximations to the area under a curve. The basic idea is that the interval <span class="math">$[a,b]$</span> is partitioned through points <span class="math">$a = x_0 < x_1 < \cdots x_n = b$</span> and the area under <span class="math">$f(x)$</span> between <span class="math">$x_i$</span> and <span class="math">$x_{i+1}$</span> is approximated by a rectangle with the base <span class="math">$x_{i+1} - x_i$</span> and height given by <span class="math">$f(x_i^*)$</span>, where <span class="math">$x_i^*$</span> is some point in the interval <span class="math">$[x_i, x_{i+1}]$</span>. Typical choices are the left point or the right point of the interval, or the <span class="math">$x$</span> value which minizes or maximizes <span class="math">$f$</span> over the interval. The figure shows these four choices for some sample function. For a <em>Riemann integrable</em> function, such as a continuous function on <span class="math">$[a,b]$</span>, any of the choices will yield the same value as the partition&#39;s mesh shrinks to <span class="math">$0$</span>.</p>
<p><img src="figures/integration/riemann_choice.png" alt="Riemann" /></p>
<p>As with other limits, we can numerically approximate the limit by computing the Riemann sum for some partition. The steps for this include:</p>
<ul>
<li><p>creating a partition of <span class="math">$[a,b]$</span>. We will use evenly spaced points for convenience.</p>
</li>
<li><p>Selecting the <span class="math">$x_i^*$</span> within the partition</p>
</li>
<li><p>Computing the values <span class="math">$f(x_i^*)(x_{i+1} - x_i)$</span> for each <span class="math">$i$</span></p>
</li>
<li><p>adding these values up</p>
</li>
</ul>
<p>If we partition <span class="math">$[a,b]$</span> into <span class="math">$n$</span> same sized intervals, then each has length <span class="math">$\delta = (b-a)/n$</span> and so the points are separated by this amount. As such, we can choose our <span class="math">$a = x_0 < x_1 < \dots < x_n = b$</span> with commands like:</p>


<pre class='hljl'>
<span class='hljl-n'>a</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>b</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>n</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>3</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>5</span><span class='hljl-p'>;</span><span class='hljl-t'>
</span><span class='hljl-n'>delta</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>b</span><span class='hljl-oB'>-</span><span class='hljl-n'>a</span><span class='hljl-p'>)</span><span class='hljl-oB'>/</span><span class='hljl-n'>n</span><span class='hljl-p'>;</span><span class='hljl-t'>
</span><span class='hljl-n'>xs</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>a</span><span class='hljl-t'> </span><span class='hljl-oB'>.+</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-ni'>0</span><span class='hljl-oB'>:</span><span class='hljl-n'>n</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-n'>delta</span>
</pre>


<pre class="output">
1.0:0.4:3.0
</pre>


<p>To apply a function to a range of values, we may use a map, a comprehension, a <code>for</code> loop or the &quot;dot&quot; notation. We will use broadcasting here. Recall, the syntax:</p>


<pre class='hljl'>
<span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-oB'>^</span><span class='hljl-ni'>2</span><span class='hljl-t'>
</span><span class='hljl-n'>fxs</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>xs</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
6-element Vector&#123;Float64&#125;:
 1.0
 1.9599999999999997
 3.24
 4.840000000000001
 6.760000000000001
 9.0
</pre>


<p>Now to add the numbers up. For this task, the <code>sum</code> function is available</p>


<pre class='hljl'>
<span class='hljl-nf'>sum</span><span class='hljl-p'>(</span><span class='hljl-n'>fxs</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
26.8
</pre>


<p>Okay, just one subtlety, we really only want the points</p>


<pre class='hljl'>
<span class='hljl-p'>[</span><span class='hljl-t'> </span><span class='hljl-n'>a</span><span class='hljl-t'> </span><span class='hljl-oB'>.+</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-ni'>0</span><span class='hljl-oB'>:</span><span class='hljl-n'>n</span><span class='hljl-oB'>-</span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-n'>delta</span><span class='hljl-t'> </span><span class='hljl-p'>]</span>
</pre>


<pre class="output">
1-element Vector&#123;StepRangeLen&#123;Float64, Base.TwicePrecision&#123;Float64&#125;, Base.T
wicePrecision&#123;Float64&#125;, Int64&#125;&#125;:
 1.0:0.4:2.6
</pre>


<p>for the left Riemann sum and the points</p>


<pre class='hljl'>
<span class='hljl-p'>[</span><span class='hljl-t'> </span><span class='hljl-n'>a</span><span class='hljl-t'> </span><span class='hljl-oB'>.+</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-ni'>1</span><span class='hljl-oB'>:</span><span class='hljl-n'>n</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-n'>delta</span><span class='hljl-t'> </span><span class='hljl-p'>]</span>
</pre>


<pre class="output">
1-element Vector&#123;StepRangeLen&#123;Float64, Base.TwicePrecision&#123;Float64&#125;, Base.T
wicePrecision&#123;Float64&#125;, Int64&#125;&#125;:
 1.4:0.4:3.0
</pre>


<p>for the right.</p>
<p>Putting this together, here are commands to approximate the area under the curve <span class="math">$f(x)=x^2$</span> using 10 left Riemann sums:</p>


<pre class='hljl'>
<span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-oB'>^</span><span class='hljl-ni'>2</span><span class='hljl-t'>
</span><span class='hljl-n'>a</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>b</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>n</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>3</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>10</span><span class='hljl-p'>;</span><span class='hljl-t'>		   </span><span class='hljl-cs'>## note n=10</span><span class='hljl-t'>
</span><span class='hljl-n'>delta</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>b</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-n'>a</span><span class='hljl-p'>)</span><span class='hljl-oB'>/</span><span class='hljl-n'>n</span><span class='hljl-p'>;</span><span class='hljl-t'>		   </span><span class='hljl-cs'>## nothing to change below here</span><span class='hljl-t'>
</span><span class='hljl-n'>xs</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>a</span><span class='hljl-t'> </span><span class='hljl-oB'>.+</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-ni'>0</span><span class='hljl-oB'>:</span><span class='hljl-n'>n</span><span class='hljl-oB'>-</span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-n'>delta</span><span class='hljl-p'>;</span><span class='hljl-t'>          </span><span class='hljl-cs'>## n, right is 1:n * delta</span><span class='hljl-t'>
</span><span class='hljl-n'>fxs</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>xs</span><span class='hljl-p'>);</span><span class='hljl-t'>
</span><span class='hljl-nf'>sum</span><span class='hljl-p'>(</span><span class='hljl-n'>fxs</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-n'>delta</span>
</pre>


<pre class="output">
7.88
</pre>


<p>We compare this value to the known value from the Fundamental Theorem of Calculus, as <span class="math">$F(x) = x^3/3$</span> is an antiderivative:</p>


<pre class='hljl'>
<span class='hljl-nf'>F</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-oB'>^</span><span class='hljl-ni'>3</span><span class='hljl-oB'>/</span><span class='hljl-ni'>3</span><span class='hljl-t'>
</span><span class='hljl-nf'>F</span><span class='hljl-p'>(</span><span class='hljl-n'>b</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-nf'>F</span><span class='hljl-p'>(</span><span class='hljl-n'>a</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
8.666666666666666
</pre>


<p>Boy, not too close. We need a better approximation of course. This can be achieved by using larger values for <code>n</code>.</p>
<h3>Practice</h3>
<h4>Question</h4>
<p>Repeat with n&#61;100</p>
<p>For the same problem, let <span class="math">$n=100$</span>. What do you get?</p>


<form class="mx-2 my-3" name='WeaveQuestion' data-id='KvMpNJNF' data-controltype=''>
  <div class='form-group '>
    <div class='controls'>
      <div class="form-floating input-group" id="controls_KvMpNJNF">
        <div style="padding-top: 5px">
    <div class="row">
  <span style="width:90%">
    <input id="KvMpNJNF" type="number" class="form-control" placeholder="Numeric answer">
  </span>
  <span style="width:10%">
  </span>
</div>

    
        </div>
      </div>
      <div id='KvMpNJNF_message' style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text='text/javascript'>
document.getElementById("KvMpNJNF").addEventListener("change", function() {
  var correct = (Math.abs(this.value - 8.5868) <= 0.0001);
  var msgBox = document.getElementById('KvMpNJNF_message');
    if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_KvMpNJNF")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_KvMpNJNF")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

});

</script>


<h4>Question</h4>
<p>Repeat with n&#61;1,000</p>
<p>For the same problem, let <span class="math">$n=1000$</span>. What do you get?</p>


<form class="mx-2 my-3" name='WeaveQuestion' data-id='paNya8rL' data-controltype=''>
  <div class='form-group '>
    <div class='controls'>
      <div class="form-floating input-group" id="controls_paNya8rL">
        <div style="padding-top: 5px">
    <div class="row">
  <span style="width:90%">
    <input id="paNya8rL" type="number" class="form-control" placeholder="Numeric answer">
  </span>
  <span style="width:10%">
  </span>
</div>

    
        </div>
      </div>
      <div id='paNya8rL_message' style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text='text/javascript'>
document.getElementById("paNya8rL").addEventListener("change", function() {
  var correct = (Math.abs(this.value - 8.658668) <= 0.0001);
  var msgBox = document.getElementById('paNya8rL_message');
    if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_paNya8rL")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_paNya8rL")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

});

</script>


<h4>Question</h4>
<p>Repeat with n&#61;10,000</p>
<p>For the same problem, let <span class="math">$n=10,000$</span>. is the difference between the answer and the actual answer within <span class="math">$0.001$</span>?</p>


<form class="mx-2 my-3" name='WeaveQuestion' data-id='IpbeKsl3' data-controltype=''>
  <div class='form-group '>
    <div class='controls'>
      <div class="form-floating input-group" id="controls_IpbeKsl3">
        <div style="padding-top: 5px">
    <div class="form-check">
  <label>
    <input class="form-check-input" type="radio" name="radio_IpbeKsl3"
              id="radio_IpbeKsl3_1" value="1">
      <span = class="label-body">
        true
      </span>
    </input>
  </label>
</div>
<div class="form-check">
  <label>
    <input class="form-check-input" type="radio" name="radio_IpbeKsl3"
              id="radio_IpbeKsl3_2" value="2">
      <span = class="label-body">
        false
      </span>
    </input>
  </label>
</div>

    
        </div>
      </div>
      <div id='IpbeKsl3_message' style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text='text/javascript'>
document.querySelectorAll('input[name="radio_IpbeKsl3"]').forEach(function(rb) {
rb.addEventListener("change", function() {
    var correct = rb.value == 1;
    var msgBox = document.getElementById('IpbeKsl3_message');
      if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_IpbeKsl3")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_IpbeKsl3")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

})});

</script>


<h4>Question</h4>
<p>How big should n be? &#40;Strang&#41;</p>
<p>Let <span class="math">$f(x) = (10 + \cos(2\pi x))^{-1}$</span>. For the integral over <span class="math">$[0,1]$</span>, the known answer is <span class="math">$1/\sqrt{99}$</span>. How big must <span class="math">$n$</span> be so that the error in the Riemann sum is less than <span class="math">$10^{-8}$</span>?</p>


<form class="mx-2 my-3" name='WeaveQuestion' data-id='Zsi7WiMI' data-controltype=''>
  <div class='form-group '>
    <div class='controls'>
      <div class="form-floating input-group" id="controls_Zsi7WiMI">
        <div style="padding-top: 5px">
    <div class="form-check">
  <label>
    <input class="form-check-input" type="radio" name="radio_Zsi7WiMI"
              id="radio_Zsi7WiMI_1" value="1">
      <span = class="label-body">
        100
      </span>
    </input>
  </label>
</div>
<div class="form-check">
  <label>
    <input class="form-check-input" type="radio" name="radio_Zsi7WiMI"
              id="radio_Zsi7WiMI_2" value="2">
      <span = class="label-body">
        5
      </span>
    </input>
  </label>
</div>
<div class="form-check">
  <label>
    <input class="form-check-input" type="radio" name="radio_Zsi7WiMI"
              id="radio_Zsi7WiMI_3" value="3">
      <span = class="label-body">
        10
      </span>
    </input>
  </label>
</div>
<div class="form-check">
  <label>
    <input class="form-check-input" type="radio" name="radio_Zsi7WiMI"
              id="radio_Zsi7WiMI_4" value="4">
      <span = class="label-body">
        10000
      </span>
    </input>
  </label>
</div>
<div class="form-check">
  <label>
    <input class="form-check-input" type="radio" name="radio_Zsi7WiMI"
              id="radio_Zsi7WiMI_5" value="5">
      <span = class="label-body">
        1000
      </span>
    </input>
  </label>
</div>

    
        </div>
      </div>
      <div id='Zsi7WiMI_message' style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text='text/javascript'>
document.querySelectorAll('input[name="radio_Zsi7WiMI"]').forEach(function(rb) {
rb.addEventListener("change", function() {
    var correct = rb.value == 3;
    var msgBox = document.getElementById('Zsi7WiMI_message');
      if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_Zsi7WiMI")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_Zsi7WiMI")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

})});

</script>


<h2>Integrate function</h2>
<p>Here we write a function to do the integration. This needs the basic inputs of</p>
<ul>
<li><p>a function,</p>
</li>
<li><p>the interval&#39;s start and end value, and</p>
</li>
<li><p>the number of equal-sized subintervals.</p>
</li>
</ul>
<p>In addition, we allow for the possibility of using different methods to approximate the area over a sub interval. Different possibilities are:</p>
<ul>
<li><p>using a rectangle with the left endpoint to determine the height &#40;<code>method&#61;&quot;left&quot;</code>&#41;</p>
</li>
<li><p>using a rectangle with the right endpoint to determine the height &#40;<code>method&#61;&quot;right&quot;</code>&#41;</p>
</li>
<li><p>using a trapezoid formed by joining the left and right endpoints &#40;<code>method&#61;&quot;trapezoid&quot;</code>&#41;</p>
</li>
<li><p>making the cap a quadratic polynomial that goes through the left and right endpoints and the midpoint &#40;<code>method&#61;&quot;simpsons&quot;</code>&#41;</p>
</li>
</ul>
<p>This function is defined in <code>MTH229</code>:</p>


<pre class='hljl'>
<span class='hljl-k'>function</span><span class='hljl-t'> </span><span class='hljl-nf'>riemann</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-oB'>::</span><span class='hljl-n'>Function</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>a</span><span class='hljl-oB'>::</span><span class='hljl-n'>Real</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>b</span><span class='hljl-oB'>::</span><span class='hljl-n'>Real</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>n</span><span class='hljl-oB'>::</span><span class='hljl-n'>Int</span><span class='hljl-p'>;</span><span class='hljl-t'> </span><span class='hljl-n'>method</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;right&quot;</span><span class='hljl-p'>)</span><span class='hljl-t'>
  </span><span class='hljl-k'>if</span><span class='hljl-t'> </span><span class='hljl-n'>method</span><span class='hljl-t'> </span><span class='hljl-oB'>==</span><span class='hljl-t'> </span><span class='hljl-s'>&quot;right&quot;</span><span class='hljl-t'>
     </span><span class='hljl-n'>meth</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-n'>l</span><span class='hljl-p'>,</span><span class='hljl-n'>r</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>-&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>r</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>r</span><span class='hljl-oB'>-</span><span class='hljl-n'>l</span><span class='hljl-p'>)</span><span class='hljl-t'>
  </span><span class='hljl-k'>elseif</span><span class='hljl-t'> </span><span class='hljl-n'>method</span><span class='hljl-t'> </span><span class='hljl-oB'>==</span><span class='hljl-t'> </span><span class='hljl-s'>&quot;left&quot;</span><span class='hljl-t'>
     </span><span class='hljl-n'>meth</span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-n'>l</span><span class='hljl-p'>,</span><span class='hljl-n'>r</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>-&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>l</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>r</span><span class='hljl-oB'>-</span><span class='hljl-n'>l</span><span class='hljl-p'>)</span><span class='hljl-t'>
  </span><span class='hljl-k'>elseif</span><span class='hljl-t'> </span><span class='hljl-n'>method</span><span class='hljl-t'> </span><span class='hljl-oB'>==</span><span class='hljl-t'> </span><span class='hljl-s'>&quot;trapezoid&quot;</span><span class='hljl-t'>
     </span><span class='hljl-n'>meth</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-n'>l</span><span class='hljl-p'>,</span><span class='hljl-n'>r</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>-&gt;</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-ni'>1</span><span class='hljl-oB'>/</span><span class='hljl-ni'>2</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>l</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>r</span><span class='hljl-p'>))</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>r</span><span class='hljl-oB'>-</span><span class='hljl-n'>l</span><span class='hljl-p'>)</span><span class='hljl-t'>
  </span><span class='hljl-k'>elseif</span><span class='hljl-t'> </span><span class='hljl-n'>method</span><span class='hljl-t'> </span><span class='hljl-oB'>==</span><span class='hljl-t'> </span><span class='hljl-s'>&quot;simpsons&quot;</span><span class='hljl-t'>
     </span><span class='hljl-n'>meth</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-n'>l</span><span class='hljl-p'>,</span><span class='hljl-n'>r</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>-&gt;</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-ni'>1</span><span class='hljl-oB'>/</span><span class='hljl-ni'>6</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>l</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-ni'>4</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-nf'>f</span><span class='hljl-p'>((</span><span class='hljl-n'>l</span><span class='hljl-oB'>+</span><span class='hljl-n'>r</span><span class='hljl-p'>)</span><span class='hljl-oB'>/</span><span class='hljl-ni'>2</span><span class='hljl-p'>))</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>r</span><span class='hljl-p'>))</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>r</span><span class='hljl-oB'>-</span><span class='hljl-n'>l</span><span class='hljl-p'>)</span><span class='hljl-t'>
  </span><span class='hljl-k'>end</span><span class='hljl-t'>

  </span><span class='hljl-n'>xs</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>range</span><span class='hljl-p'>(</span><span class='hljl-n'>a</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>b</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>length</span><span class='hljl-oB'>=</span><span class='hljl-n'>n</span><span class='hljl-oB'>+</span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span><span class='hljl-t'>
  </span><span class='hljl-n'>lrs</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>zip</span><span class='hljl-p'>(</span><span class='hljl-n'>Iterators</span><span class='hljl-oB'>.</span><span class='hljl-nf'>take</span><span class='hljl-p'>(</span><span class='hljl-n'>xs</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>n</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>Iterators</span><span class='hljl-oB'>.</span><span class='hljl-nf'>rest</span><span class='hljl-p'>(</span><span class='hljl-n'>xs</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-p'>))</span><span class='hljl-t'>
  </span><span class='hljl-nf'>sum</span><span class='hljl-p'>(</span><span class='hljl-nf'>meth</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>l</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>r</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-k'>for</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>l</span><span class='hljl-p'>,</span><span class='hljl-n'>r</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-kp'>in</span><span class='hljl-t'> </span><span class='hljl-n'>lrs</span><span class='hljl-p'>)</span><span class='hljl-t'>

</span><span class='hljl-k'>end</span>
</pre>


<h3>The integrate function in action</h3>
<p>The basic usage of the <code>riemann</code> function is straightforward. Here we approximate the integral of <span class="math">$e^{-x^2}$</span> from <span class="math">$0$</span> to <span class="math">$3$</span> using <span class="math">$10,000$</span> subintervals:</p>


<pre class='hljl'>
<span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'>  </span><span class='hljl-nf'>exp</span><span class='hljl-p'>(</span><span class='hljl-oB'>-</span><span class='hljl-n'>x</span><span class='hljl-oB'>^</span><span class='hljl-ni'>2</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>riemann</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>3</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>10_000</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
0.8860573667654068
</pre>


<p>How big should the number of intervals be? More intervals will give better answers, but unlike Newton&#39;s method we have no stopping criteria.  For this problem, we look at various values based on <code>n</code>:</p>


<pre class='hljl'>
<span class='hljl-p'>[</span><span class='hljl-nf'>riemann</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>3</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>n</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-k'>for</span><span class='hljl-t'> </span><span class='hljl-n'>n</span><span class='hljl-t'> </span><span class='hljl-kp'>in</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-ni'>100</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>1000</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>10000</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>100000</span><span class='hljl-p'>]]</span><span class='hljl-t'>   </span><span class='hljl-cs'>## or use 10.^(2:5)</span>
</pre>


<pre class="output">
4-element Vector&#123;Float64&#125;:
 0.8712091438971507
 0.8847075328188829
 0.8860573667654068
 0.8861923501100907
</pre>


<p>We see a value around <span class="math">$0.886$</span> as the answer.</p>
<h3>left versus right</h3>
<p>Using different methods allows us to compare the right and left Riemann sums. Let&#39;s do so for the monotonic function <span class="math">$e^x$</span> over the interval <span class="math">$[0,2]$</span>.</p>


<pre class='hljl'>
<span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>exp</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>ns</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-ni'>10</span><span class='hljl-oB'>^</span><span class='hljl-n'>i</span><span class='hljl-t'> </span><span class='hljl-k'>for</span><span class='hljl-t'> </span><span class='hljl-n'>i</span><span class='hljl-t'> </span><span class='hljl-kp'>in</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-oB'>:</span><span class='hljl-ni'>5</span><span class='hljl-p'>]</span><span class='hljl-t'>
</span><span class='hljl-n'>ys</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-nf'>riemann</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>2</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>n</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>method</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;right&quot;</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-nf'>riemann</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>2</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>n</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>method</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;left&quot;</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-k'>for</span><span class='hljl-t'> </span><span class='hljl-n'>n</span><span class='hljl-t'> </span><span class='hljl-kp'>in</span><span class='hljl-t'> </span><span class='hljl-n'>ns</span><span class='hljl-p'>];</span><span class='hljl-t'>
</span><span class='hljl-p'>[</span><span class='hljl-n'>ns</span><span class='hljl-t'> </span><span class='hljl-n'>ys</span><span class='hljl-p'>]</span>
</pre>


<pre class="output">
5×2 Matrix&#123;Float64&#125;:
     10.0  1.27781
    100.0  0.127781
   1000.0  0.0127781
  10000.0  0.00127781
 100000.0  0.000127781
</pre>


<p>Since these are also the minimum and maximum Riemann sums, the above gives a bound on the error in the approximations. We can see it converges quite slowly, in that there are quite a few computations needed to get even a modest bound. &#40;<span class="math">$100,000$</span> for <span class="math">$0.00013$</span>&#41;.</p>
<h3>Practice</h3>
<h4>Question</h4>
<p>Compute the integral of <span class="math">$e^{-x^2}$</span> over <span class="math">$[0,1]$</span> using a right Riemann sum with <span class="math">$n=1000$</span>. What is your answer?</p>


<form class="mx-2 my-3" name='WeaveQuestion' data-id='pCpolm84' data-controltype=''>
  <div class='form-group '>
    <div class='controls'>
      <div class="form-floating input-group" id="controls_pCpolm84">
        <div style="padding-top: 5px">
    <div class="row">
  <span style="width:90%">
    <input id="pCpolm84" type="number" class="form-control" placeholder="Numeric answer">
  </span>
  <span style="width:10%">
  </span>
</div>

    
        </div>
      </div>
      <div id='pCpolm84_message' style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text='text/javascript'>
document.getElementById("pCpolm84").addEventListener("change", function() {
  var correct = (Math.abs(this.value - 0.7467925261712878) <= 1.0e-8);
  var msgBox = document.getElementById('pCpolm84_message');
    if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_pCpolm84")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_pCpolm84")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

});

</script>


<h4>Question</h4>
<p>Compute the integral of <span class="math">$(1 + \cos(x)^2)^(1/2)$</span> over the interval <span class="math">$[0, \pi]$</span> using a right Riemann sum with <span class="math">$n=10,000$</span>. What is your answer?</p>


<form class="mx-2 my-3" name='WeaveQuestion' data-id='aj5kQlsd' data-controltype=''>
  <div class='form-group '>
    <div class='controls'>
      <div class="form-floating input-group" id="controls_aj5kQlsd">
        <div style="padding-top: 5px">
    <div class="row">
  <span style="width:90%">
    <input id="aj5kQlsd" type="number" class="form-control" placeholder="Numeric answer">
  </span>
  <span style="width:10%">
  </span>
</div>

    
        </div>
      </div>
      <div id='aj5kQlsd_message' style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text='text/javascript'>
document.getElementById("aj5kQlsd").addEventListener("change", function() {
  var correct = (Math.abs(this.value - 3.82019778902772) <= 1.0e-8);
  var msgBox = document.getElementById('aj5kQlsd_message');
    if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_aj5kQlsd")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_aj5kQlsd")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

});

</script>


<h4>Question</h4>
<p>Repeat the above analysis comparing the right and left Riemann sums for <span class="math">$f(x)=e^x$</span> over <span class="math">$[0,2]$</span>. However, this time multiply by <span class="math">$n$</span>, as follows:</p>


<pre class='hljl'>
<span class='hljl-n'>ns</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-ni'>10</span><span class='hljl-oB'>^</span><span class='hljl-n'>i</span><span class='hljl-t'> </span><span class='hljl-k'>for</span><span class='hljl-t'> </span><span class='hljl-n'>i</span><span class='hljl-t'> </span><span class='hljl-kp'>in</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-oB'>:</span><span class='hljl-ni'>5</span><span class='hljl-p'>]</span><span class='hljl-t'>
</span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>exp</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-p'>[</span><span class='hljl-n'>n</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-nf'>riemann</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>2</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>n</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>method</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;right&quot;</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-nf'>riemann</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>2</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>n</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>method</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;left&quot;</span><span class='hljl-p'>))</span><span class='hljl-t'> </span><span class='hljl-k'>for</span><span class='hljl-t'> </span><span class='hljl-n'>n</span><span class='hljl-t'> </span><span class='hljl-kp'>in</span><span class='hljl-t'> </span><span class='hljl-n'>ns</span><span class='hljl-p'>]</span>
</pre>


<pre class="output">
5-element Vector&#123;Float64&#125;:
 12.778112197861295
 12.778112197861358
 12.778112197861624
 12.778112197855407
 12.77811219777547
</pre>


<p>This shows what?</p>


<form class="mx-2 my-3" name='WeaveQuestion' data-id='Ub8XP7fZ' data-controltype=''>
  <div class='form-group '>
    <div class='controls'>
      <div class="form-floating input-group" id="controls_Ub8XP7fZ">
        <div style="padding-top: 5px">
    <div class="form-check">
  <label>
    <input class="form-check-input" type="radio" name="radio_Ub8XP7fZ"
              id="radio_Ub8XP7fZ_1" value="1">
      <span = class="label-body">
        That it is constant says the difference between right and left Riemann sums never goes to 0
      </span>
    </input>
  </label>
</div>
<div class="form-check">
  <label>
    <input class="form-check-input" type="radio" name="radio_Ub8XP7fZ"
              id="radio_Ub8XP7fZ_2" value="2">
      <span = class="label-body">
        That it is constant says the difference between right and left Riemann sums goes to 0 like 1/n
      </span>
    </input>
  </label>
</div>
<div class="form-check">
  <label>
    <input class="form-check-input" type="radio" name="radio_Ub8XP7fZ"
              id="radio_Ub8XP7fZ_3" value="3">
      <span = class="label-body">
        That it is constant says the difference between right and left Riemann sums is constant.
      </span>
    </input>
  </label>
</div>

    
        </div>
      </div>
      <div id='Ub8XP7fZ_message' style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text='text/javascript'>
document.querySelectorAll('input[name="radio_Ub8XP7fZ"]').forEach(function(rb) {
rb.addEventListener("change", function() {
    var correct = rb.value == 2;
    var msgBox = document.getElementById('Ub8XP7fZ_message');
      if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_Ub8XP7fZ")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_Ub8XP7fZ")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

})});

</script>


<h2>Improvements to the rectangle method</h2>
<p>The basic left or right Riemann sum will converge, but the convergence is really slow. The value of using rectangles over a grid to approximate area is for theoretical computations, for numeric computations better approximations were known well before Riemann. We mention a few:</p>
<ul>
<li><p>The trapezoid rule and Simpson&#39;s rule approximate the area under the curve better, as instead of a rectangle they use a trapezoid &#40;linear fit between two points&#41; or a quadratic fit between the two points.&#41;</p>
</li>
<li><p>Gauss quadrature uses non-evenly selected points within the range and a weighting which is exact for polynomials of a given degree.</p>
</li>
<li><p>Adaptive methods pick a non-uniform set of points to use based on where a function is less well behaved.</p>
</li>
</ul>
<h3>Trapezoid and Simpson&#39;s rule</h3>
<p>The trapezoid rule simply replaces the approximation of the area in a subinterval by a trapezoid, as opposed to a rectangle.</p>
<p>We can use this as follows. Let&#39;s approximate the area under the curve <span class="math">$y=5x^4$</span> between <span class="math">$0$</span> and <span class="math">$1$</span> &#40;with known answer <span class="math">$1$</span>&#41;:</p>


<pre class='hljl'>
<span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>5</span><span class='hljl-n'>x</span><span class='hljl-oB'>^</span><span class='hljl-ni'>4</span><span class='hljl-t'>
</span><span class='hljl-nf'>riemann</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>1000</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>method</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;trapezoid&quot;</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
1.0000016666665004
</pre>


<p>Pretty close to 1 with just 1,000 subintervals.</p>
<p>We now compare the error with the left Riemann sum for the same size <span class="math">$n$</span>:</p>


<pre class='hljl'>
<span class='hljl-n'>ns</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-ni'>10</span><span class='hljl-oB'>^</span><span class='hljl-n'>i</span><span class='hljl-t'> </span><span class='hljl-k'>for</span><span class='hljl-t'> </span><span class='hljl-n'>i</span><span class='hljl-t'> </span><span class='hljl-kp'>in</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-oB'>:</span><span class='hljl-ni'>5</span><span class='hljl-p'>]</span><span class='hljl-t'>
</span><span class='hljl-n'>left_r</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-nf'>riemann</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>n</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-k'>for</span><span class='hljl-t'> </span><span class='hljl-n'>n</span><span class='hljl-t'> </span><span class='hljl-kp'>in</span><span class='hljl-t'> </span><span class='hljl-n'>ns</span><span class='hljl-p'>];</span><span class='hljl-t'>
</span><span class='hljl-n'>trapezoid_r</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-nf'>riemann</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>n</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>method</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;trapezoid&quot;</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-k'>for</span><span class='hljl-t'> </span><span class='hljl-n'>n</span><span class='hljl-t'> </span><span class='hljl-kp'>in</span><span class='hljl-t'> </span><span class='hljl-n'>ns</span><span class='hljl-p'>];</span><span class='hljl-t'>
</span><span class='hljl-p'>[</span><span class='hljl-n'>ns</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span><span class='hljl-oB'>.-</span><span class='hljl-n'>left_r</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span><span class='hljl-oB'>.-</span><span class='hljl-n'>trapezoid_r</span><span class='hljl-p'>]</span>
</pre>


<pre class="output">
5×3 Matrix&#123;Float64&#125;:
     10.0  -0.26665      -0.01665
    100.0  -0.0251667    -0.000166665
   1000.0  -0.00250167   -1.66667e-6
  10000.0  -0.000250017  -1.66666e-8
 100000.0  -2.50002e-5   -1.62284e-10
</pre>


<p>One can see that the errors are much smaller for the trapezoid method.</p>
<h3>Simpson&#39;s rule</h3>
<p>The trapezoid rule can be viewed as a simple linear approximation to the function <span class="math">$f(x)$</span> over the subinterval <span class="math">$[a, b]$</span>. That is, replace the function with the secant line between these two values and integrate the replacement. With this viewpoint, it is possible that other easy-to-integrate function approximations will lead to improved approximate integrals. Simpson&#39;s method can be viewed in just this way. It replaces <span class="math">$f$</span> by the parabola going through <span class="math">$(a, f(a))$</span>, <span class="math">$(c, f( c))$</span> and <span class="math">$(b, f(b))$</span> where <span class="math">$c=(a+b)/2$</span> is the midpoint between <span class="math">$a$</span> and <span class="math">$b$</span>.</p>
<p>We compare how accurate we get with this rule for the same <code>f</code> as before:</p>


<pre class='hljl'>
<span class='hljl-n'>simpsons_r</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-nf'>riemann</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>n</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>method</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;simpsons&quot;</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-k'>for</span><span class='hljl-t'> </span><span class='hljl-n'>n</span><span class='hljl-t'> </span><span class='hljl-kp'>in</span><span class='hljl-t'> </span><span class='hljl-n'>ns</span><span class='hljl-p'>];</span><span class='hljl-t'>
</span><span class='hljl-p'>[</span><span class='hljl-n'>ns</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span><span class='hljl-oB'>.-</span><span class='hljl-n'>left_r</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span><span class='hljl-oB'>.-</span><span class='hljl-n'>trapezoid_r</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span><span class='hljl-oB'>.-</span><span class='hljl-n'>simpsons_r</span><span class='hljl-p'>]</span>
</pre>


<pre class="output">
5×4 Matrix&#123;Float64&#125;:
     10.0  -0.26665      -0.01665      -4.16667e-6
    100.0  -0.0251667    -0.000166665  -4.16668e-10
   1000.0  -0.00250167   -1.66667e-6   -4.26326e-14
  10000.0  -0.000250017  -1.66666e-8    1.10356e-13
 100000.0  -2.50002e-5   -1.62284e-10   4.37639e-12
</pre>


<p>As can be seen, for this function approximating with a parabola is much quicker to converge. That is, <span class="math">$n$</span> can be smaller yet the same accuracy is maintained. &#40;Of course, there are more computations involved for each, so the number of operations needed may or may not be fewer, that would require some analysis.&#41;</p>
<h3>Error</h3>
<p>It can be shown that the <a href="http://en.wikipedia.org/wiki/Simpson&#37;27s_rule#Error">error for Simpson&#39;s method</a> is bounded by</p>
<p class="math">\[
\frac{1}{90}\frac{1}{2^5} M (b-a)^5 \frac{1}{n^4},
\]</p>
<p>where <span class="math">$M$</span> is a bound on the fourth derivative. As we increase <span class="math">$n$</span>, the error gets small at a quick rate.  By contrast, the error for the trapezoid method will be like <span class="math">$n^{-2}$</span> and the left Riemann sum like <span class="math">$n^{-1}$</span>.</p>
<h3>Practice</h3>
<h4>Question</h4>
<p>The trapezoid rule has no error for linear functions and Simpson&#39;s rule has no error for quadratic functions. Verify the latter by computing the following:</p>


<pre class='hljl'>
<span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-oB'>^</span><span class='hljl-ni'>2</span><span class='hljl-p'>;</span><span class='hljl-t'> </span><span class='hljl-nf'>F</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-oB'>^</span><span class='hljl-ni'>3</span><span class='hljl-oB'>/</span><span class='hljl-ni'>3</span><span class='hljl-t'>
</span><span class='hljl-nf'>riemann</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>10</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>100</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>method</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;simpsons&quot;</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-nf'>F</span><span class='hljl-p'>(</span><span class='hljl-ni'>10</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-nf'>F</span><span class='hljl-p'>(</span><span class='hljl-ni'>0</span><span class='hljl-p'>));</span>
</pre>



<p>How accurate is the approximation? Around</p>


<form class="mx-2 my-3" name='WeaveQuestion' data-id='ZUHP9Kyy' data-controltype=''>
  <div class='form-group '>
    <div class='controls'>
      <div class="form-floating input-group" id="controls_ZUHP9Kyy">
        <div style="padding-top: 5px">
    <div class="form-check">
  <label>
    <input class="form-check-input" type="radio" name="radio_ZUHP9Kyy"
              id="radio_ZUHP9Kyy_1" value="1">
      <span = class="label-body">
        <code>1e-8</code>
      </span>
    </input>
  </label>
</div>
<div class="form-check">
  <label>
    <input class="form-check-input" type="radio" name="radio_ZUHP9Kyy"
              id="radio_ZUHP9Kyy_2" value="2">
      <span = class="label-body">
        <code>1e-10</code>
      </span>
    </input>
  </label>
</div>
<div class="form-check">
  <label>
    <input class="form-check-input" type="radio" name="radio_ZUHP9Kyy"
              id="radio_ZUHP9Kyy_3" value="3">
      <span = class="label-body">
        <code>1e-12</code>
      </span>
    </input>
  </label>
</div>
<div class="form-check">
  <label>
    <input class="form-check-input" type="radio" name="radio_ZUHP9Kyy"
              id="radio_ZUHP9Kyy_4" value="4">
      <span = class="label-body">
        <code>1e-14</code>
      </span>
    </input>
  </label>
</div>
<div class="form-check">
  <label>
    <input class="form-check-input" type="radio" name="radio_ZUHP9Kyy"
              id="radio_ZUHP9Kyy_5" value="5">
      <span = class="label-body">
        <code>1e-16</code>
      </span>
    </input>
  </label>
</div>
<div class="form-check">
  <label>
    <input class="form-check-input" type="radio" name="radio_ZUHP9Kyy"
              id="radio_ZUHP9Kyy_6" value="6">
      <span = class="label-body">
        <code>0</code>
      </span>
    </input>
  </label>
</div>

    
        </div>
      </div>
      <div id='ZUHP9Kyy_message' style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text='text/javascript'>
document.querySelectorAll('input[name="radio_ZUHP9Kyy"]').forEach(function(rb) {
rb.addEventListener("change", function() {
    var correct = rb.value == 4;
    var msgBox = document.getElementById('ZUHP9Kyy_message');
      if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_ZUHP9Kyy")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_ZUHP9Kyy")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

})});

</script>


<h4>Question</h4>
<p>Compare the difference between the trapezoid rule and Simpson&#39;s rule when integrating <span class="math">$\cos(x)$</span> from <span class="math">$0$</span> to <span class="math">$\pi/6$</span>. How big is the difference when <span class="math">$n=10,000$</span>?</p>
<pre><code>a, b, n &#61; 0, pi/6, 10_000
riemann&#40;cos, a, b, n, method&#61;&quot;trapezoid&quot;&#41; - riemann&#40;cos, a, b, n, method&#61;&quot;simpsons&quot;&#41;;</code></pre>
<p>How big is the difference?</p>
<pre><code>choices &#61; &#91;&#96;1e-8&#96;, &#96;1e-10&#96;, &#96;1e-12&#96;, &#96;1e-14&#96;, &#96;1e-16&#96;, &#96;0&#96;&#93;;
ans &#61; 2;
radioq&#40;choices, ans, keep_order&#61;true&#41;</code></pre>
<h4>Question ....</h4>
<p>Using Simpson&#39;s rule and <code>n&#61;1000</code> compute the integral of <span class="math">$f(x) = 1/(1+x^2)$</span> between <span class="math">$0$</span> and <span class="math">$1$</span>.</p>


<form class="mx-2 my-3" name='WeaveQuestion' data-id='YCSCzRqz' data-controltype=''>
  <div class='form-group '>
    <div class='controls'>
      <div class="form-floating input-group" id="controls_YCSCzRqz">
        <div style="padding-top: 5px">
    <div class="row">
  <span style="width:90%">
    <input id="YCSCzRqz" type="number" class="form-control" placeholder="Numeric answer">
  </span>
  <span style="width:10%">
  </span>
</div>

    
        </div>
      </div>
      <div id='YCSCzRqz_message' style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text='text/javascript'>
document.getElementById("YCSCzRqz").addEventListener("change", function() {
  var correct = (Math.abs(this.value - 0.7853981633974487) <= 1.0e-5);
  var msgBox = document.getElementById('YCSCzRqz_message');
    if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_YCSCzRqz")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_YCSCzRqz")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

});

</script>


<h2>The quadgk function</h2>
<p><code>Julia</code> provides the <code>quadgk</code> function to do adaptive Gauss-Konrod quadrature, a modern, fast and accurate means to compute 1-dimensional integrals numerically. This is in the <code>QuadGK</code> package which is loaded with <code>MTH229</code>.</p>
<p>The use is straightforward, and similar to <code>riemann</code> above: you specify a function object, and the limits of integration. You don&#39;t specify <span class="math">$n$</span> – as this is computed adaptively – but you can optionally specify a tolerance which controls the accuracy, though we don&#39;t do so here. For example, a typical usage might be:</p>


<pre class='hljl'>
<span class='hljl-n'>a</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>err</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>quadgk</span><span class='hljl-p'>(</span><span class='hljl-n'>sin</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>pi</span><span class='hljl-p'>)</span><span class='hljl-t'>		</span><span class='hljl-cs'>## 2 is exact</span>
</pre>


<pre class="output">
&#40;2.0, 1.7905676941154525e-12&#41;
</pre>


<p>Two values are returned, the answer and an estimate of the error. In the above, <span class="math">$2$</span> is the exact answer to this integral, the estimated value a just a bit more <span class="math">$2$</span>, but is estimated to be off my no more than the second value, <span class="math">$1.78 \cdot 10^{-12}$</span>.</p>
<p>If just the answer is of interest, then it can be extracted using <em>index notation</em>:</p>


<pre class='hljl'>
<span class='hljl-nf'>quadgk</span><span class='hljl-p'>(</span><span class='hljl-n'>sin</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>pi</span><span class='hljl-p'>)[</span><span class='hljl-ni'>1</span><span class='hljl-p'>]</span><span class='hljl-t'>		</span><span class='hljl-cs'># [1] picks out the first component or two</span>
</pre>


<pre class="output">
2.0
</pre>


<hr />
<p>For another illustration, since Archimedes the known answer for <span class="math">$\int_0^1 x^2 dx$</span> is <span class="math">$1/3$</span>. We see that <code>quadgk</code> gets it right for all the digits:</p>


<pre class='hljl'>
<span class='hljl-nf'>quadgk</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>-&gt;</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-oB'>^</span><span class='hljl-ni'>2</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
&#40;0.3333333333333333, 5.551115123125783e-17&#41;
</pre>


<p>The <code>riemann</code> function is good for pedagogical purposes, but the <code>quadgk</code> function should be used instead of the <code>riemann</code> function – besides being built-in to <code>julia</code> it is more accurate, more robust, fast, and less work to use.</p>
<p>&#40;That <code>quadgk</code> is exact with polynomials is no surprise, as the underlying choice of nodes and weights makes it so for polynomials of certain degree.&#41;</p>
<div class="admonition note"><p class="admonition-title">Info</p><p>For other integration routines, the <code>Cubature</code> package is an interface to the Cubature library &#40;http://ab-initio.mit.edu/wiki/index.php/Cubature&#41; which provides serveral. Cubature is the term for higher dimensional integrals, quadrature refers to finding area. In that package, the function <code>hquadrature</code> is similar to <code>quadgk</code>. &#40;The two are written by the same author.&#41;</p>
</div>
<h3>Practice</h3>
<h4>Question Use quadgk</h4>
<p>Let <span class="math">$f(x) = \exp(-4 \cdot  |x-1/2|)$</span>. Find the integral over <span class="math">$[0,1]$</span> using <code>quadgk</code>:</p>


<form class="mx-2 my-3" name='WeaveQuestion' data-id='i16AyxMH' data-controltype=''>
  <div class='form-group '>
    <div class='controls'>
      <div class="form-floating input-group" id="controls_i16AyxMH">
        <div style="padding-top: 5px">
    <div class="row">
  <span style="width:90%">
    <input id="i16AyxMH" type="number" class="form-control" placeholder="Numeric answer">
  </span>
  <span style="width:10%">
  </span>
</div>

    
        </div>
      </div>
      <div id='i16AyxMH_message' style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text='text/javascript'>
document.getElementById("i16AyxMH").addEventListener("change", function() {
  var correct = (Math.abs(this.value - 0.4323323583816937) <= 1.0e-5);
  var msgBox = document.getElementById('i16AyxMH_message');
    if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_i16AyxMH")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_i16AyxMH")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

});

</script>


<h4>Question Use quadgk</h4>
<p>Let <span class="math">$f(x) = \sin(100\pi x)/(\pi x)$</span>. Find the integral over <span class="math">$[0,1]$</span> using <code>quadgk</code>:</p>


<form class="mx-2 my-3" name='WeaveQuestion' data-id='Dilnk6EL' data-controltype=''>
  <div class='form-group '>
    <div class='controls'>
      <div class="form-floating input-group" id="controls_Dilnk6EL">
        <div style="padding-top: 5px">
    <div class="row">
  <span style="width:90%">
    <input id="Dilnk6EL" type="number" class="form-control" placeholder="Numeric answer">
  </span>
  <span style="width:10%">
  </span>
</div>

    
        </div>
      </div>
      <div id='Dilnk6EL_message' style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text='text/javascript'>
document.getElementById("Dilnk6EL").addEventListener("change", function() {
  var correct = (Math.abs(this.value - 0.49898680869304557) <= 0.0001);
  var msgBox = document.getElementById('Dilnk6EL_message');
    if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_Dilnk6EL")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_Dilnk6EL")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

});

</script>


<h4>Question Use quadgk</h4>
<p>Let <span class="math">$f(x) = \sin(100\pi x)/(100\pi x)$</span>. Using <span class="math">$1,000$</span> points, find the right-Riemann integral over <span class="math">$[0,1]$</span>.</p>


<form class="mx-2 my-3" name='WeaveQuestion' data-id='1poFJaCu' data-controltype=''>
  <div class='form-group '>
    <div class='controls'>
      <div class="form-floating input-group" id="controls_1poFJaCu">
        <div style="padding-top: 5px">
    <div class="row">
  <span style="width:90%">
    <input id="1poFJaCu" type="number" class="form-control" placeholder="Numeric answer">
  </span>
  <span style="width:10%">
  </span>
</div>

    
        </div>
      </div>
      <div id='1poFJaCu_message' style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text='text/javascript'>
document.getElementById("1poFJaCu").addEventListener("change", function() {
  var correct = (Math.abs(this.value - 0.004489951557656134) <= 1.0e-5);
  var msgBox = document.getElementById('1poFJaCu_message');
    if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_1poFJaCu")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_1poFJaCu")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

});

</script>


<p>&#40;The answer via Riemann sums isn&#39;t even correct to 4 decimal points, due to the highly oscillatory nature of the function.&#41;</p>
<h4>Question</h4>
<p>How far off is this Riemann estimate, when <span class="math">$n=100,000$</span>?</p>


<pre class='hljl'>
<span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-oB'>/</span><span class='hljl-p'>(</span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-oB'>^</span><span class='hljl-ni'>4</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>quadgk</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-p'>)[</span><span class='hljl-ni'>1</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-nf'>riemann</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>100_000</span><span class='hljl-p'>);</span>
</pre>




<form class="mx-2 my-3" name='WeaveQuestion' data-id='WQGpHqSH' data-controltype=''>
  <div class='form-group '>
    <div class='controls'>
      <div class="form-floating input-group" id="controls_WQGpHqSH">
        <div style="padding-top: 5px">
    <div class="form-check">
  <label>
    <input class="form-check-input" type="radio" name="radio_WQGpHqSH"
              id="radio_WQGpHqSH_1" value="1">
      <span = class="label-body">
        Roughly <code>1e-4</code>
      </span>
    </input>
  </label>
</div>
<div class="form-check">
  <label>
    <input class="form-check-input" type="radio" name="radio_WQGpHqSH"
              id="radio_WQGpHqSH_2" value="2">
      <span = class="label-body">
        Roughly <code>1e-6</code>
      </span>
    </input>
  </label>
</div>
<div class="form-check">
  <label>
    <input class="form-check-input" type="radio" name="radio_WQGpHqSH"
              id="radio_WQGpHqSH_3" value="3">
      <span = class="label-body">
        Roughly <code>1e-12</code>
      </span>
    </input>
  </label>
</div>

    
        </div>
      </div>
      <div id='WQGpHqSH_message' style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text='text/javascript'>
document.querySelectorAll('input[name="radio_WQGpHqSH"]').forEach(function(rb) {
rb.addEventListener("change", function() {
    var correct = rb.value == 2;
    var msgBox = document.getElementById('WQGpHqSH_message');
      if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_WQGpHqSH")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_WQGpHqSH")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

})});

</script>


<h4>Question</h4>
<p>The <code>quadgk</code> function allows you to specify issues where there are troubles. For example, we know that <span class="math">$f(x) = \sin(x)/x$</span> has an issue at 0. Directly trying this integral <code>quadgk&#40;x-&gt;sin&#40;x&#41;/x, -pi, pi&#41;</code> will fail, but you can specify the issue at <span class="math">$0$</span> as follows <code>quadgk&#40;x -&gt; sin&#40;x&#41;/x, -pi, 0, pi&#41;</code>. Do so. What is the value of the result:</p>


<form class="mx-2 my-3" name='WeaveQuestion' data-id='by5P7sCf' data-controltype=''>
  <div class='form-group '>
    <div class='controls'>
      <div class="form-floating input-group" id="controls_by5P7sCf">
        <div style="padding-top: 5px">
    <div class="row">
  <span style="width:90%">
    <input id="by5P7sCf" type="number" class="form-control" placeholder="Numeric answer">
  </span>
  <span style="width:10%">
  </span>
</div>

    
        </div>
      </div>
      <div id='by5P7sCf_message' style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text='text/javascript'>
document.getElementById("by5P7sCf").addEventListener("change", function() {
  var correct = (Math.abs(this.value - 3.703874103964933) <= 0.0001);
  var msgBox = document.getElementById('by5P7sCf_message');
    if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_by5P7sCf")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_by5P7sCf")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

});

</script>


<h4>Question</h4>
<p>Let <span class="math">$f(x) = |x - 0.3|^{-1/4}$</span>. We wish to find <span class="math">$\int_0^1 f(x) dx$</span>. The problem with this function is the singularity at <span class="math">$x=0.3$</span>. &#40;That is, the function is not continuous, so has no guarantee that an integral over a closed domain exists.&#41; However, some such integrals do exist, and the <code>quadgk</code> function can integrate around such singularities by spelling them out in the domain of integration. Just specify the trouble spots between the endpoints:</p>


<pre class='hljl'>
<span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>abs</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.3</span><span class='hljl-p'>)</span><span class='hljl-oB'>^</span><span class='hljl-p'>(</span><span class='hljl-oB'>-</span><span class='hljl-ni'>1</span><span class='hljl-oB'>/</span><span class='hljl-ni'>4</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>val</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>quadgk</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.3</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-p'>);</span>
</pre>



<p>Following the above, what answer do you get?</p>


<form class="mx-2 my-3" name='WeaveQuestion' data-id='CRruR5Zk' data-controltype=''>
  <div class='form-group '>
    <div class='controls'>
      <div class="form-floating input-group" id="controls_CRruR5Zk">
        <div style="padding-top: 5px">
    <div class="row">
  <span style="width:90%">
    <input id="CRruR5Zk" type="number" class="form-control" placeholder="Numeric answer">
  </span>
  <span style="width:10%">
  </span>
</div>

    
        </div>
      </div>
      <div id='CRruR5Zk_message' style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text='text/javascript'>
document.getElementById("CRruR5Zk").addEventListener("change", function() {
  var correct = (Math.abs(this.value - 1.5608608290003951) <= 0.0001);
  var msgBox = document.getElementById('CRruR5Zk_message');
    if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_CRruR5Zk")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_CRruR5Zk")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

});

</script>


<h2>Applications</h2>
<p>There are many more applications of the integral beyond computing areas under the curve. Here we discuss two:</p>
<ul>
<li><p>finding the volume of a figure with rotational symmetry &#40;a glass in our example&#41; and</p>
</li>
<li><p>finding the arc length of a line.</p>
</li>
</ul>
<p>In each case one integrates a function related to the one describing the problem. If you keep this straight, the applications are no different than above.</p>
<h3>Volume as a function of radius.</h3>
<p>The volume of a solid of revolution about the <span class="math">$y$</span>-axis is illustrated <a href="https://www.khanacademy.org/math/integral-calculus/solid_revolution_topic/disc-method/v/disc-method-around-y-axis">here</a>.</p>
<p>This figure shows a volume of revolution &#40;a glass&#41; with an emphasis on the radius of the solid. The volume can be determined if the radius is known.</p>
<p><img src="figures/integration/integration-glass.jpg" alt="Glass" /></p>
<p>The basic formula requires the description of the radius as a function of <span class="math">$x$</span> &#40;if oriented as the figure&#41; or the height, <span class="math">$h$</span>, &#40;if oriented as in real life&#41;. Suppose we specify the radius with <span class="math">$r(h)$</span>, then the following formula holds with <span class="math">$b$</span> the total height.</p>
<p class="math">\[
V(b) = \int_0^b \pi r(h)^2 dh.
\]</p>
<p>For a symmetrical drinking vessel, like most every glass you drink from, the volume can be computed from a formula if a function describing the radius is known. For a given glass, let <span class="math">$r(h)$</span> give the radius as a function of height. Then, as above, the volume of the vessel as a function of height, <span class="math">$b$</span>, is given by an integral:</p>
<p class="math">\[
V(b) = \int_0^b \pi (r(h))^2 dh
\]</p>
<p>We wish to look at our intuition relating the height of the fluid in the vessel compared to the percentage of fluid of the whole. A basic question might be: If the vessel is filled half way by height, is the volume half of the total, more or less?</p>
<p>The answer, of course, depends on the shape of the glass.  That is the shape of the function <span class="math">$r(h)$</span>. Note, if <span class="math">$r(h)$</span> is a constant – the glass is a cylinder – then the half-height mark is also the half-volume mark. Not so in general.</p>
<p>For a standard measuring cup, the answer for different <code>b</code>&#39;s is printed on the side:</p>
<p><img src="figures/integration/measuring_cup.png" alt="Measuring cup" /></p>
<p>With the formula for the volume of a solid of revolution we can compute this marks numerically if we know the radius as a function of height.</p>
<p>In Glass Shape Influences Consumption Rate for <a href="http://www.plosone.org/article/info&#37;3Adoi&#37;2F10.1371&#37;2Fjournal.pone.0043007">Alcoholic Beverages</a> the authors demonstrate that the shape of the glass can have an effect on the rate of consumption, presumably people drink faster when they aren&#39;t sure how much they have left. In particular, they comment that people have difficulty judging the half-finished-by-volume mark.</p>
<p>This figure shows some of the wide variety of beer-serving glasses:</p>
<p><a href="figures/integration/beer_glasses.jpg">Beer glasses</a></p>
<p>We work with metric units, as there is a natural relation between volume in cm<span class="math">$^3$</span> and liquid measure &#40;1 liter &#61; 1000 cm<span class="math">$^3$</span>, so a 16-oz pint glass is roughly <span class="math">$450$</span> cm<span class="math">$^3$</span>.&#41;</p>
<p>Let two glasses be given as follows. A typical pint glass with linearly increasing radius:</p>
<p class="math">\[
r(h) = 3 + \frac{1}{5}h, \quad 0 \leq h \leq b;
\]</p>
<p>and a curved edge one:</p>
<p class="math">\[
s(h) = 3 + \log(1 + h), \quad 0 \leq h \leq b
\]</p>
<p><a href="figures/integration/glass-half-full.png">Half full</a></p>
<p>One could also consider a fluted one, such as appears in the comparison noted in the article.</p>
<h4>Question</h4>
<p>Which of these functions might describe a fluted glass where the radius changes faster as the height gets bigger, that is the radius is a <em>concave up</em> function?</p>


<form class="mx-2 my-3" name='WeaveQuestion' data-id='33GbBfan' data-controltype=''>
  <div class='form-group '>
    <div class='controls'>
      <div class="form-floating input-group" id="controls_33GbBfan">
        <div style="padding-top: 5px">
    <div class="form-check">
  <label>
    <input class="form-check-input" type="radio" name="radio_33GbBfan"
              id="radio_33GbBfan_1" value="1">
      <span = class="label-body">
        <code>r&#40;h&#41; &#61; 2 &#43; sqrt&#40;x/10&#41;, 0 &lt;&#61; x &lt;&#61; 10</code>
      </span>
    </input>
  </label>
</div>
<div class="form-check">
  <label>
    <input class="form-check-input" type="radio" name="radio_33GbBfan"
              id="radio_33GbBfan_2" value="2">
      <span = class="label-body">
        <code>r&#40;h&#41; &#61; 2 &#43; &#40;x/10&#41;^2, 0 &lt;&#61; x &lt;&#61; 10</code>
      </span>
    </input>
  </label>
</div>
<div class="form-check">
  <label>
    <input class="form-check-input" type="radio" name="radio_33GbBfan"
              id="radio_33GbBfan_3" value="3">
      <span = class="label-body">
        <code>r&#40;h&#41; &#61; 2 &#43; x/10, 0 &lt;&#61; x &lt;&#61; 10</code>
      </span>
    </input>
  </label>
</div>

    
        </div>
      </div>
      <div id='33GbBfan_message' style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text='text/javascript'>
document.querySelectorAll('input[name="radio_33GbBfan"]').forEach(function(rb) {
rb.addEventListener("change", function() {
    var correct = rb.value == 2;
    var msgBox = document.getElementById('33GbBfan_message');
      if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_33GbBfan")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_33GbBfan")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

})});

</script>


<hr />
<p>For the two types of glasses in the figure, we create functions in <code>julia</code> as follows:</p>


<pre class='hljl'>
<span class='hljl-nf'>r</span><span class='hljl-p'>(</span><span class='hljl-n'>h</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>3</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>h</span><span class='hljl-oB'>/</span><span class='hljl-ni'>5</span><span class='hljl-t'>
</span><span class='hljl-nf'>s</span><span class='hljl-p'>(</span><span class='hljl-n'>h</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>2</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-nf'>log</span><span class='hljl-p'>(</span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>h</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>r_vol</span><span class='hljl-p'>(</span><span class='hljl-n'>b</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>quadgk</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>-&gt;</span><span class='hljl-t'> </span><span class='hljl-n'>pi</span><span class='hljl-oB'>*</span><span class='hljl-nf'>r</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-oB'>^</span><span class='hljl-ni'>2</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>b</span><span class='hljl-p'>)[</span><span class='hljl-ni'>1</span><span class='hljl-p'>]</span><span class='hljl-t'>
</span><span class='hljl-nf'>s_vol</span><span class='hljl-p'>(</span><span class='hljl-n'>b</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>quadgk</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>-&gt;</span><span class='hljl-t'> </span><span class='hljl-n'>pi</span><span class='hljl-oB'>*</span><span class='hljl-nf'>s</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-oB'>^</span><span class='hljl-ni'>2</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>b</span><span class='hljl-p'>)[</span><span class='hljl-ni'>1</span><span class='hljl-p'>]</span>
</pre>


<pre class="output">
s_vol &#40;generic function with 1 method&#41;
</pre>


<p>Then we can easily find the volume as a function of height. For example at 10cm we have:</p>


<pre class='hljl'>
<span class='hljl-p'>(</span><span class='hljl-nf'>r_vol</span><span class='hljl-p'>(</span><span class='hljl-ni'>10</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-nf'>s_vol</span><span class='hljl-p'>(</span><span class='hljl-ni'>10</span><span class='hljl-p'>))</span>
</pre>


<pre class="output">
&#40;513.1268000863329, 427.26481657392833&#41;
</pre>


<p>However, to find <span class="math">$b$</span> that makes the glass <span class="math">$450$</span> cm<span class="math">$^3$</span> requires us to solve an equation involving an integral for <span class="math">$b$</span>:</p>
<p class="math">\[
V(b) = \int_0^b \pi r(h)^2 dh = 450.
\]</p>
<p>Not to worry, we can use <code>find_zero</code> from the <code>Roots</code> package for that &#40;again, this is loaded with the <code>MTH229</code> package&#41;. To solve for when <code>V&#40;b&#41; &#61; r_vol&#40;b&#41; - 450 &#61; 0</code> we have</p>


<pre class='hljl'>
<span class='hljl-n'>r_b</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>find_zero</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>-&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>r_vol</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-ni'>450</span><span class='hljl-p'>,</span><span class='hljl-t'>  </span><span class='hljl-ni'>10</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
9.168923214523724
</pre>


<p>So <span class="math">$b$</span> is basically <span class="math">$9.17$</span>.  Given this, how much volume is left at <code>b/2</code>?</p>


<pre class='hljl'>
<span class='hljl-nf'>r_vol</span><span class='hljl-p'>(</span><span class='hljl-n'>r_b</span><span class='hljl-oB'>/</span><span class='hljl-ni'>2</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
173.27527610482954
</pre>


<p>Which is what percent of the whole?</p>


<pre class='hljl'>
<span class='hljl-nf'>r_vol</span><span class='hljl-p'>(</span><span class='hljl-n'>r_b</span><span class='hljl-oB'>/</span><span class='hljl-ni'>2</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>/</span><span class='hljl-t'> </span><span class='hljl-nf'>r_vol</span><span class='hljl-p'>(</span><span class='hljl-n'>r_b</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-ni'>100</span>
</pre>


<pre class="output">
38.50561691218434
</pre>


<p>As this height is often mistaken for the half-way by volume mark, people tend to drink these pints faster than they think.</p>
<p>Now compare to the height to get half the volume &#40;225 ml&#41;:</p>


<pre class='hljl'>
<span class='hljl-n'>r_half</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>find_zero</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>-&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>r_vol</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-ni'>225</span><span class='hljl-p'>,</span><span class='hljl-t'>  </span><span class='hljl-ni'>5</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
5.603662378152273
</pre>


<p>This value is more than half of <span class="math">$b$</span>:</p>


<pre class='hljl'>
<span class='hljl-n'>r_half</span><span class='hljl-t'> </span><span class='hljl-oB'>/</span><span class='hljl-t'> </span><span class='hljl-n'>r_b</span>
</pre>


<pre class="output">
0.6111581749616989
</pre>


<p>At this height only half the volume is remaining &#40;and not at 50&#37; of the original height.&#41;</p>
<h3>Practice</h3>
<h4>Question</h4>
<p>Compare the above for the curved glass, where <span class="math">$s(h) = 3 + \log(1 + h)$</span>.</p>
<p>What is the height of the glass, <code>b</code>, needed to make the volume 450?</p>


<form class="mx-2 my-3" name='WeaveQuestion' data-id='Mv8fmtHV' data-controltype=''>
  <div class='form-group '>
    <div class='controls'>
      <div class="form-floating input-group" id="controls_Mv8fmtHV">
        <div style="padding-top: 5px">
    <div class="row">
  <span style="width:90%">
    <input id="Mv8fmtHV" type="number" class="form-control" placeholder="Numeric answer">
  </span>
  <span style="width:10%">
  </span>
</div>

    
        </div>
      </div>
      <div id='Mv8fmtHV_message' style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text='text/javascript'>
document.getElementById("Mv8fmtHV").addEventListener("change", function() {
  var correct = (Math.abs(this.value - 7.273543523711023) <= 0.001);
  var msgBox = document.getElementById('Mv8fmtHV_message');
    if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_Mv8fmtHV")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_Mv8fmtHV")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

});

</script>


<h4>Question</h4>
<p>Find the volume of the glass represented by <span class="math">$s(h) = 3 + \log(1 + h), 0 \leq h \leq b$</span> when the glass is filled to half its height. Report the value as a percentage of the total volume.</p>


<form class="mx-2 my-3" name='WeaveQuestion' data-id='F5JDDcvg' data-controltype=''>
  <div class='form-group '>
    <div class='controls'>
      <div class="form-floating input-group" id="controls_F5JDDcvg">
        <div style="padding-top: 5px">
    <div class="row">
  <span style="width:90%">
    <input id="F5JDDcvg" type="number" class="form-control" placeholder="Numeric answer">
  </span>
  <span style="width:10%">
  </span>
</div>

    
        </div>
      </div>
      <div id='F5JDDcvg_message' style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text='text/javascript'>
document.getElementById("F5JDDcvg").addEventListener("change", function() {
  var correct = (Math.abs(this.value - 40.17520354006269) <= 1);
  var msgBox = document.getElementById('F5JDDcvg_message');
    if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_F5JDDcvg")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_F5JDDcvg")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

});

</script>


<h4>Question</h4>
<p>Now, what height of filling will produce half the volume when? Report your answer in terms of a percentage of <span class="math">$b$</span>, height of the glass.</p>


<form class="mx-2 my-3" name='WeaveQuestion' data-id='rJXXeClr' data-controltype=''>
  <div class='form-group '>
    <div class='controls'>
      <div class="form-floating input-group" id="controls_rJXXeClr">
        <div style="padding-top: 5px">
    <div class="row">
  <span style="width:90%">
    <input id="rJXXeClr" type="number" class="form-control" placeholder="Numeric answer">
  </span>
  <span style="width:10%">
  </span>
</div>

    
        </div>
      </div>
      <div id='rJXXeClr_message' style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text='text/javascript'>
document.getElementById("rJXXeClr").addEventListener("change", function() {
  var correct = (Math.abs(this.value - 59.13334210350367) <= 0.1);
  var msgBox = document.getElementById('rJXXeClr_message');
    if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_rJXXeClr")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_rJXXeClr")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

});

</script>


<h4>Question</h4>
<p>Consider this big Solo cup:</p>
<p><img src="figures/integration/big-solo-cup.jpg" alt="Solo cup" /></p>
<p>It has approximate dimensions: smaller radius 5 feet, upper radius 8 feet and height 15 feet. How many gallons is it? At <span class="math">$8$</span> pounds a gallon this would be pretty heavy&#33;</p>
<p>Two facts are useful:</p>
<ul>
<li><p>a cubic foot is 7.48052 gallons</p>
</li>
<li><p>the radius as a function of height is <span class="math">$r(h) = 5  + (3/15)\cdot h$</span></p>
</li>
</ul>


<form class="mx-2 my-3" name='WeaveQuestion' data-id='K0wgWlr7' data-controltype=''>
  <div class='form-group '>
    <div class='controls'>
      <div class="form-floating input-group" id="controls_K0wgWlr7">
        <div style="padding-top: 5px">
    <div class="row">
  <span style="width:90%">
    <input id="K0wgWlr7" type="number" class="form-control" placeholder="Numeric answer">
  </span>
  <span style="width:10%">
  </span>
</div>

    
        </div>
      </div>
      <div id='K0wgWlr7_message' style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text='text/javascript'>
document.getElementById("K0wgWlr7").addEventListener("change", function() {
  var correct = (Math.abs(this.value - 15157.98160668533) <= 10.0);
  var msgBox = document.getElementById('K0wgWlr7_message');
    if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_K0wgWlr7")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_K0wgWlr7")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

});

</script>


<h2>Example, arc length</h2>
<p>The basic indefinite integral for a positive function answers the amount of area under the curve over a given interval. However, the integral can be interpreted in many different ways. For example, one can use an integral to answer how long a curve is. Of course one can estimate this answer. For example, consider this curve:</p>


<pre class='hljl'>
<span class='hljl-nf'>plot</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>-&gt;</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-oB'>^</span><span class='hljl-ni'>2</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span>
</pre>



<script src="https://cdn.plot.ly/plotly-2.6.3.min.js"></script>    <div id="8e537966-7285-4cce-80ac-456158a72cf9" style="width:576px;height:384px;"></div>
    <script>
    
        Plotly.newPlot('8e537966-7285-4cce-80ac-456158a72cf9', [
    {
        "xaxis": "x",
        "colorbar": {
            "title": ""
        },
        "yaxis": "y",
        "x": [
            0.0,
            0.0032552730065960435,
            0.006510546013192087,
            0.036610245396053655,
            0.06670994477891522,
            0.08479860949133224,
            0.10288727420374925,
            0.11818101000712988,
            0.1334747458105105,
            0.16670131335536761,
            0.19733326968975212,
            0.23017396427099324,
            0.2682231295590215,
            0.3020367374073476,
            0.33168822436014667,
            0.3640163044368796,
            0.39653651916854143,
            0.4324917750829362,
            0.46670229382989564,
            0.5022732956742337,
            0.5322165024445634,
            0.5687737639909094,
            0.6022625282972686,
            0.633191986492585,
            0.664522569176674,
            0.6996353690067759,
            0.7314532343698557,
            0.7678824957294598,
            0.801612752145878,
            0.8348668324871845,
            0.8671537922786412,
            0.8837029234300695,
            0.9002520545814979,
            0.9183835490211356,
            0.9365150434607734,
            0.9628540127631192,
            0.989192982065465,
            0.9945964910327325,
            1.0
        ],
        "showlegend": true,
        "mode": "lines",
        "name": "y1",
        "zmin": null,
        "legendgroup": "y1",
        "zmax": null,
        "line": {
            "color": "rgba(0, 154, 250, 1.000)",
            "shape": "linear",
            "dash": "solid",
            "width": 1
        },
        "y": [
            0.0,
            1.0596802347472844e-5,
            4.238720938989138e-5,
            0.001340310067959268,
            0.004450216732405918,
            0.0071908041716634615,
            0.010585791193077487,
            0.013966751126305334,
            0.01781550776918039,
            0.027789327874404465,
            0.03894041932644844,
            0.052980053828224474,
            0.07194364723043563,
            0.09122619074367505,
            0.11001707817918699,
            0.132507869895883,
            0.15724121103430302,
            0.18704913551438906,
            0.21781103106608624,
            0.2522784635474562,
            0.28325440547432396,
            0.3235035946043867,
            0.36272015299101823,
            0.400932091758426,
            0.4415902449451674,
            0.4894896495652475,
            0.535023834070123,
            0.5896435272477037,
            0.6425830044028888,
            0.6970026279871846,
            0.7519556994632288,
            0.7809308568788513,
            0.8104537617782084,
            0.8434283431126566,
            0.8770604266283343,
            0.9270878498940409,
            0.9785027557675674,
            0.9892221799746244,
            1.0
        ],
        "type": "scatter"
    }
]
, {
    "showlegend": true,
    "xaxis": {
        "showticklabels": true,
        "gridwidth": 0.5,
        "tickvals": [
            0.0,
            0.25,
            0.5,
            0.75,
            1.0
        ],
        "range": [
            -0.03,
            1.03
        ],
        "domain": [
            0.06856347817633907,
            0.9931649168853893
        ],
        "mirror": false,
        "tickangle": 0,
        "showline": true,
        "ticktext": [
            "0.00",
            "0.25",
            "0.50",
            "0.75",
            "1.00"
        ],
        "zeroline": false,
        "tickfont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 11
        },
        "zerolinecolor": "rgba(0, 0, 0, 1.000)",
        "anchor": "y",
        "visible": true,
        "ticks": "inside",
        "tickmode": "array",
        "linecolor": "rgba(0, 0, 0, 1.000)",
        "showgrid": true,
        "title": "",
        "gridcolor": "rgba(0, 0, 0, 0.100)",
        "titlefont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 15
        },
        "tickcolor": "rgb(0, 0, 0)",
        "type": "-"
    },
    "paper_bgcolor": "rgba(255, 255, 255, 1.000)",
    "annotations": [],
    "height": 384,
    "margin": {
        "l": 0,
        "b": 20,
        "r": 0,
        "t": 20
    },
    "plot_bgcolor": "rgba(255, 255, 255, 1.000)",
    "yaxis": {
        "showticklabels": true,
        "gridwidth": 0.5,
        "tickvals": [
            0.0,
            0.25,
            0.5,
            0.75,
            1.0
        ],
        "range": [
            -0.03,
            1.03
        ],
        "domain": [
            0.0391878098571012,
            0.989747375328084
        ],
        "mirror": false,
        "tickangle": 0,
        "showline": true,
        "ticktext": [
            "0.00",
            "0.25",
            "0.50",
            "0.75",
            "1.00"
        ],
        "zeroline": false,
        "tickfont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 11
        },
        "zerolinecolor": "rgba(0, 0, 0, 1.000)",
        "anchor": "x",
        "visible": true,
        "ticks": "inside",
        "tickmode": "array",
        "linecolor": "rgba(0, 0, 0, 1.000)",
        "showgrid": true,
        "title": "",
        "gridcolor": "rgba(0, 0, 0, 0.100)",
        "titlefont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 15
        },
        "tickcolor": "rgb(0, 0, 0)",
        "type": "-"
    },
    "legend_position": {
        "yanchor": "auto",
        "xanchor": "auto",
        "bordercolor": "rgba(0, 0, 0, 1.000)",
        "bgcolor": "rgba(255, 255, 255, 1.000)",
        "borderwidth": 1,
        "tracegroupgap": 0,
        "y": 1.0,
        "font": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 11
        },
        "title": {
            "font": {
                "color": "rgba(0, 0, 0, 1.000)",
                "family": "sans-serif",
                "size": 15
            },
            "text": ""
        },
        "traceorder": "normal",
        "x": 1.0
    },
    "width": 576
}
);

    
    </script>


<p>This curve has length no more than <span class="math">$2 = 1 + 1$</span> – the distance along the <span class="math">$x$</span> axis starting at <span class="math">$0$</span> to <span class="math">$1$</span> and then going up. It is also longer than <span class="math">$\sqrt{2} = \sqrt{1^2 + 1^2}$</span> – the straight line distance between the two endpoints. But how long is it?</p>
<p>In general, the <em>arc length</em> of the curve <span class="math">$y=f(x)$</span> between <span class="math">$a \leq x \leq b$</span> &#40;or how long is the curve&#41; is given through the formula</p>
<p class="math">\[
l = \int_a^b \sqrt{1 + f'(x)^2} dx
\]</p>
<p>The formula is from the length of the hypotenuse of a right triangle with lengths <span class="math">$1$</span> and <span class="math">$f'(x)$</span>, This image suggests an approximation for the length and why the hypotenuse of some triangle might be involved.</p>
<p><a href="figures/integration/arclength.gif">Arc length</a></p>
<p>Rather than focus on a derivation, we do some examples illustrating that to compute the arclength of the graph of a function is relatively straightforward  using numeric integration. For example, our answer for <span class="math">$f(x) = x^2$</span> is given by</p>


<pre class='hljl'>
<span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-oB'>^</span><span class='hljl-ni'>2</span><span class='hljl-t'>
</span><span class='hljl-nf'>quadgk</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>-&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>sqrt</span><span class='hljl-p'>(</span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-oB'>&#39;</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-oB'>^</span><span class='hljl-ni'>2</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span><span class='hljl-t'>      </span><span class='hljl-cs'># using f&#39; notation defined in MTH229</span>
</pre>


<pre class="output">
&#40;1.4789428575446002, 1.0424396901242972e-8&#41;
</pre>


<p>&#40;We use an <em>anonymous function</em> for the integrand which involved the derivative being found through <code>f&#39;</code>. If the graph is described by <code>f</code>, then this expression be the same for all these problems.&#41;</p>
<hr />
<p>Whereas, the length of the <span class="math">$f(x) = \sin(x)$</span> over <span class="math">$[0, \pi]$</span> would be:</p>


<pre class='hljl'>
<span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>sin</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>quadgk</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>-&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>sqrt</span><span class='hljl-p'>(</span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-oB'>&#39;</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-oB'>^</span><span class='hljl-ni'>2</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>pi</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
&#40;3.820197789027713, 9.377002729848982e-9&#41;
</pre>


<p>Next we look at a more practical problem.</p>
<h3>Example: the caternary shape</h3>
<p>A <a href="http://en.wikipedia.org/wiki/Catenary">caternary shape</a> is the shape a hanging chain will take as it is suspended between two posts. It appears elsewhere, for example, power wires will also have this shape as they are suspended between towers. A formula for a caternary can be written in terms of the hyperbolic cosine, <code>cosh</code> in <code>julia</code> or exponentials.</p>
<p class="math">\[
y = a \cosh(x/a) = a \cdot \frac{e^{x/a} + e^{-x/a}}{2}.
\]</p>
<p>Suppose we have the following wire hung between <span class="math">$x=-1$</span> and <span class="math">$x=1$</span> with <span class="math">$a = 2$</span>:</p>


<pre class='hljl'>
<span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>;</span><span class='hljl-t'> </span><span class='hljl-n'>a</span><span class='hljl-oB'>=</span><span class='hljl-ni'>2</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>a</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-nf'>cosh</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-oB'>/</span><span class='hljl-n'>a</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>plot</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-ni'>1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span>
</pre>



<script src="https://cdn.plot.ly/plotly-2.6.3.min.js"></script>    <div id="7d3f64b7-935c-45e8-b844-3899fd6e246f" style="width:576px;height:384px;"></div>
    <script>
    
        Plotly.newPlot('7d3f64b7-935c-45e8-b844-3899fd6e246f', [
    {
        "xaxis": "x",
        "colorbar": {
            "title": ""
        },
        "yaxis": "y",
        "x": [
            -1.0,
            -0.996744726993404,
            -0.993489453986808,
            -0.990234180980212,
            -0.9869789079736159,
            -0.9568792085907543,
            -0.9267795092078928,
            -0.8966798098250311,
            -0.8665801104421695,
            -0.8484914457297525,
            -0.8304027810173356,
            -0.8123141163049186,
            -0.7942254515925016,
            -0.7636379799857402,
            -0.733050508378979,
            -0.6998239408341218,
            -0.6665973732892647,
            -0.6359654169548803,
            -0.6053334606204958,
            -0.5724927660392547,
            -0.5396520714580135,
            -0.5206274888139995,
            -0.5016029061699853,
            -0.4825783235259711,
            -0.46355374088195694,
            -0.42974013303363084,
            -0.39592652518530475,
            -0.3662750382325057,
            -0.3366235512797066,
            -0.3042954712029737,
            -0.27196739112624074,
            -0.23944717639457896,
            -0.2069269616629172,
            -0.17097170574852244,
            -0.13501644983412764,
            -0.10080593108716818,
            -0.06659541234020872,
            -0.03102441049587067,
            0.004546591348467378,
            0.034489798118797106,
            0.06443300488912683,
            0.10099026643547282,
            0.1375475279818188,
            0.17103629228817802,
            0.2045250565945372,
            0.23545451478985369,
            0.26638397298517014,
            0.2977145556692591,
            0.32904513835334803,
            0.36415793818345,
            0.3992707380135519,
            0.43108860337663163,
            0.46290646873971136,
            0.4811210994195133,
            0.4993357300993153,
            0.5175503607791173,
            0.5357649914589193,
            0.5694952478753377,
            0.6032255042917559,
            0.6364795846330624,
            0.6697336649743688,
            0.7020206247658256,
            0.7343075845572823,
            0.7674058468601391,
            0.800504109162996,
            0.8186356036026337,
            0.8367670980422713,
            0.854898592481909,
            0.8730300869215467,
            0.8993690562238925,
            0.9257080255262384,
            0.9520469948285842,
            0.97838596413093,
            0.9837894730981975,
            0.989192982065465,
            0.9945964910327325,
            1.0
        ],
        "showlegend": true,
        "mode": "lines",
        "name": "y1",
        "zmin": null,
        "legendgroup": "y1",
        "zmax": null,
        "line": {
            "color": "rgba(0, 154, 250, 1.000)",
            "shape": "linear",
            "dash": "solid",
            "width": 1
        },
        "y": [
            2.2552519304127614,
            2.2535586094899758,
            2.2518712586972987,
            2.250189873564598,
            2.2485144496375478,
            2.233304345513932,
            2.218600089851471,
            2.2043983521031594,
            2.1906959155434307,
            2.18270021434544,
            2.1748830591280623,
            2.1672438104440497,
            2.1597818433989997,
            2.1475654939064537,
            2.135851466240714,
            2.123692760014776,
            2.112120209015598,
            2.101967866258302,
            2.0923086110535247,
            2.0824979946315594,
            2.073248890189538,
            2.068146765691912,
            2.063231776148287,
            2.0585034768289368,
            2.053961439896684,
            2.0463470515813618,
            2.039317605079117,
            2.0336331964424996,
            2.0283957939991772,
            2.0231936240142563,
            2.018520077861367,
            2.0143508670894152,
            2.0107142444761172,
            2.0073122824920766,
            2.004559091488911,
            2.0025409968087677,
            2.0011088396814984,
            2.0002406333368663,
            2.000005167875448,
            2.0002973939135384,
            2.0010379928030915,
            2.0025503002970835,
            2.0047316951822283,
            2.007317811501339,
            2.0104667413640454,
            2.0138757221544137,
            2.0177663467236924,
            2.0221994359514346,
            2.027128785804915,
            2.033244444337917,
            2.039986820165495,
            2.0466394973494086,
            2.0538101779200457,
            2.0581489890341444,
            2.0626585107763824,
            2.067339117183476,
            2.072191196482547,
            2.081630539029129,
            2.091661979091119,
            2.1021342013852307,
            2.113187589862379,
            2.1244784687399734,
            2.1363230241038753,
            2.149043160275848,
            2.162351876372424,
            2.1698933328928423,
            2.177613129334629,
            2.185511900175004,
            2.1935902946007957,
            2.2056468422280893,
            2.2180859324632745,
            2.2309097227152015,
            2.244120437114259,
            2.2468786885804874,
            2.249653341096652,
            2.2524444149162797,
            2.2552519304127614
        ],
        "type": "scatter"
    }
]
, {
    "showlegend": true,
    "xaxis": {
        "showticklabels": true,
        "gridwidth": 0.5,
        "tickvals": [
            -1.0,
            -0.5,
            0.0,
            0.5,
            1.0
        ],
        "range": [
            -1.06,
            1.06
        ],
        "domain": [
            0.06856347817633907,
            0.9931649168853893
        ],
        "mirror": false,
        "tickangle": 0,
        "showline": true,
        "ticktext": [
            "−1.0",
            "−0.5",
            "0.0",
            "0.5",
            "1.0"
        ],
        "zeroline": false,
        "tickfont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 11
        },
        "zerolinecolor": "rgba(0, 0, 0, 1.000)",
        "anchor": "y",
        "visible": true,
        "ticks": "inside",
        "tickmode": "array",
        "linecolor": "rgba(0, 0, 0, 1.000)",
        "showgrid": true,
        "title": "",
        "gridcolor": "rgba(0, 0, 0, 0.100)",
        "titlefont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 15
        },
        "tickcolor": "rgb(0, 0, 0)",
        "type": "-"
    },
    "paper_bgcolor": "rgba(255, 255, 255, 1.000)",
    "annotations": [],
    "height": 384,
    "margin": {
        "l": 0,
        "b": 20,
        "r": 0,
        "t": 20
    },
    "plot_bgcolor": "rgba(255, 255, 255, 1.000)",
    "yaxis": {
        "showticklabels": true,
        "gridwidth": 0.5,
        "tickvals": [
            2.0,
            2.0500000000000003,
            2.1,
            2.15,
            2.2,
            2.25
        ],
        "range": [
            1.9923477649993286,
            2.262909333288881
        ],
        "domain": [
            0.0391878098571012,
            0.989747375328084
        ],
        "mirror": false,
        "tickangle": 0,
        "showline": true,
        "ticktext": [
            "2.00",
            "2.05",
            "2.10",
            "2.15",
            "2.20",
            "2.25"
        ],
        "zeroline": false,
        "tickfont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 11
        },
        "zerolinecolor": "rgba(0, 0, 0, 1.000)",
        "anchor": "x",
        "visible": true,
        "ticks": "inside",
        "tickmode": "array",
        "linecolor": "rgba(0, 0, 0, 1.000)",
        "showgrid": true,
        "title": "",
        "gridcolor": "rgba(0, 0, 0, 0.100)",
        "titlefont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 15
        },
        "tickcolor": "rgb(0, 0, 0)",
        "type": "-"
    },
    "legend_position": {
        "yanchor": "auto",
        "xanchor": "auto",
        "bordercolor": "rgba(0, 0, 0, 1.000)",
        "bgcolor": "rgba(255, 255, 255, 1.000)",
        "borderwidth": 1,
        "tracegroupgap": 0,
        "y": 1.0,
        "font": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 11
        },
        "title": {
            "font": {
                "color": "rgba(0, 0, 0, 1.000)",
                "family": "sans-serif",
                "size": 15
            },
            "text": ""
        },
        "traceorder": "normal",
        "x": 1.0
    },
    "width": 576
}
);

    
    </script>


<p>How long is the chain? Looking at the graph we can guess an answer is between <span class="math">$2$</span> and <span class="math">$2.5$</span>, say, but it isn&#39;t much work to get the answer:</p>


<pre class='hljl'>
<span class='hljl-nf'>quadgk</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>-&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>sqrt</span><span class='hljl-p'>(</span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-oB'>&#39;</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-oB'>^</span><span class='hljl-ni'>2</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-ni'>1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
&#40;2.0843812219749895, 0.0&#41;
</pre>


<h3>Practice</h3>
<h4>Question</h4>
<p>The sag in the chain is adjusted through the parameter <span class="math">$a$</span> – chains with larger <span class="math">$a$</span> have less sag.</p>
<p>Suppose your chain has parameter <code>a&#61;3</code> what is the length? &#40;Use <code>quadgk</code>&#41;</p>


<form class="mx-2 my-3" name='WeaveQuestion' data-id='0ERQK5eM' data-controltype=''>
  <div class='form-group '>
    <div class='controls'>
      <div class="form-floating input-group" id="controls_0ERQK5eM">
        <div style="padding-top: 5px">
    <div class="row">
  <span style="width:90%">
    <input id="0ERQK5eM" type="number" class="form-control" placeholder="Numeric answer">
  </span>
  <span style="width:10%">
  </span>
</div>

    
        </div>
      </div>
      <div id='0ERQK5eM_message' style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text='text/javascript'>
document.getElementById("0ERQK5eM").addEventListener("change", function() {
  var correct = (Math.abs(this.value - 15157.98160668533) <= 0.001);
  var msgBox = document.getElementById('0ERQK5eM_message');
    if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_0ERQK5eM")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_0ERQK5eM")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

});

</script>


<h4>Question: in the artist studio</h4>
<p>This picture of Jasper Johns <a href="http://www.artic.edu/aic/collections/artwork/184095">Near the Lagoon</a> was taken at The Art Institute Chicago.</p>
<p><a href="figures/integration/johns-catenary.jpg">Jasper Johns</a></p>
<p>The museum notes have</p>
<blockquote>
<p>For his Catenary series &#40;1997–2003&#41;, of which Near the Lagoon is    the largest and last work, Johns formed catenaries—a term used to    describe the curve assumed by a cord suspended freely from two    points—by tacking ordinary household string to the canvas or its    supports.</p>
</blockquote>
<p>This particular catenary has a certain length. The basic dimensions are 78in wide and 118in drop. If our shifted function is</p>
<p class="math">\[
f(x; a, b) = a \cosh(x/a) - b
\]</p>
<p>Then we have <span class="math">$f(0) = -118$</span> and <span class="math">$f(78/2) = 0$</span> using the origin midway between the two tops of the curve. Solving the first gives</p>
<p class="math">\[
-118 = a - b \text{ or } b = a + 118.
\]</p>
<p>The second gives <span class="math">$a \cdot \cosh(78/(2a)) - (a + 118) = 0$</span>. This can be solved numerically for a:</p>


<pre class='hljl'>
<span class='hljl-nf'>catenary</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>;</span><span class='hljl-t'> </span><span class='hljl-n'>a</span><span class='hljl-oB'>=</span><span class='hljl-ni'>1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>b</span><span class='hljl-oB'>=</span><span class='hljl-ni'>0</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>a</span><span class='hljl-oB'>*</span><span class='hljl-nf'>cosh</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-oB'>/</span><span class='hljl-n'>a</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-n'>b</span><span class='hljl-t'>
</span><span class='hljl-n'>a</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>newton</span><span class='hljl-p'>(</span><span class='hljl-n'>a</span><span class='hljl-t'> </span><span class='hljl-oB'>-&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>catenary</span><span class='hljl-p'>(</span><span class='hljl-ni'>78</span><span class='hljl-oB'>/</span><span class='hljl-ni'>2</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>a</span><span class='hljl-oB'>=</span><span class='hljl-n'>a</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>b</span><span class='hljl-oB'>=</span><span class='hljl-ni'>118</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>a</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
12.994268574805396
</pre>


<p>Rounding, we take <span class="math">$a=13$</span>. With these parameters &#40;<span class="math">$a=13$</span>, <span class="math">$b = 131$</span>&#41;, compute the length of John&#39;s catenary.</p>


<form class="mx-2 my-3" name='WeaveQuestion' data-id='RqA63oKB' data-controltype=''>
  <div class='form-group '>
    <div class='controls'>
      <div class="form-floating input-group" id="controls_RqA63oKB">
        <div style="padding-top: 5px">
    <div class="row">
  <span style="width:90%">
    <input id="RqA63oKB" type="number" class="form-control" placeholder="Numeric answer">
  </span>
  <span style="width:10%">
  </span>
</div>

    
        </div>
      </div>
      <div id='RqA63oKB_message' style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text='text/javascript'>
document.getElementById("RqA63oKB").addEventListener("change", function() {
  var correct = (Math.abs(this.value - 260.46474811265745) <= 1);
  var msgBox = document.getElementById('RqA63oKB_message');
    if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_RqA63oKB")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_RqA63oKB")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

});

</script>


<h4>Question Bridges are parabolas</h4>
<p>Suspension bridges, like the Verrazano bridge, have different loading than a cable and hence a different shape. A parabola is the shape the cable takes under uniform loading.</p>
<p>The Verrazano-Narrows <a href="http://observer.com/2012/09/staten-island/s-i-8/">bridge</a> has a span of 1298m. Suppose the drop of the main cables is 147 meters over this span. Then the cable itself can be modeled as a parabola with</p>
<ul>
<li><p class="math">\[
x
\]</p>
<p>-intercepts <span class="math">$a = 1298/2$</span> and <span class="math">$-a$</span> and</p>
</li>
<li><p>vertex <span class="math">$(0,b)$</span> with <span class="math">$b=-147$</span>.</p>
</li>
</ul>
<p>The parabola that fits these three points is</p>
<p class="math">\[
y = \frac{-b}{a^2}(x^2 - a^2)
\]</p>
<p>Find the arc length of the cable in meters.</p>


<form class="mx-2 my-3" name='WeaveQuestion' data-id='Wtg2OWz7' data-controltype=''>
  <div class='form-group '>
    <div class='controls'>
      <div class="form-floating input-group" id="controls_Wtg2OWz7">
        <div style="padding-top: 5px">
    <div class="row">
  <span style="width:90%">
    <input id="Wtg2OWz7" type="number" class="form-control" placeholder="Numeric answer">
  </span>
  <span style="width:10%">
  </span>
</div>

    
        </div>
      </div>
      <div id='Wtg2OWz7_message' style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text='text/javascript'>
document.getElementById("Wtg2OWz7").addEventListener("change", function() {
  var correct = (Math.abs(this.value - 2.000000162403202) <= 0.001);
  var msgBox = document.getElementById('Wtg2OWz7_message');
    if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_Wtg2OWz7")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_Wtg2OWz7")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

});

</script>


<p>In the picture of the Verrazano-Narrows <a href="http://observer.com/2012/09/staten-island/s-i-8/">bridge</a>, would the shape during construction be a parabola or a cateneary?</p>


<form class="mx-2 my-3" name='WeaveQuestion' data-id='oXUfjAfC' data-controltype=''>
  <div class='form-group '>
    <div class='controls'>
      <div class="form-floating input-group" id="controls_oXUfjAfC">
        <div style="padding-top: 5px">
    <div class="form-check">
  <label>
    <input class="form-check-input" type="radio" name="radio_oXUfjAfC"
              id="radio_oXUfjAfC_1" value="1">
      <span = class="label-body">
        A catenary, basically, as in the picture there is basically no load on the cables.
      </span>
    </input>
  </label>
</div>
<div class="form-check">
  <label>
    <input class="form-check-input" type="radio" name="radio_oXUfjAfC"
              id="radio_oXUfjAfC_2" value="2">
      <span = class="label-body">
        A parabola, as just mentioned
      </span>
    </input>
  </label>
</div>

    
        </div>
      </div>
      <div id='oXUfjAfC_message' style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text='text/javascript'>
document.querySelectorAll('input[name="radio_oXUfjAfC"]').forEach(function(rb) {
rb.addEventListener("change", function() {
    var correct = rb.value == 1;
    var msgBox = document.getElementById('oXUfjAfC_message');
      if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_oXUfjAfC")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_oXUfjAfC")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

})});

</script>


<h4>Question The tractrix</h4>
<p>A boat sits at the point <span class="math">$(a, 0)$</span> and a man holds a rope taut attached to the boat at the origin <span class="math">$(0,0)$</span>. The man walks on the <span class="math">$y$</span> axis. The position <span class="math">$y$</span> depends then on the position <span class="math">$x$</span> of the boat, and if the rope is taut, the position satisfies:</p>
<p class="math">\[
y = a \ln\frac{a + \sqrt{a^2 - x^2}}{x} - \sqrt{a^2 - x^2}
\]</p>
<p>This can be entered into <code>julia</code> as:</p>


<pre class='hljl'>
<span class='hljl-nf'>g</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>a</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>a</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-nf'>log</span><span class='hljl-p'>((</span><span class='hljl-n'>a</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-nf'>sqrt</span><span class='hljl-p'>(</span><span class='hljl-n'>a</span><span class='hljl-oB'>^</span><span class='hljl-ni'>2</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-oB'>^</span><span class='hljl-ni'>2</span><span class='hljl-p'>))</span><span class='hljl-oB'>/</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-nf'>sqrt</span><span class='hljl-p'>(</span><span class='hljl-n'>a</span><span class='hljl-oB'>^</span><span class='hljl-ni'>2</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-oB'>^</span><span class='hljl-ni'>2</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
g &#40;generic function with 1 method&#41;
</pre>


<p>Let <span class="math">$a=12$</span>, <span class="math">$f(x) = g(x, a)$</span>. Compute the length the bow of the boat has traveled between <span class="math">$x=1$</span> and <span class="math">$x=a$</span> using <code>quadgk</code>.</p>


<form class="mx-2 my-3" name='WeaveQuestion' data-id='j3tOauJ5' data-controltype=''>
  <div class='form-group '>
    <div class='controls'>
      <div class="form-floating input-group" id="controls_j3tOauJ5">
        <div style="padding-top: 5px">
    <div class="row">
  <span style="width:90%">
    <input id="j3tOauJ5" type="number" class="form-control" placeholder="Numeric answer">
  </span>
  <span style="width:10%">
  </span>
</div>

    
        </div>
      </div>
      <div id='j3tOauJ5_message' style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text='text/javascript'>
document.getElementById("j3tOauJ5").addEventListener("change", function() {
  var correct = (Math.abs(this.value - 29.818879797456006) <= 0.001);
  var msgBox = document.getElementById('j3tOauJ5_message');
    if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_j3tOauJ5")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_j3tOauJ5")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

});

</script>


<p>&#40;The most elementary description of this curve is in terms of the relationship <span class="math">$dy/dx = -\sqrt{a^2-x^2}/x$</span> which could be used in place of <code>f&#39;</code> in your work.&#41;</p>
<div class="admonition note"><p class="admonition-title">More on the tractrix</p><p>Watch this <a href="https://simonsfoundation.org/multimedia/mathematical-impressions-bicycle-tracks/&quot;&gt;&quot;bicycle tracks">video</a> to see an example of how the tractrix can be found in an everyday observation. Also <a href="http://calteches.library.caltech.edu/4007/1/Calculus.pdf">here</a>.</p>
</div>
<h2>Gauss quadrature, Using weights</h2>
<p>What components go into the <code>quadgk</code> function? This section covers some of the background.</p>
<p>The trapezoid rule can be rearranged to become:</p>
<p class="math">\[
\delta f(x_0) + 2\delta f(x_2) + 2 \delta f(x_3) + \cdots + 2 \delta f(x_{n}) + \delta f(x_{n})
\]</p>
<p>where <span class="math">$\delta = (b-a)/n$</span>.</p>
<p>Whereas for even <span class="math">$n$</span>, Simpson&#39;s rule can be written with:</p>
<p class="math">\[
\delta f(x_0) + 4\delta f(x_1) + 2 \delta f(x_2) + \cdots +  4 \delta f(x_{n-2}) + 2 \delta f(x_{n-1}) + \delta f(x_{n})
\]</p>
<p>with <span class="math">$\delta = (b-a)/n \cdot (1/6)$</span>.</p>
<p>These both have the general form of</p>
<p class="math">\[
\sum_k w_k \cdot f(x_k)
\]</p>
<p>where <span class="math">$w_k$</span> are weights and the <span class="math">$x_k$</span> some choice of points &#40;nodes&#41; – not necessarily evenly spaced, though that is so in the examples we&#39;ve seen. So, an alternative way to do the trapezoid formula in <code>julia</code> for <span class="math">$n=4$</span> might be:</p>


<pre class='hljl'>
<span class='hljl-n'>a</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>b</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>n</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>4</span><span class='hljl-t'>
</span><span class='hljl-n'>delta</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>b</span><span class='hljl-oB'>-</span><span class='hljl-n'>a</span><span class='hljl-p'>)</span><span class='hljl-oB'>/</span><span class='hljl-n'>n</span><span class='hljl-t'>
</span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-oB'>^</span><span class='hljl-ni'>2</span><span class='hljl-t'>
</span><span class='hljl-n'>wts</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-ni'>1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>2</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>2</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>2</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-n'>delta</span><span class='hljl-t'> </span><span class='hljl-cs'>## delta * [1, repeat([2],n-1), 1]&#39;</span><span class='hljl-t'>
</span><span class='hljl-n'>xs</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>a</span><span class='hljl-t'> </span><span class='hljl-oB'>.+</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-ni'>0</span><span class='hljl-oB'>:</span><span class='hljl-n'>n</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-n'>delta</span><span class='hljl-t'>
</span><span class='hljl-nf'>sum</span><span class='hljl-p'>(</span><span class='hljl-n'>w</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-k'>for</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>w</span><span class='hljl-p'>,</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-kp'>in</span><span class='hljl-t'> </span><span class='hljl-nf'>zip</span><span class='hljl-p'>(</span><span class='hljl-n'>wts</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>xs</span><span class='hljl-p'>))</span>
</pre>


<pre class="output">
0.6875
</pre>


<p>The compact code of the last line to compute the approximate integral shows there are three important things in this form of the integral: the weights, the <em>nodes</em> or <span class="math">$x$</span> values, and the function. The use of equally spaced nodes has been used by us so far, but it need not be the case. If fact Gauss showed he could get similar answers faster if it wasn&#39;t the case.</p>
<p>The Gauss nodes and weights are computable &#40;http://en.wikipedia.org/wiki/Gaussian_quadrature&#41;. The main tools are the so-called Legendre polynomials, which can be defined recursively with Bonnet&#39;s formula:</p>
<p class="math">\[
P_0(x) = 1; P_1(x) = x; \quad  n P_{n}(x)  = (2(n-1)+1) x P_{n-1}(x) -(n-1) P_{n-2}(x).
\]</p>
<p>Using <code>julia</code>&#39;s <code>Polynomials</code> package this can be implemented almost verbatim:</p>


<pre class='hljl'>
<span class='hljl-k'>import</span><span class='hljl-t'> </span><span class='hljl-n'>Polynomials</span><span class='hljl-t'>
</span><span class='hljl-k'>import</span><span class='hljl-t'> </span><span class='hljl-n'>Polynomials</span><span class='hljl-oB'>:</span><span class='hljl-t'> </span><span class='hljl-n'>Polynomial</span><span class='hljl-t'>
</span><span class='hljl-k'>function</span><span class='hljl-t'> </span><span class='hljl-nf'>lgp</span><span class='hljl-p'>(</span><span class='hljl-n'>n</span><span class='hljl-oB'>::</span><span class='hljl-n'>Integer</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-k'>if</span><span class='hljl-t'> </span><span class='hljl-n'>n</span><span class='hljl-t'> </span><span class='hljl-oB'>==</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-t'> </span><span class='hljl-k'>return</span><span class='hljl-t'> </span><span class='hljl-nf'>Polynomial</span><span class='hljl-p'>([</span><span class='hljl-ni'>1</span><span class='hljl-p'>])</span><span class='hljl-t'> </span><span class='hljl-k'>end</span><span class='hljl-t'>
    </span><span class='hljl-k'>if</span><span class='hljl-t'> </span><span class='hljl-n'>n</span><span class='hljl-t'> </span><span class='hljl-oB'>==</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-k'>return</span><span class='hljl-t'> </span><span class='hljl-nf'>Polynomial</span><span class='hljl-p'>([</span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-p'>])</span><span class='hljl-t'> </span><span class='hljl-k'>end</span><span class='hljl-t'>

    </span><span class='hljl-p'>(</span><span class='hljl-ni'>2</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>n</span><span class='hljl-oB'>-</span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>/</span><span class='hljl-t'> </span><span class='hljl-n'>n</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-nf'>lgp</span><span class='hljl-p'>(</span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-nf'>lgp</span><span class='hljl-p'>(</span><span class='hljl-n'>n</span><span class='hljl-oB'>-</span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>n</span><span class='hljl-oB'>-</span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span><span class='hljl-oB'>/</span><span class='hljl-n'>n</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-nf'>lgp</span><span class='hljl-p'>(</span><span class='hljl-n'>n</span><span class='hljl-oB'>-</span><span class='hljl-ni'>2</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span>
</pre>


<pre class="output">
lgp &#40;generic function with 1 method&#41;
</pre>


<p>This is used as,</p>


<pre class='hljl'>
<span class='hljl-n'>p4</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>lgp</span><span class='hljl-p'>(</span><span class='hljl-ni'>4</span><span class='hljl-p'>)</span>
</pre>



0.375 &#45; 3.75&#8729;x<sup>2</sup> &#43; 4.375&#8729;x<sup>4</sup>

<p>The term <em>recursion</em> is applied to a function when it makes a reference to itself during a computation. With this function, don&#39;t try it with values much bigger than <span class="math">$20$</span>, as the recursion can take a long time.</p>
<p>The nodes are the roots of the right polynomial. Here we have the values for <code>p4</code></p>


<pre class='hljl'>
<span class='hljl-n'>xs</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>Polynomials</span><span class='hljl-oB'>.</span><span class='hljl-nf'>roots</span><span class='hljl-p'>(</span><span class='hljl-n'>p4</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
4-element Vector&#123;Float64&#125;:
 -0.8611363115940536
 -0.33998104358485653
  0.3399810435848563
  0.8611363115940531
</pre>


<p>&#40;The Konrod part of <code>quadgk</code> changes the nodes so they can be reused during the refinement.&#41;</p>
<p>Finally, the weights  involve the derivative of <span class="math">$P_n$</span> through:</p>
<p class="math">\[
w_i = \frac{2}{(1 - x_i^2) \cdot(P^{'}_n(x_i)/P_n(1))^2}
\]</p>
<p>These can be done simply with:</p>


<pre class='hljl'>
<span class='hljl-nf'>weights</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>2</span><span class='hljl-t'> </span><span class='hljl-oB'>/</span><span class='hljl-t'> </span><span class='hljl-p'>((</span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-oB'>^</span><span class='hljl-ni'>2</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>Polynomials</span><span class='hljl-oB'>.</span><span class='hljl-nf'>derivative</span><span class='hljl-p'>(</span><span class='hljl-n'>p4</span><span class='hljl-p'>)(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-oB'>/</span><span class='hljl-nf'>p4</span><span class='hljl-p'>(</span><span class='hljl-ni'>1</span><span class='hljl-p'>))</span><span class='hljl-oB'>^</span><span class='hljl-ni'>2</span><span class='hljl-t'> </span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>ws</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-nf'>weights</span><span class='hljl-p'>(</span><span class='hljl-n'>xi</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-k'>for</span><span class='hljl-t'> </span><span class='hljl-n'>xi</span><span class='hljl-t'> </span><span class='hljl-kp'>in</span><span class='hljl-t'> </span><span class='hljl-n'>xs</span><span class='hljl-p'>]</span>
</pre>


<pre class="output">
4-element Vector&#123;Float64&#125;:
 0.3478548451374517
 0.6521451548625461
 0.6521451548625463
 0.3478548451374526
</pre>


<p>From here <code>gauss_quadrature</code> will do the integration of <code>f</code> over the interval <span class="math">$[-1,1]$</span>, though we can do it ourself quickly enough. Here we compute the integral of <span class="math">$\cos(\pi/2 x)$</span> over <span class="math">$[-1,1]$</span> &#40;you can check this is very close to the answer <span class="math">$4/\pi$</span> even with just 4 nodes&#41;:</p>
<pre><code>f&#40;x&#41; &#61; cos&#40;pi/2*x&#41;
sum&#40;w * f&#40;x&#41; for &#40;w,x&#41; in zip&#40;ws, xs&#41;&#41;</code></pre>
<h3>Adaptive integration</h3>
<p>Next, we a have a brief discussion about an alternative means to compute integrals. The following function <code>adapt</code> implements a basic <em>adaptive quadrature</em> method for integration. The basic idea is that for a subinterval <span class="math">$[a,b]$</span> if the area of the trapezoid is not close to the area of Simpson&#39;s parabolic estimate then the subinterval is split into two pieces <span class="math">$[a,c]$</span> and <span class="math">$[c,b]$</span> and the same question is asked. If the area is close the Simpson&#39;s parabolic estimate is used to estimate the integral of <span class="math">$f$</span> over that subinterval.</p>
<p>Again, we see <em>recursion</em> when  programming this algorithm.  To avoid infinite loops during this, we use a limit below to keep track.</p>
<p>In general, the value of adaptive methods like this, is the function calls concentrate on areas where <span class="math">$f$</span> is not well approximated and where it is well approximated it just moves on. This approach works well for poorly behaved functions, as it has a more refined grid there.</p>



<pre class='hljl'>
<span class='hljl-k'>function</span><span class='hljl-t'> </span><span class='hljl-nf'>adapt</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>a</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>b</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>limit</span><span class='hljl-p'>)</span><span class='hljl-t'>

    </span><span class='hljl-n'>h</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>b</span><span class='hljl-oB'>-</span><span class='hljl-n'>a</span><span class='hljl-t'>
    </span><span class='hljl-n'>c</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>a</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>b</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-n'>a</span><span class='hljl-p'>)</span><span class='hljl-oB'>/</span><span class='hljl-ni'>2</span><span class='hljl-t'>

    </span><span class='hljl-n'>a1</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>a</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>b</span><span class='hljl-p'>))</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-n'>h</span><span class='hljl-oB'>/</span><span class='hljl-ni'>2</span><span class='hljl-t'>          </span><span class='hljl-cs'>## trapezoid</span><span class='hljl-t'>
    </span><span class='hljl-n'>a2</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>a</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-ni'>4</span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>c</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>b</span><span class='hljl-p'>))</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-n'>h</span><span class='hljl-oB'>/</span><span class='hljl-ni'>6</span><span class='hljl-t'>  </span><span class='hljl-cs'>## Simpson&#39;s parabola</span><span class='hljl-t'>

    </span><span class='hljl-k'>if</span><span class='hljl-t'> </span><span class='hljl-nf'>isapprox</span><span class='hljl-p'>(</span><span class='hljl-n'>a1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>a2</span><span class='hljl-p'>)</span><span class='hljl-t'>
        </span><span class='hljl-k'>return</span><span class='hljl-p'>(</span><span class='hljl-n'>a2</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-k'>end</span><span class='hljl-t'>

    </span><span class='hljl-k'>if</span><span class='hljl-t'> </span><span class='hljl-n'>limit</span><span class='hljl-t'> </span><span class='hljl-oB'>==</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-t'>
        </span><span class='hljl-nf'>println</span><span class='hljl-p'>(</span><span class='hljl-s'>&quot;limit reached for this interval [</span><span class='hljl-si'>$a</span><span class='hljl-s'>, </span><span class='hljl-si'>$b</span><span class='hljl-s'>]&quot;</span><span class='hljl-p'>)</span><span class='hljl-t'>
	</span><span class='hljl-k'>return</span><span class='hljl-p'>(</span><span class='hljl-n'>a2</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-k'>end</span><span class='hljl-t'>

    </span><span class='hljl-nf'>adapt</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>a</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>c</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>limit</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-nf'>adapt</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>c</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>b</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>limit</span><span class='hljl-oB'>-</span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span>
</pre>


<pre class="output">
adapt &#40;generic function with 1 method&#41;
</pre>


<p>Does it work? Let&#39;s see it for the area of <span class="math">$f(x) = x^2(1-x)^{10}$</span> which is known to satisfy <span class="math">$\beta(2+1, 10+1)$</span></p>
<pre><code>out &#61; adapt&#40;x -&gt; x^2 * &#40;1 -x&#41;^10, 0, 1, 10&#41;</code></pre>
<p>Not too far off  &#40;<code>1e-10</code>&#41; from the known answer which is a beta function:</p>
<pre><code>out - beta&#40;2 &#43; 1, 10 &#43; 1&#41;</code></pre>
<p>&#40;The use of <code>isapprox</code> above determines how accurate the values will be. This function uses two tolerances to test if the valus <code>x</code> and <code>y</code> are approximately the same. These could be changed easily enough so that more precise answers can be found.&#41;</p>


        <HR/>
        <div class="footer">
          <p>
            Published from <a href="integration.jmd">integration.jmd</a>
            using <a href="http://github.com/JunoLab/Weave.jl">Weave.jl</a> v0.10.10 on 2022-06-21.
          </p>
        </div>
      </div>
    </div>
  </div>
</BODY>

</HTML>
