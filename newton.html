<!DOCTYPE html>
<HTML lang = "en">
<HEAD>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  
  

  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]},
      TeX: { equationNumbers: { autoNumber: "AMS" } }
    });
  </script>

  <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>

  
<style>
pre.hljl {
    border: 1px solid #ccc;
    margin: 5px;
    padding: 5px;
    overflow-x: auto;
    color: rgb(68,68,68); background-color: rgb(251,251,251); }
pre.hljl > span.hljl-t { }
pre.hljl > span.hljl-w { }
pre.hljl > span.hljl-e { }
pre.hljl > span.hljl-eB { }
pre.hljl > span.hljl-o { }
pre.hljl > span.hljl-k { color: rgb(148,91,176); font-weight: bold; }
pre.hljl > span.hljl-kc { color: rgb(59,151,46); font-style: italic; }
pre.hljl > span.hljl-kd { color: rgb(214,102,97); font-style: italic; }
pre.hljl > span.hljl-kn { color: rgb(148,91,176); font-weight: bold; }
pre.hljl > span.hljl-kp { color: rgb(148,91,176); font-weight: bold; }
pre.hljl > span.hljl-kr { color: rgb(148,91,176); font-weight: bold; }
pre.hljl > span.hljl-kt { color: rgb(148,91,176); font-weight: bold; }
pre.hljl > span.hljl-n { }
pre.hljl > span.hljl-na { }
pre.hljl > span.hljl-nb { }
pre.hljl > span.hljl-nbp { }
pre.hljl > span.hljl-nc { }
pre.hljl > span.hljl-ncB { }
pre.hljl > span.hljl-nd { color: rgb(214,102,97); }
pre.hljl > span.hljl-ne { }
pre.hljl > span.hljl-neB { }
pre.hljl > span.hljl-nf { color: rgb(66,102,213); }
pre.hljl > span.hljl-nfm { color: rgb(66,102,213); }
pre.hljl > span.hljl-np { }
pre.hljl > span.hljl-nl { }
pre.hljl > span.hljl-nn { }
pre.hljl > span.hljl-no { }
pre.hljl > span.hljl-nt { }
pre.hljl > span.hljl-nv { }
pre.hljl > span.hljl-nvc { }
pre.hljl > span.hljl-nvg { }
pre.hljl > span.hljl-nvi { }
pre.hljl > span.hljl-nvm { }
pre.hljl > span.hljl-l { }
pre.hljl > span.hljl-ld { color: rgb(148,91,176); font-style: italic; }
pre.hljl > span.hljl-s { color: rgb(201,61,57); }
pre.hljl > span.hljl-sa { color: rgb(201,61,57); }
pre.hljl > span.hljl-sb { color: rgb(201,61,57); }
pre.hljl > span.hljl-sc { color: rgb(201,61,57); }
pre.hljl > span.hljl-sd { color: rgb(201,61,57); }
pre.hljl > span.hljl-sdB { color: rgb(201,61,57); }
pre.hljl > span.hljl-sdC { color: rgb(201,61,57); }
pre.hljl > span.hljl-se { color: rgb(59,151,46); }
pre.hljl > span.hljl-sh { color: rgb(201,61,57); }
pre.hljl > span.hljl-si { }
pre.hljl > span.hljl-so { color: rgb(201,61,57); }
pre.hljl > span.hljl-sr { color: rgb(201,61,57); }
pre.hljl > span.hljl-ss { color: rgb(201,61,57); }
pre.hljl > span.hljl-ssB { color: rgb(201,61,57); }
pre.hljl > span.hljl-nB { color: rgb(59,151,46); }
pre.hljl > span.hljl-nbB { color: rgb(59,151,46); }
pre.hljl > span.hljl-nfB { color: rgb(59,151,46); }
pre.hljl > span.hljl-nh { color: rgb(59,151,46); }
pre.hljl > span.hljl-ni { color: rgb(59,151,46); }
pre.hljl > span.hljl-nil { color: rgb(59,151,46); }
pre.hljl > span.hljl-noB { color: rgb(59,151,46); }
pre.hljl > span.hljl-oB { color: rgb(102,102,102); font-weight: bold; }
pre.hljl > span.hljl-ow { color: rgb(102,102,102); font-weight: bold; }
pre.hljl > span.hljl-p { }
pre.hljl > span.hljl-c { color: rgb(153,153,119); font-style: italic; }
pre.hljl > span.hljl-ch { color: rgb(153,153,119); font-style: italic; }
pre.hljl > span.hljl-cm { color: rgb(153,153,119); font-style: italic; }
pre.hljl > span.hljl-cp { color: rgb(153,153,119); font-style: italic; }
pre.hljl > span.hljl-cpB { color: rgb(153,153,119); font-style: italic; }
pre.hljl > span.hljl-cs { color: rgb(153,153,119); font-style: italic; }
pre.hljl > span.hljl-csB { color: rgb(153,153,119); font-style: italic; }
pre.hljl > span.hljl-g { }
pre.hljl > span.hljl-gd { }
pre.hljl > span.hljl-ge { }
pre.hljl > span.hljl-geB { }
pre.hljl > span.hljl-gh { }
pre.hljl > span.hljl-gi { }
pre.hljl > span.hljl-go { }
pre.hljl > span.hljl-gp { }
pre.hljl > span.hljl-gs { }
pre.hljl > span.hljl-gsB { }
pre.hljl > span.hljl-gt { }
</style>



  <style type="text/css">
  .admonition {
    padding: 15px;
    margin-bottom: 21px;
    border-left: 10px solid transparent;
}

.admonition .title {
    margin: 0;
    text-transform: uppercase;
    padding-left: 3px;
    border: 1px solid;
    border-style: hidden hidden solid;
}

.admonition .content {
    padding-left: .75em;
    padding-right: .75em;
    padding-top: 0.5em;
    margin-left: 0;
    border-left: 0;
    border-top: 0;
    min-height: 0;
}

.note {
    border-color: olive;
    background-color: #f6fffe;
}

.note .title {
    color: olive;
    border-color: olive;
}

.tip {
    border-color: blue;
    background-color: #f6fcff;
}

.tip .title {
    color: blue;
    border-color: blue;
}

.warning {
    border-color: orange;
    background-color: #fffeec;
}

.warning .title {
    color: orange;
    border-color: orange;
}

.important {
    border-color: red;
    background-color: #fffbfb;
}

.important .title {
    color: red;
    border-color: red;
}


@font-face {
  font-style: normal;
  font-weight: 300;
}
@font-face {
  font-style: normal;
  font-weight: 400;
}
@font-face {
  font-style: normal;
  font-weight: 600;
}
html {
  font-family: sans-serif; /* 1 */
  -ms-text-size-adjust: 100%; /* 2 */
  -webkit-text-size-adjust: 100%; /* 2 */
}
body {
  margin: 0;
}
article,
aside,
details,
figcaption,
figure,
footer,
header,
hgroup,
main,
menu,
nav,
section,
summary {
  display: block;
}
audio,
canvas,
progress,
video {
  display: inline-block; /* 1 */
  vertical-align: baseline; /* 2 */
}
audio:not([controls]) {
  display: none;
  height: 0;
}
[hidden],
template {
  display: none;
}
a:active,
a:hover {
  outline: 0;
}
abbr[title] {
  border-bottom: 1px dotted;
}
b,
strong {
  font-weight: bold;
}
dfn {
  font-style: italic;
}
h1 {
  font-size: 2em;
  margin: 0.67em 0;
}
mark {
  background: #ff0;
  color: #000;
}
small {
  font-size: 80%;
}
sub,
sup {
  font-size: 75%;
  line-height: 0;
  position: relative;
  vertical-align: baseline;
}
sup {
  top: -0.5em;
}
sub {
  bottom: -0.25em;
}
img {
  border: 0;
}
svg:not(:root) {
  overflow: hidden;
}
figure {
  margin: 1em 40px;
}
hr {
  -moz-box-sizing: content-box;
  box-sizing: content-box;
  height: 0;
}
pre {
  overflow: auto;
}
code,
kbd,
pre,
samp {
  font-family: monospace, monospace;
  font-size: 1em;
}
button,
input,
optgroup,
select,
textarea {
  color: inherit; /* 1 */
  font: inherit; /* 2 */
  margin: 0; /* 3 */
}
button {
  overflow: visible;
}
button,
select {
  text-transform: none;
}
button,
html input[type="button"], /* 1 */
input[type="reset"],
input[type="submit"] {
  -webkit-appearance: button; /* 2 */
  cursor: pointer; /* 3 */
}
button[disabled],
html input[disabled] {
  cursor: default;
}
button::-moz-focus-inner,
input::-moz-focus-inner {
  border: 0;
  padding: 0;
}
input {
  line-height: normal;
}
input[type="checkbox"],
input[type="radio"] {
  box-sizing: border-box; /* 1 */
  padding: 0; /* 2 */
}
input[type="number"]::-webkit-inner-spin-button,
input[type="number"]::-webkit-outer-spin-button {
  height: auto;
}
input[type="search"] {
  -webkit-appearance: textfield; /* 1 */
  -moz-box-sizing: content-box;
  -webkit-box-sizing: content-box; /* 2 */
  box-sizing: content-box;
}
input[type="search"]::-webkit-search-cancel-button,
input[type="search"]::-webkit-search-decoration {
  -webkit-appearance: none;
}
fieldset {
  border: 1px solid #c0c0c0;
  margin: 0 2px;
  padding: 0.35em 0.625em 0.75em;
}
legend {
  border: 0; /* 1 */
  padding: 0; /* 2 */
}
textarea {
  overflow: auto;
}
optgroup {
  font-weight: bold;
}
table {
  font-family: monospace, monospace;
  font-size : 0.8em;
  border-collapse: collapse;
  border-spacing: 0;
}
td,
th {
  padding: 0;
}
thead th {
    border-bottom: 1px solid black;
    background-color: white;
}
tr:nth-child(odd){
  background-color: rgb(248,248,248);
}


/*
* Skeleton V2.0.4
* Copyright 2014, Dave Gamache
* www.getskeleton.com
* Free to use under the MIT license.
* http://www.opensource.org/licenses/mit-license.php
* 12/29/2014
*/
.container {
  position: relative;
  width: 100%;
  max-width: 960px;
  margin: 0 auto;
  padding: 0 20px;
  box-sizing: border-box; }
.column,
.columns {
  width: 100%;
  float: left;
  box-sizing: border-box; }
@media (min-width: 400px) {
  .container {
    width: 85%;
    padding: 0; }
}
@media (min-width: 550px) {
  .container {
    width: 80%; }
  .column,
  .columns {
    margin-left: 4%; }
  .column:first-child,
  .columns:first-child {
    margin-left: 0; }

  .one.column,
  .one.columns                    { width: 4.66666666667%; }
  .two.columns                    { width: 13.3333333333%; }
  .three.columns                  { width: 22%;            }
  .four.columns                   { width: 30.6666666667%; }
  .five.columns                   { width: 39.3333333333%; }
  .six.columns                    { width: 48%;            }
  .seven.columns                  { width: 56.6666666667%; }
  .eight.columns                  { width: 65.3333333333%; }
  .nine.columns                   { width: 74.0%;          }
  .ten.columns                    { width: 82.6666666667%; }
  .eleven.columns                 { width: 91.3333333333%; }
  .twelve.columns                 { width: 100%; margin-left: 0; }

  .one-third.column               { width: 30.6666666667%; }
  .two-thirds.column              { width: 65.3333333333%; }

  .one-half.column                { width: 48%; }

  /* Offsets */
  .offset-by-one.column,
  .offset-by-one.columns          { margin-left: 8.66666666667%; }
  .offset-by-two.column,
  .offset-by-two.columns          { margin-left: 17.3333333333%; }
  .offset-by-three.column,
  .offset-by-three.columns        { margin-left: 26%;            }
  .offset-by-four.column,
  .offset-by-four.columns         { margin-left: 34.6666666667%; }
  .offset-by-five.column,
  .offset-by-five.columns         { margin-left: 43.3333333333%; }
  .offset-by-six.column,
  .offset-by-six.columns          { margin-left: 52%;            }
  .offset-by-seven.column,
  .offset-by-seven.columns        { margin-left: 60.6666666667%; }
  .offset-by-eight.column,
  .offset-by-eight.columns        { margin-left: 69.3333333333%; }
  .offset-by-nine.column,
  .offset-by-nine.columns         { margin-left: 78.0%;          }
  .offset-by-ten.column,
  .offset-by-ten.columns          { margin-left: 86.6666666667%; }
  .offset-by-eleven.column,
  .offset-by-eleven.columns       { margin-left: 95.3333333333%; }

  .offset-by-one-third.column,
  .offset-by-one-third.columns    { margin-left: 34.6666666667%; }
  .offset-by-two-thirds.column,
  .offset-by-two-thirds.columns   { margin-left: 69.3333333333%; }

  .offset-by-one-half.column,
  .offset-by-one-half.columns     { margin-left: 52%; }

}
html {
  font-size: 62.5%; }
body {
  font-size: 1.5em; /* currently ems cause chrome bug misinterpreting rems on body element */
  line-height: 1.6;
  font-weight: 400;
  font-family: "Raleway", "HelveticaNeue", "Helvetica Neue", Helvetica, Arial, sans-serif;
  color: #222; }
h1, h2, h3, h4, h5, h6 {
  margin-top: 0;
  margin-bottom: 2rem;
  font-weight: 300; }
h1 { font-size: 3.6rem; line-height: 1.2;  letter-spacing: -.1rem;}
h2 { font-size: 3.4rem; line-height: 1.25; letter-spacing: -.1rem; }
h3 { font-size: 3.2rem; line-height: 1.3;  letter-spacing: -.1rem; }
h4 { font-size: 2.8rem; line-height: 1.35; letter-spacing: -.08rem; }
h5 { font-size: 2.4rem; line-height: 1.5;  letter-spacing: -.05rem; }
h6 { font-size: 1.5rem; line-height: 1.6;  letter-spacing: 0; }

p {
  margin-top: 0; }
a {
  color: #1EAEDB; }
a:hover {
  color: #0FA0CE; }
.button,
button,
input[type="submit"],
input[type="reset"],
input[type="button"] {
  display: inline-block;
  height: 38px;
  padding: 0 30px;
  color: #555;
  text-align: center;
  font-size: 11px;
  font-weight: 600;
  line-height: 38px;
  letter-spacing: .1rem;
  text-transform: uppercase;
  text-decoration: none;
  white-space: nowrap;
  background-color: transparent;
  border-radius: 4px;
  border: 1px solid #bbb;
  cursor: pointer;
  box-sizing: border-box; }
.button:hover,
button:hover,
input[type="submit"]:hover,
input[type="reset"]:hover,
input[type="button"]:hover,
.button:focus,
button:focus,
input[type="submit"]:focus,
input[type="reset"]:focus,
input[type="button"]:focus {
  color: #333;
  border-color: #888;
  outline: 0; }
.button.button-primary,
button.button-primary,
input[type="submit"].button-primary,
input[type="reset"].button-primary,
input[type="button"].button-primary {
  color: #FFF;
  background-color: #33C3F0;
  border-color: #33C3F0; }
.button.button-primary:hover,
button.button-primary:hover,
input[type="submit"].button-primary:hover,
input[type="reset"].button-primary:hover,
input[type="button"].button-primary:hover,
.button.button-primary:focus,
button.button-primary:focus,
input[type="submit"].button-primary:focus,
input[type="reset"].button-primary:focus,
input[type="button"].button-primary:focus {
  color: #FFF;
  background-color: #1EAEDB;
  border-color: #1EAEDB; }
input[type="email"],
input[type="number"],
input[type="search"],
input[type="text"],
input[type="tel"],
input[type="url"],
input[type="password"],
textarea,
select {
  height: 38px;
  padding: 6px 10px; /* The 6px vertically centers text on FF, ignored by Webkit */
  background-color: #fff;
  border: 1px solid #D1D1D1;
  border-radius: 4px;
  box-shadow: none;
  box-sizing: border-box; }
/* Removes awkward default styles on some inputs for iOS */
input[type="email"],
input[type="number"],
input[type="search"],
input[type="text"],
input[type="tel"],
input[type="url"],
input[type="password"],
textarea {
  -webkit-appearance: none;
     -moz-appearance: none;
          appearance: none; }
textarea {
  min-height: 65px;
  padding-top: 6px;
  padding-bottom: 6px; }
input[type="email"]:focus,
input[type="number"]:focus,
input[type="search"]:focus,
input[type="text"]:focus,
input[type="tel"]:focus,
input[type="url"]:focus,
input[type="password"]:focus,
textarea:focus,
select:focus {
  border: 1px solid #33C3F0;
  outline: 0; }
label,
legend {
  display: block;
  margin-bottom: .5rem;
  font-weight: 600; }
fieldset {
  padding: 0;
  border-width: 0; }
input[type="checkbox"],
input[type="radio"] {
  display: inline; }
label > .label-body {
  display: inline-block;
  margin-left: .5rem;
  font-weight: normal; }
ul {
  list-style: circle; }
ol {
  list-style: decimal; }
ul ul,
ul ol,
ol ol,
ol ul {
  margin: 1.5rem 0 1.5rem 3rem;
  font-size: 90%; }
li > p {margin : 0;}
th,
td {
  padding: 12px 15px;
  text-align: left;
  border-bottom: 1px solid #E1E1E1; }
th:first-child,
td:first-child {
  padding-left: 0; }
th:last-child,
td:last-child {
  padding-right: 0; }
button,
.button {
  margin-bottom: 1rem; }
input,
textarea,
select,
fieldset {
  margin-bottom: 1.5rem; }
pre,
blockquote,
dl,
figure,
table,
p,
ul,
ol,
form {
  margin-bottom: 1.0rem; }
.u-full-width {
  width: 100%;
  box-sizing: border-box; }
.u-max-full-width {
  max-width: 100%;
  box-sizing: border-box; }
.u-pull-right {
  float: right; }
.u-pull-left {
  float: left; }
hr {
  margin-top: 3rem;
  margin-bottom: 3.5rem;
  border-width: 0;
  border-top: 1px solid #E1E1E1; }
.container:after,
.row:after,
.u-cf {
  content: "";
  display: table;
  clear: both; }

pre {
  display: block;
  padding: 9.5px;
  margin: 0 0 10px;
  font-size: 13px;
  line-height: 1.42857143;
  word-break: break-all;
  word-wrap: break-word;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre.hljl {
  margin: 0 0 10px;
  display: block;
  background: #f5f5f5;
  border-radius: 4px;
  padding : 5px;
}

pre.output {
  background: #ffffff;
}

pre.code {
  background: #ffffff;
}

pre.julia-error {
  color : red
}

code,
kbd,
pre,
samp {
  font-family: Menlo, Monaco, Consolas, "Courier New", monospace;
  font-size: 0.9em;
}


@media (min-width: 400px) {}
@media (min-width: 550px) {}
@media (min-width: 750px) {}
@media (min-width: 1000px) {}
@media (min-width: 1200px) {}

h1.title {margin-top : 20px}
img {max-width : 100%}
div.title {text-align: center;}

  </style>
</HEAD>

<BODY>
  <div class ="container">
    <div class = "row">
      <div class = "col-md-12 twelve columns">
        <div class="title">
          
          
          
        </div>

        <h1>Newton&#39;s method using julia</h1>
<h2>Introduction</h2>
<p>Newton&#39;s method is an old method for <em>approximating</em> a zero of a function, <span class="math">$f(x)$</span>:</p>
<p class="math">\[
f(x) = 0
\]</p>
<p>Previously we discussed the <em>bisection method</em> which applied for some continuous function <span class="math">$f(x)$</span> which changed signs between <span class="math">$a$</span> and <span class="math">$b$</span>, points which bracket a zero. Not only did we need to find these bracketing points – which wasn&#39;t hard from a graph, more importantly the actual algorithm is pretty slow.</p>
<p>If the function <span class="math">$f$</span> is sufficiently differentiable, then Newton&#39;s method may work to find a zero.  Unlike the bisection method which is slow but guaranteed to find a root by the intermediate value theorem, Newton&#39;s method is fast &#40;once it is close&#41; but has no such guarantee of converging. In this project, we&#39;ll see how to implement the algorithm, try some examples, and then look at what can go wrong.</p>
<p>The <code>MTH229</code> package provides a function <code>newton</code> for easily performing Newton&#39;s method, utilizing a function from the <code>Roots</code> package. More usefully, we will see that <code>find_zero</code>, which we used for bisection, can also be used for root finding with an algorithm that is a bit more robust than Newton&#39;s method.</p>
<p>To begin, we load <code>MTH229</code> and <code>Plots</code>. In the background this loads <code>Roots</code>:</p>


<pre class='hljl'>
<span class='hljl-k'>using</span><span class='hljl-t'> </span><span class='hljl-n'>MTH229</span><span class='hljl-t'>
</span><span class='hljl-k'>using</span><span class='hljl-t'> </span><span class='hljl-n'>Plots</span><span class='hljl-t'>
</span><span class='hljl-nf'>plotly</span><span class='hljl-p'>()</span>
</pre>


<pre class="output">
Plots.PlotlyBackend&#40;&#41;
</pre>



<h2>Basic idea</h2>
<p>The idea behind Newton&#39;s method is simple – <em>linear approximation</em>. That is, most functions at any given point are well approximated by the tangent line at that point. If we have a good guess <span class="math">$x_n$</span>, then we can improve this guess iteratively by replacing it with the zero, <span class="math">$x_{n+1}$</span>, of the tangent line at <span class="math">$(x_n, f(x_n))$</span>.</p>
<p><img src="figures/newton/newton-one-step.png" alt="Newton, one step" /></p>
<p>A simple picture shows that we have a triangle with base <span class="math">$x_{n+1} - x_{n}$</span>, rise <span class="math">$0 - f(x_n)$</span> and slope <span class="math">$f'(x_n)$</span>, using the &quot;rise over run&quot; formula:</p>
<p class="math">\[
f'(x_n) = \frac{-f(x_n)}{x_{n+1} - x_{n}}.
\]</p>
<p>The basic algorithm of Newton&#39;s methods solves this to get:</p>
<p class="math">\[
x_{n+1} = x_n - \frac{f(x_n)}{f'(x_n)}.
\]</p>
<p>Some books write the right-hand side as <span class="math">$x_n - f'(x_n)^{-1} f(x_n)$</span>, a form that generalizes to different settings.</p>
<p>Like the bisection method, Newton&#39;s method is an <em>iterative method</em>. One begins with a &#40;suitable&#41; guess <span class="math">$x_0$</span>. From that the algorithm produces <span class="math">$x_1$</span> which is used to produce <span class="math">$x_2$</span>, etc. The idea is that one eventually will settle on a value <span class="math">$x_n$</span> sufficiently close to the desired root.</p>
<p>Mathematically, the indices indicate that the right hand side is computed and assigned to the left hand side. This is exactly what is done in assignment within <code>julia</code>, so  the above simply becomes:</p>


<pre class='hljl'>
<span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-oB'>/</span><span class='hljl-n'>f</span><span class='hljl-oB'>&#39;</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span>
</pre>


<p>Where <code>f&#40;x&#41;</code> is the function and <code>f&#39;&#40;x&#41;</code> its derivative. &#40;In this case found by automatic differentiation.&#41; This line starts with a previously defined value of <code>x</code> and updates it accordingly.</p>
<p>The updating is continued – by executing the exact same command – until either the algorithm has gotten close enough to an answer &#40;i.e., it has converged&#41; or we have given up on it converging.</p>
<p>Here is an example to find a zero of the function: <span class="math">$f(x) = x^3 - 2x - 5$</span>.</p>
<p>A quick graph shows a root near 2:</p>


<pre class='hljl'>
<span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-oB'>^</span><span class='hljl-ni'>3</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-ni'>2</span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-ni'>5</span><span class='hljl-t'>
</span><span class='hljl-nf'>plot</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-ni'>3</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>3</span><span class='hljl-p'>)</span>
</pre>



<script src="https://cdn.plot.ly/plotly-2.6.3.min.js"></script>    <div id="73fff3bd-65da-4501-b120-f14c40019609" style="width:576px;height:384px;"></div>
    <script>
    
        Plotly.newPlot('73fff3bd-65da-4501-b120-f14c40019609', [
    {
        "xaxis": "x",
        "colorbar": {
            "title": ""
        },
        "yaxis": "y",
        "x": [
            -3.0,
            -2.9902341809802118,
            -2.9804683619604235,
            -2.9707025429406357,
            -2.9609367239208475,
            -2.915787174846555,
            -2.870637625772263,
            -2.8254880766979706,
            -2.780338527623678,
            -2.7351889785493855,
            -2.6900394294750933,
            -2.644889880400801,
            -2.5997403313265086,
            -2.5454743371892574,
            -2.4912083430520067,
            -2.4369423489147555,
            -2.3826763547775043,
            -2.3367951473673623,
            -2.2909139399572207,
            -2.245032732547079,
            -2.199151525136937,
            -2.1493116738196516,
            -2.0994718225023656,
            -2.04963197118508,
            -1.9997921198677944,
            -1.9078962508646409,
            -1.8160003818614874,
            -1.717478298117764,
            -1.6189562143740408,
            -1.5618824664419981,
            -1.5048087185099557,
            -1.4477349705779132,
            -1.3906612226458708,
            -1.2892203991008926,
            -1.1877795755559142,
            -1.098825114697517,
            -1.00987065383912,
            -0.9128864136089211,
            -0.8159021733787222,
            -0.718341529183737,
            -0.6207808849887516,
            -0.40504934950238297,
            -0.19978623702062615,
            0.013639774045402136,
            0.19329901466738048,
            0.41264258394545644,
            0.6135751697836116,
            0.7063635443695611,
            0.7991519189555105,
            0.8931436670077773,
            0.9871354150600441,
            1.0924738145503499,
            1.1978122140406555,
            1.2932658101298946,
            1.388719406219134,
            1.4980071902979462,
            1.6072949743767582,
            1.6578903590013856,
            1.708485743626013,
            1.7590811282506404,
            1.8096765128752679,
            1.8595576333872277,
            1.9094387538991873,
            1.959319874411147,
            2.009200994923107,
            2.057631434610292,
            2.106061874297477,
            2.154492313984662,
            2.202922753671847,
            2.252570147126132,
            2.3022175405804175,
            2.3518649340347024,
            2.4015123274889874,
            2.4559068108079005,
            2.5103012941268137,
            2.564695777445727,
            2.6190902607646405,
            2.6981071686716778,
            2.7771240765787155,
            2.856140984485753,
            2.93515789239279,
            2.9513684192945924,
            2.967578946196395,
            2.9837894730981978,
            3.0
        ],
        "showlegend": true,
        "mode": "lines",
        "name": "y1",
        "zmin": null,
        "legendgroup": "y1",
        "zmax": null,
        "line": {
            "color": "rgba(0, 154, 250, 1.000)",
            "shape": "linear",
            "dash": "solid",
            "width": 1
        },
        "y": [
            -26.0,
            -25.756711934117355,
            -25.515134961946487,
            -25.2752634952189,
            -25.03709194566606,
            -23.95790834994008,
            -22.91438742842401,
            -21.90597696191842,
            -20.93212473122388,
            -19.99227851714099,
            -19.08588610047034,
            -18.212395262012507,
            -17.371253782568065,
            -16.402298550070654,
            -15.478318765824717,
            -14.598355615445232,
            -13.761450284547223,
            -13.086740302106548,
            -12.441545236854449,
            -11.825285585688665,
            -11.237381845506944,
            -10.630209344692993,
            -10.055070324074475,
            -9.511221967283923,
            -8.997921457953856,
            -8.12907978690515,
            -7.3569095102504125,
            -6.631143591522574,
            -6.0054029320382085,
            -5.68641116920856,
            -5.397945581099694,
            -5.138890691202479,
            -4.9081310230077815,
            -4.564358551854942,
            -4.300184409891458,
            -4.129089490508258,
            -4.010163904956656,
            -3.9349916588356337,
            -3.911338757340884,
            -3.9339916243923763,
            -3.9976678812610347,
            -4.256355712610718,
            -4.608401901808222,
            -5.027277010500375,
            -5.379375506547733,
            -5.755022904956007,
            -5.996154941075197,
            -6.060287381962485,
            -6.087930427946917,
            -6.0738216203824145,
            -6.0123702213601575,
            -5.881081185149675,
            -5.67705844283066,
            -5.423497405970604,
            -5.099235681802174,
            -4.634447983191494,
            -4.0623087174003505,
            -3.7589025436852417,
            -3.430032238965462,
            -3.0749206906320152,
            -2.6927907860759066,
            -2.2888494095213945,
            -1.857147148742416,
            -1.3969393406069108,
            -0.9074813219828224,
            -0.4035659443413797,
            0.1293065729282299,
            0.6918177935796921,
            1.2846492813666925,
            1.9245634203830626,
            2.597791229410074,
            3.305066952788355,
            4.047124834858547,
            4.900934924640856,
            5.798343644718216,
            6.740316636359212,
            7.727819540832435,
            9.245418455489126,
            10.864093942951108,
            12.586806137025366,
            14.416515171518924,
            14.805380742963436,
            15.198899698906086,
            15.597097598275425,
            16.0
        ],
        "type": "scatter"
    }
]
, {
    "showlegend": true,
    "xaxis": {
        "showticklabels": true,
        "gridwidth": 0.5,
        "tickvals": [
            -3.0,
            -2.0,
            -1.0,
            0.0,
            1.0,
            2.0,
            3.0
        ],
        "range": [
            -3.18,
            3.18
        ],
        "domain": [
            0.05313137941090697,
            0.9931649168853892
        ],
        "mirror": false,
        "tickangle": 0,
        "showline": true,
        "ticktext": [
            "−3",
            "−2",
            "−1",
            "0",
            "1",
            "2",
            "3"
        ],
        "zeroline": false,
        "tickfont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 11
        },
        "zerolinecolor": "rgba(0, 0, 0, 1.000)",
        "anchor": "y",
        "visible": true,
        "ticks": "inside",
        "tickmode": "array",
        "linecolor": "rgba(0, 0, 0, 1.000)",
        "showgrid": true,
        "title": "",
        "gridcolor": "rgba(0, 0, 0, 0.100)",
        "titlefont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 15
        },
        "tickcolor": "rgb(0, 0, 0)",
        "type": "-"
    },
    "paper_bgcolor": "rgba(255, 255, 255, 1.000)",
    "annotations": [],
    "height": 384,
    "margin": {
        "l": 0,
        "b": 20,
        "r": 0,
        "t": 20
    },
    "plot_bgcolor": "rgba(255, 255, 255, 1.000)",
    "yaxis": {
        "showticklabels": true,
        "gridwidth": 0.5,
        "tickvals": [
            -20.0,
            -10.0,
            0.0,
            10.0
        ],
        "range": [
            -27.26,
            17.26
        ],
        "domain": [
            0.0391878098571012,
            0.989747375328084
        ],
        "mirror": false,
        "tickangle": 0,
        "showline": true,
        "ticktext": [
            "−20",
            "−10",
            "0",
            "10"
        ],
        "zeroline": false,
        "tickfont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 11
        },
        "zerolinecolor": "rgba(0, 0, 0, 1.000)",
        "anchor": "x",
        "visible": true,
        "ticks": "inside",
        "tickmode": "array",
        "linecolor": "rgba(0, 0, 0, 1.000)",
        "showgrid": true,
        "title": "",
        "gridcolor": "rgba(0, 0, 0, 0.100)",
        "titlefont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 15
        },
        "tickcolor": "rgb(0, 0, 0)",
        "type": "-"
    },
    "legend_position": {
        "yanchor": "auto",
        "xanchor": "auto",
        "bordercolor": "rgba(0, 0, 0, 1.000)",
        "bgcolor": "rgba(255, 255, 255, 1.000)",
        "borderwidth": 1,
        "tracegroupgap": 0,
        "y": 1.0,
        "font": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 11
        },
        "title": {
            "font": {
                "color": "rgba(0, 0, 0, 1.000)",
                "family": "sans-serif",
                "size": 15
            },
            "text": ""
        },
        "traceorder": "normal",
        "x": 1.0
    },
    "width": 576
}
);

    
    </script>


<p>Here we improve the estimate for the root near 2 using Newton&#39;s method. We will need the first derivative, which we denote <code>fp</code></p>


<pre class='hljl'>
<span class='hljl-nf'>fp</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>3</span><span class='hljl-n'>x</span><span class='hljl-oB'>^</span><span class='hljl-ni'>2</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-ni'>2</span><span class='hljl-t'>
</span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>2</span><span class='hljl-t'>				</span><span class='hljl-cs'># starting value, x_0</span><span class='hljl-t'>
</span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-oB'>/</span><span class='hljl-nf'>fp</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'>		</span><span class='hljl-cs'># new value, x_1</span><span class='hljl-t'>
</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
&#40;2.1, 0.06100000000000083&#41;
</pre>


<p>We can visualize our progress as follows, noting that <code>x</code> holds <span class="math">$x_1$</span>, and zooming into the domain <span class="math">$[1,3]$</span>:</p>


<pre class='hljl'>
<span class='hljl-n'>x0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>x1</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>2</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-t'>
</span><span class='hljl-nf'>plot</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>3</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>legend</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>plot!</span><span class='hljl-p'>([</span><span class='hljl-n'>x0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>x0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>x1</span><span class='hljl-p'>],</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x0</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-p'>])</span><span class='hljl-t'>  </span><span class='hljl-cs'># why these values?</span><span class='hljl-t'>
</span><span class='hljl-nf'>scatter!</span><span class='hljl-p'>([</span><span class='hljl-n'>x0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>x1</span><span class='hljl-p'>],</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-p'>])</span>
</pre>



<script src="https://cdn.plot.ly/plotly-2.6.3.min.js"></script>    <div id="b31caadf-5f44-4242-8da8-c1ad4ebd3cb7" style="width:576px;height:384px;"></div>
    <script>
    
        Plotly.newPlot('b31caadf-5f44-4242-8da8-c1ad4ebd3cb7', [
    {
        "xaxis": "x",
        "colorbar": {
            "title": ""
        },
        "yaxis": "y",
        "x": [
            1.0,
            1.013021092026384,
            1.1334198895578305,
            1.2057745484074984,
            1.2669494916210209,
            1.333402626710735,
            1.3946665393795041,
            1.4603479285419863,
            1.5364462591180432,
            1.6040734748146954,
            1.6633764487202933,
            1.7280326088737594,
            1.7930730383370828,
            1.8649835501658725,
            1.9334045876597914,
            2.0045465913484675,
            2.064433004889127,
            2.100990266435473,
            2.137547527981819,
            2.171036292288178,
            2.2045250565945373,
            2.2354545147898537,
            2.26638397298517,
            2.297714555669259,
            2.329045138353348,
            2.3641579381834497,
            2.3992707380135516,
            2.4310886033766312,
            2.4629064687397113,
            2.4993357300993155,
            2.5357649914589193,
            2.569495247875338,
            2.603225504291756,
            2.6364795846330624,
            2.669733664974369,
            2.702020624765826,
            2.7343075845572824,
            2.767405846860139,
            2.8005041091629956,
            2.8367670980422712,
            2.873030086921547,
            2.925708025526238,
            2.97838596413093,
            2.989192982065465,
            3.0
        ],
        "showlegend": true,
        "mode": "lines",
        "name": "y1",
        "zmin": null,
        "legendgroup": "y1",
        "zmax": null,
        "line": {
            "color": "rgba(0, 154, 250, 1.000)",
            "shape": "linear",
            "dash": "solid",
            "width": 1
        },
        "y": [
            -6.0,
            -5.98646805374992,
            -5.810802519953515,
            -5.658482811666405,
            -5.500241052181002,
            -5.296065299165003,
            -5.07657450655289,
            -4.806334393383857,
            -4.445854372420428,
            -4.080782948114644,
            -3.724487658645095,
            -3.295992751509225,
            -2.8212173693041733,
            -2.243249122490684,
            -1.6396397769871953,
            -0.9544099635731556,
            -0.3304927775505133,
            0.07212687099540815,
            0.49159352057627004,
            0.8908867979040336,
            1.3047889437247004,
            1.7002314415812991,
            2.108504975119443,
            2.535336915660107,
            2.975701550449916,
            3.4855367552625864,
            4.012860705585155,
            4.506022715840606,
            5.013951788745606,
            5.613876788279182,
            6.23370286478087,
            6.825602956509176,
            7.4350434022589535,
            8.053275281408899,
            8.689000210923814,
            9.323182894035014,
            9.974265869436646,
            10.659463179171073,
            11.362850563974579,
            12.154632936136693,
            12.96879747495403,
            14.191964275890001,
            15.463843504837705,
            15.730874414197054,
            16.0
        ],
        "type": "scatter"
    },
    {
        "xaxis": "x",
        "colorbar": {
            "title": ""
        },
        "yaxis": "y",
        "x": [
            2.0,
            2.0,
            2.1
        ],
        "showlegend": true,
        "mode": "lines",
        "name": "y2",
        "zmin": null,
        "legendgroup": "y2",
        "zmax": null,
        "line": {
            "color": "rgba(227, 111, 71, 1.000)",
            "shape": "linear",
            "dash": "solid",
            "width": 1
        },
        "y": [
            0.0,
            -1.0,
            0.0
        ],
        "type": "scatter"
    },
    {
        "xaxis": "x",
        "colorbar": {
            "title": ""
        },
        "yaxis": "y",
        "x": [
            2.0,
            2.1
        ],
        "showlegend": true,
        "mode": "markers",
        "name": "y3",
        "zmin": null,
        "legendgroup": "y3",
        "marker": {
            "symbol": "circle",
            "color": "rgba(62, 164, 78, 1.000)",
            "line": {
                "color": "rgba(0, 0, 0, 1.000)",
                "width": 1
            },
            "size": 8
        },
        "zmax": null,
        "y": [
            0.0,
            0.0
        ],
        "type": "scatter"
    }
]
, {
    "showlegend": false,
    "xaxis": {
        "showticklabels": true,
        "gridwidth": 0.5,
        "tickvals": [
            1.0,
            1.5,
            2.0,
            2.5,
            3.0
        ],
        "range": [
            0.94,
            3.06
        ],
        "domain": [
            0.03769928064547487,
            0.9931649168853894
        ],
        "mirror": false,
        "tickangle": 0,
        "showline": true,
        "ticktext": [
            "1.0",
            "1.5",
            "2.0",
            "2.5",
            "3.0"
        ],
        "zeroline": false,
        "tickfont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 11
        },
        "zerolinecolor": "rgba(0, 0, 0, 1.000)",
        "anchor": "y",
        "visible": true,
        "ticks": "inside",
        "tickmode": "array",
        "linecolor": "rgba(0, 0, 0, 1.000)",
        "showgrid": true,
        "title": "",
        "gridcolor": "rgba(0, 0, 0, 0.100)",
        "titlefont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 15
        },
        "tickcolor": "rgb(0, 0, 0)",
        "type": "-"
    },
    "paper_bgcolor": "rgba(255, 255, 255, 1.000)",
    "annotations": [],
    "height": 384,
    "margin": {
        "l": 0,
        "b": 20,
        "r": 0,
        "t": 20
    },
    "plot_bgcolor": "rgba(255, 255, 255, 1.000)",
    "yaxis": {
        "showticklabels": true,
        "gridwidth": 0.5,
        "tickvals": [
            -5.0,
            0.0,
            5.0,
            10.0,
            15.0
        ],
        "range": [
            -6.66,
            16.66
        ],
        "domain": [
            0.0391878098571012,
            0.989747375328084
        ],
        "mirror": false,
        "tickangle": 0,
        "showline": true,
        "ticktext": [
            "−5",
            "0",
            "5",
            "10",
            "15"
        ],
        "zeroline": false,
        "tickfont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 11
        },
        "zerolinecolor": "rgba(0, 0, 0, 1.000)",
        "anchor": "x",
        "visible": true,
        "ticks": "inside",
        "tickmode": "array",
        "linecolor": "rgba(0, 0, 0, 1.000)",
        "showgrid": true,
        "title": "",
        "gridcolor": "rgba(0, 0, 0, 0.100)",
        "titlefont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 15
        },
        "tickcolor": "rgb(0, 0, 0)",
        "type": "-"
    },
    "width": 576
}
);

    
    </script>


<p>Continuing, though without visualizing the progress, this next step will compute <span class="math">$x_2$</span>:</p>


<pre class='hljl'>
<span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-oB'>/</span><span class='hljl-nf'>fp</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
&#40;2.094568121104185, 0.00018572317327247845&#41;
</pre>


<p>This next step will compute <span class="math">$x_3$</span>:</p>


<pre class='hljl'>
<span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-oB'>/</span><span class='hljl-nf'>fp</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
&#40;2.094551481698199, 1.7397612239733462e-9&#41;
</pre>


<p>This next step will compute <span class="math">$x_4$</span>:</p>


<pre class='hljl'>
<span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-oB'>/</span><span class='hljl-nf'>fp</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
&#40;2.0945514815423265, -8.881784197001252e-16&#41;
</pre>


<p>This next step will compute <span class="math">$x_5$</span>:</p>


<pre class='hljl'>
<span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-oB'>/</span><span class='hljl-nf'>fp</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'>		</span><span class='hljl-cs'># x stopped changing</span><span class='hljl-t'>
</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
&#40;2.0945514815423265, -8.881784197001252e-16&#41;
</pre>


<p>We see that <span class="math">$x_4=x_5$</span>, so the algorithm has stabilized. We also see that <span class="math">$f(x_4)$</span> is basically <span class="math">$0$</span> &#40;Recall, <code>eps&#40;&#41;</code> is the machine precision, or the size of the difference between floating point values at <span class="math">$1.0$</span> is basically <span class="math">$10^{-16}$</span>, the size of <span class="math">$f(x_4)$</span>.&#41;</p>
<p>You can see in this case that the convergence happens quickly as soon as the algorithm gets close.</p>
<p>The approximate root is <span class="math">$x_4$</span>.  It is important to realize that the actual, <em>exact</em>, answer is not likely to be the value computed by Newton&#39;s method, which we call <code>xstar</code> at times. In most cases, the true answer will be irrational and <code>xstar</code> a floating point number, which ultimately can never be better than an approximation to an irrational number.</p>
<p>The above example iterated until it was clear the algorithm does not improve itself, as the values returned did not change. This need not be the case for every problem.</p>
<p>Rather, we can determine two ways that the number is close enough to the answer:</p>
<ul>
<li><p>The sequence of <code>x</code>&#39;s stop changing by much</p>
</li>
<li><p>the values <code>f&#40;x&#41;</code> get close enough to zero.</p>
</li>
</ul>
<p>In the above, the first one was used. In either case, rather than look for values to be equal &#40;e.g. <span class="math">$x_{n+1} = x_{n}$</span> or <span class="math">$f(x_n) = 0$</span>, we look at whether these two things are close enough to be so. That means for some tolerance, we stop when the change in the <code>x</code>&#39;s is smaller than the tolerance or <code>f&#40;x&#41;</code> is smaller – in absolute value – than the tolerance.</p>
<h3>Repeating steps</h3>
<p>The above approach – basically repeating steps – can be tedious. There will be a function to do this for you &#40;<code>newton</code>&#41;. One can use copy and paste to do much of this though:</p>


<pre class='hljl'>
<span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-oB'>^</span><span class='hljl-ni'>3</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-ni'>2</span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-ni'>5</span><span class='hljl-t'>
</span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>2</span><span class='hljl-t'>
</span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-oB'>/</span><span class='hljl-n'>f</span><span class='hljl-oB'>&#39;</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-oB'>/</span><span class='hljl-n'>f</span><span class='hljl-oB'>&#39;</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-oB'>/</span><span class='hljl-n'>f</span><span class='hljl-oB'>&#39;</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-oB'>/</span><span class='hljl-n'>f</span><span class='hljl-oB'>&#39;</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-oB'>/</span><span class='hljl-n'>f</span><span class='hljl-oB'>&#39;</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'>

</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>))</span>
</pre>


<pre class="output">
&#40;2.0945514815423265, -8.881784197001252e-16&#41;
</pre>


<div class="admonition note"><p class="admonition-title">Note</p><p>Newton looked at this same example in 1699 &#40;B.T. Polyak, <em>Newton&#39;s method and its use in optimization</em>, European Journal of Operational Research. 02/2007; 181&#40;3&#41;:1086-1096.&#41; though his technique was slightly different as he did not use the derivative, <em>per se</em>, but rather an approximation based on the fact that his function was a polynomial &#40;though identical to the derivative&#41;. Raphson &#40;1690&#41; proposed the general form, hence the usual name of Newton-Raphson method.</p>
</div>
<hr />
<h3>Practice</h3>
<h4>Question</h4>
<p>Using Newton&#39;s method to find <span class="math">$\sqrt{k}$</span> &#40;by solving for roots of <span class="math">$f(x) = x^2 - k$</span>&#41; is also referred to as the Babylonian method, due to its origins. The resulting method</p>
<p class="math">\[
x_{n+1} = \frac{1}{2}(x_n + \frac{k}{x_n})
\]</p>
<p>is described by the first-century <a href="http://en.wikipedia.org/wiki/Babylonian_method">Greek mathematician Hero of Alexandria</a>.</p>
<p>Let <span class="math">$k=15$</span> and <span class="math">$x_0$</span> be <span class="math">$4$</span>. What is the value of <span class="math">$x_3$</span>?</p>


<form class="mx-2 my-3" name='WeaveQuestion' data-id='WXvZHYUp' data-controltype=''>
  <div class='form-group '>
    <div class='controls'>
      <div class="form-floating input-group" id="controls_WXvZHYUp">
        <div style="padding-top: 5px">
    <div class="row">
  <span style="width:90%">
    <input id="WXvZHYUp" type="number" class="form-control" placeholder="Numeric answer">
  </span>
  <span style="width:10%">
  </span>
</div>

    
        </div>
      </div>
      <div id='WXvZHYUp_message' style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text='text/javascript'>
document.getElementById("WXvZHYUp").addEventListener("change", function() {
  var correct = (Math.abs(this.value - 3.8729833462074525) <= 0.0001);
  var msgBox = document.getElementById('WXvZHYUp_message');
    if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_WXvZHYUp")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_WXvZHYUp")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

});

</script>


<h4>Question</h4>
<p>The function <span class="math">$f(x) = \sin(x)$</span> has derivative <span class="math">$f'(x) = \cos(x)$</span>. Use Newton&#39;s method to solve <span class="math">$f(x) = 0$</span> starting at <span class="math">$3$</span>. Repeat 5 times. What value do you get for <code>x</code>?</p>


<form class="mx-2 my-3" name='WeaveQuestion' data-id='xKr1DdXM' data-controltype=''>
  <div class='form-group '>
    <div class='controls'>
      <div class="form-floating input-group" id="controls_xKr1DdXM">
        <div style="padding-top: 5px">
    <div class="row">
  <span style="width:90%">
    <input id="xKr1DdXM" type="number" class="form-control" placeholder="Numeric answer">
  </span>
  <span style="width:10%">
  </span>
</div>

    
        </div>
      </div>
      <div id='xKr1DdXM_message' style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text='text/javascript'>
document.getElementById("xKr1DdXM").addEventListener("change", function() {
  var correct = (Math.abs(this.value - 3.141592653589793) <= 1.0e-14);
  var msgBox = document.getElementById('xKr1DdXM_message');
    if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_xKr1DdXM")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_xKr1DdXM")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

});

</script>


<p>&#40;This can be used to compute <span class="math">$\pi$</span> numerically, as the convergence is very fast. Here it takes 4 steps to verify.&#41;</p>
<h4>Question</h4>
<p>Let <span class="math">$f(x) = x^2 - 3^x$</span>. This has derivative <span class="math">$2x - 3^x \cdot \log(3)$</span>. Starting with <span class="math">$x_0=0$</span>, what does Newton&#39;s method converge on?</p>


<form class="mx-2 my-3" name='WeaveQuestion' data-id='ddjdGDm3' data-controltype=''>
  <div class='form-group '>
    <div class='controls'>
      <div class="form-floating input-group" id="controls_ddjdGDm3">
        <div style="padding-top: 5px">
    <div class="row">
  <span style="width:90%">
    <input id="ddjdGDm3" type="number" class="form-control" placeholder="Numeric answer">
  </span>
  <span style="width:10%">
  </span>
</div>

    
        </div>
      </div>
      <div id='ddjdGDm3_message' style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text='text/javascript'>
document.getElementById("ddjdGDm3").addEventListener("change", function() {
  var correct = (Math.abs(this.value - -0.6860267245362514) <= 1.0e-14);
  var msgBox = document.getElementById('ddjdGDm3_message');
    if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_ddjdGDm3")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_ddjdGDm3")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

});

</script>


<h2>Implementing a Newton&#39;s method function</h2>
<p>For iterative algorithms it is better to repeat the expression until something happens – not a fixed number of times.  In this case, we need a criteria to decide if the algorithm has converged. We shall use the following:</p>
<ul>
<li><p>If the value of <span class="math">$|x_{n+1} - x_n| < tol$</span> the algorithm has converged</p>
</li>
<li><p>If the value of <span class="math">$|f(x_n)| < tol$</span> the algorithm has converged</p>
</li>
<li><p>If the above hasn&#39;t happened by <span class="math">$n=100$</span> the algorithm fails to converge</p>
</li>
</ul>
<p>This isn&#39;t perfect, but will be sufficient. &#40;Well, in fact no stopping rule can be perfect, but this one doesn&#39;t account for the relative size of the <span class="math">$x_n$</span>s which can be important.&#41;</p>
<p>The first two steps require a tolerance. We will use <code>1e-14</code> for this. This is about 100 times the machine precision, <code>eps&#40;&#41;</code>, which is sufficient when the answers are moderate in size. This is not very good if the answers are very large.</p>
<p>A basic algorithm is to repeat a step of Newton&#39;s method until the above occurs. We wrap this up in a function for reuse, and employ a <code>while</code> loop to repeat the update step until something happens:</p>


<pre class='hljl'>
<span class='hljl-k'>function</span><span class='hljl-t'> </span><span class='hljl-nf'>nm</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>fp</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'>
	 </span><span class='hljl-n'>xnew</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>xold</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>Inf</span><span class='hljl-t'>
	 </span><span class='hljl-n'>fn</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>fo</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>xnew</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>Inf</span><span class='hljl-t'>

	 </span><span class='hljl-n'>tol</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>1e-14</span><span class='hljl-t'>
	 </span><span class='hljl-n'>ctr</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-t'>

	 </span><span class='hljl-k'>while</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>ctr</span><span class='hljl-t'> </span><span class='hljl-oB'>&lt;</span><span class='hljl-t'> </span><span class='hljl-ni'>100</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>&amp;&amp;</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-nf'>abs</span><span class='hljl-p'>(</span><span class='hljl-n'>xnew</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-n'>xold</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>&gt;</span><span class='hljl-t'> </span><span class='hljl-n'>tol</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>&amp;&amp;</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-t'> </span><span class='hljl-nf'>abs</span><span class='hljl-p'>(</span><span class='hljl-n'>fn</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-n'>fo</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>&gt;</span><span class='hljl-t'> </span><span class='hljl-n'>tol</span><span class='hljl-t'> </span><span class='hljl-p'>)</span><span class='hljl-t'>
	   </span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>xnew</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>xnew</span><span class='hljl-p'>)</span><span class='hljl-oB'>/</span><span class='hljl-nf'>fp</span><span class='hljl-p'>(</span><span class='hljl-n'>xnew</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-cs'># update step</span><span class='hljl-t'>
	   </span><span class='hljl-n'>xnew</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>xold</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>xnew</span><span class='hljl-t'>
           </span><span class='hljl-n'>fn</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>fo</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>xnew</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>fn</span><span class='hljl-t'>
	   </span><span class='hljl-n'>ctr</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>ctr</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-t'>
	 </span><span class='hljl-k'>end</span><span class='hljl-t'>

	 </span><span class='hljl-k'>if</span><span class='hljl-t'> </span><span class='hljl-n'>ctr</span><span class='hljl-t'> </span><span class='hljl-oB'>==</span><span class='hljl-t'> </span><span class='hljl-ni'>100</span><span class='hljl-t'>
	    </span><span class='hljl-nf'>error</span><span class='hljl-p'>(</span><span class='hljl-s'>&quot;Did not converge in 100 steps&quot;</span><span class='hljl-p'>)</span><span class='hljl-t'>
         </span><span class='hljl-k'>else</span><span class='hljl-t'>
	   </span><span class='hljl-n'>xnew</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ctr</span><span class='hljl-t'>
         </span><span class='hljl-k'>end</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span>
</pre>


<pre class="output">
nm &#40;generic function with 1 method&#41;
</pre>


<p>Here we use the <code>nm</code> function to find a zero of this polynomial:</p>


<pre class='hljl'>
<span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-oB'>^</span><span class='hljl-ni'>3</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-ni'>5</span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-t'>
</span><span class='hljl-nf'>fp</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>3</span><span class='hljl-n'>x</span><span class='hljl-oB'>^</span><span class='hljl-ni'>2</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-ni'>5</span><span class='hljl-t'>
</span><span class='hljl-n'>xstar</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ctr</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>nm</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>fp</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-p'>)</span><span class='hljl-t'>	</span><span class='hljl-cs'># takes 6 steps</span>
</pre>


<pre class="output">
&#40;0.20163967572340466, 6&#41;
</pre>


<p>However, the <code>MTH229</code> package provides the <code>newton</code> function. So we shall use that in the sequel. To see the number of steps, the argument <code>verbose&#61;true</code> may be given.</p>
<hr />
<p>We revisit a problem from a previous project, finding zeroes of the function <span class="math">$f(x) = \exp(x) - x^4$</span>. We know from previous work that there are three of them. Let&#39;s find one near <span class="math">$x=2$</span>:</p>


<pre class='hljl'>
<span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>exp</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-oB'>^</span><span class='hljl-ni'>4</span><span class='hljl-t'>
</span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>2</span><span class='hljl-t'>
</span><span class='hljl-nf'>newton</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>2</span><span class='hljl-p'>)</span><span class='hljl-t'>  </span><span class='hljl-cs'># newton will use automatic differentiation for the derivative</span>
</pre>


<pre class="output">
1.4296118247255556
</pre>


<p>It took 8 steps and we are this close:</p>


<pre class='hljl'>
<span class='hljl-n'>xstar</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>xstar</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
&#40;0.20163967572340466, 1.2217539869961238&#41;
</pre>


<p>In this case, the answer is exact up to floating point round off.</p>
<h3>Practice</h3>
<h4>Question</h4>
<p>Repeat the problem of finding a root of <span class="math">$f(x) = \exp(x) - x^4$</span> starting at <span class="math">$x=2$</span>. &#40;<code>newton&#40;f, 2, verbose&#61;true&#41;</code>&#41;. How many iterations does it take with the default tolerances?</p>


<form class="mx-2 my-3" name='WeaveQuestion' data-id='F6Qy5BJx' data-controltype=''>
  <div class='form-group '>
    <div class='controls'>
      <div class="form-floating input-group" id="controls_F6Qy5BJx">
        <div style="padding-top: 5px">
    <div class="row">
  <span style="width:90%">
    <input id="F6Qy5BJx" type="number" class="form-control" placeholder="Numeric answer">
  </span>
  <span style="width:10%">
  </span>
</div>

    
        </div>
      </div>
      <div id='F6Qy5BJx_message' style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text='text/javascript'>
document.getElementById("F6Qy5BJx").addEventListener("change", function() {
  var correct = (Math.abs(this.value - 6) <= 0.1);
  var msgBox = document.getElementById('F6Qy5BJx_message');
    if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_F6Qy5BJx")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_F6Qy5BJx")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

});

</script>


<h4>Question</h4>
<p>If we repeat with <span class="math">$f(x) = \exp(x) - x^4$</span> but start now at <span class="math">$x=8$</span> where does the algorithm converge?</p>


<form class="mx-2 my-3" name='WeaveQuestion' data-id='2nhf9lEJ' data-controltype=''>
  <div class='form-group '>
    <div class='controls'>
      <div class="form-floating input-group" id="controls_2nhf9lEJ">
        <div style="padding-top: 5px">
    <div class="row">
  <span style="width:90%">
    <input id="2nhf9lEJ" type="number" class="form-control" placeholder="Numeric answer">
  </span>
  <span style="width:10%">
  </span>
</div>

    
        </div>
      </div>
      <div id='2nhf9lEJ_message' style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text='text/javascript'>
document.getElementById("2nhf9lEJ").addEventListener("change", function() {
  var correct = (Math.abs(this.value - NaN) <= 1.0e-6);
  var msgBox = document.getElementById('2nhf9lEJ_message');
    if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_2nhf9lEJ")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_2nhf9lEJ")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

});

</script>


<h4>Question</h4>
<p>Let <span class="math">$f(x) = \sin(x) - \cos(4\cdot x)$</span>.</p>
<p>Starting at <span class="math">$\pi/8$</span>, solve for the root returned by Newton&#39;s method</p>


<form class="mx-2 my-3" name='WeaveQuestion' data-id='FPy60zjZ' data-controltype=''>
  <div class='form-group '>
    <div class='controls'>
      <div class="form-floating input-group" id="controls_FPy60zjZ">
        <div style="padding-top: 5px">
    <div class="row">
  <span style="width:90%">
    <input id="FPy60zjZ" type="number" class="form-control" placeholder="Numeric answer">
  </span>
  <span style="width:10%">
  </span>
</div>

    
        </div>
      </div>
      <div id='FPy60zjZ_message' style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text='text/javascript'>
document.getElementById("FPy60zjZ").addEventListener("change", function() {
  var correct = (Math.abs(this.value - 0.3141592653589793) <= 0.001);
  var msgBox = document.getElementById('FPy60zjZ_message');
    if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_FPy60zjZ")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_FPy60zjZ")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

});

</script>


<h2>Numeric derivatives</h2>
<p>In order to use Newton&#39;s method we need to evaluate <span class="math">$f'(x)$</span>. We have used automatic differentiation above through <code>f&#39;&#40;x&#41;</code>. Automatic differentiation returns a numerically accurate value for the derivative.</p>
<p>However, Newton&#39;s method is actually fairly robust to using other related values to the derivative. That is the method will converge, though perhaps not as fast as with the derivative.</p>
<h3>The secant method</h3>
<p>The <a href="http://en.wikipedia.org/wiki/Secant_method">secant method</a> is perhaps the oldest numerical linear algebra tool dating back over <a href="http://scholarship.rice.edu/bitstream/handle/1911/20568/1442093.PDF?sequence&#61;1">3000 years</a> well before Newton&#39;s method. Rather than use the derivative at <span class="math">$x_i$</span> to compute <span class="math">$x_{i+1}$</span>, the secant line is used between <span class="math">$x_{i-1}$</span> and <span class="math">$x_i$</span>. This method will also converge to a zero with a good starting point, though not nearly as quickly as Newton&#39;s method.</p>
<p>You can check – if you want – by repeating the last command until the change in <code>x2</code> is within your tolerance:</p>


<pre class='hljl'>
<span class='hljl-n'>x2</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>x1</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>2</span><span class='hljl-t'>			</span><span class='hljl-cs'># initial guess of 2</span><span class='hljl-t'>
</span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-oB'>^</span><span class='hljl-ni'>2</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-ni'>2</span><span class='hljl-t'>			</span><span class='hljl-cs'># some function</span><span class='hljl-t'>
</span><span class='hljl-nf'>fp</span><span class='hljl-p'>(</span><span class='hljl-n'>x1</span><span class='hljl-p'>,</span><span class='hljl-n'>x2</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x1</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x2</span><span class='hljl-p'>))</span><span class='hljl-oB'>/</span><span class='hljl-p'>(</span><span class='hljl-n'>x1</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-n'>x2</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>x2</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>x1</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>x2</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x2</span><span class='hljl-p'>)</span><span class='hljl-oB'>/</span><span class='hljl-nf'>fp</span><span class='hljl-p'>(</span><span class='hljl-n'>x1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>x2</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>x2</span><span class='hljl-t'> </span><span class='hljl-cs'># update step</span>
</pre>


<pre class="output">
&#40;1.3333333333333333, 1&#41;
</pre>


<p>We can repeat via copy and paste:</p>


<pre class='hljl'>
<span class='hljl-n'>x2</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>x1</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>x2</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x2</span><span class='hljl-p'>)</span><span class='hljl-oB'>/</span><span class='hljl-nf'>fp</span><span class='hljl-p'>(</span><span class='hljl-n'>x1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>x2</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>x2</span><span class='hljl-t'>
</span><span class='hljl-n'>x2</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>x1</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>x2</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x2</span><span class='hljl-p'>)</span><span class='hljl-oB'>/</span><span class='hljl-nf'>fp</span><span class='hljl-p'>(</span><span class='hljl-n'>x1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>x2</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>x2</span><span class='hljl-t'>
</span><span class='hljl-n'>x2</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>x1</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>x2</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x2</span><span class='hljl-p'>)</span><span class='hljl-oB'>/</span><span class='hljl-nf'>fp</span><span class='hljl-p'>(</span><span class='hljl-n'>x1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>x2</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>x2</span><span class='hljl-t'>
</span><span class='hljl-n'>x2</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>x1</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>x2</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x2</span><span class='hljl-p'>)</span><span class='hljl-oB'>/</span><span class='hljl-nf'>fp</span><span class='hljl-p'>(</span><span class='hljl-n'>x1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>x2</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>x2</span><span class='hljl-t'>
</span><span class='hljl-n'>x2</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>x1</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>x2</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x2</span><span class='hljl-p'>)</span><span class='hljl-oB'>/</span><span class='hljl-nf'>fp</span><span class='hljl-p'>(</span><span class='hljl-n'>x1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>x2</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>x2</span><span class='hljl-t'>

</span><span class='hljl-n'>x2</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x2</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
&#40;1.4142135623730947, -8.881784197001252e-16&#41;
</pre>


<p>The last line shows the algorithm has basically converged, as the values agree to <span class="math">$10^{-14}$</span>. We have</p>
<h3>Using forward differences</h3>
<p>Recall the forward difference approximation to the derivative:</p>
<p class="math">\[
f'(x) \approx \frac{f(x + h) - f(x)}{h}
\]</p>
<p>For some small <span class="math">$h$</span> &#40;with <span class="math">$h=10^{-8}$</span> a reasonable choice for many functions&#41;. This can be used</p>
<p>One can also use approximate derivatives based on forward differences in place of <span class="math">$f'(x)$</span> in the formula. Again, this won&#39;t be as fast.</p>
<p>The update step <span class="math">$x - f(x)/f'(x)$</span> becomes</p>
<p class="math">\[
x - \frac{h \cdot f(x)}{f(x+h) - f(x)}.
\]</p>
<p>The issue with this approximation is when the estimated value gets close to the actual root, the value of <span class="math">$h$</span> becomes too large. Steffenson&#39;s method replaces <span class="math">$h$</span> with <span class="math">$f(x)$</span>, which for values close to a root gets quite small. This improves the convergence rate to be on par with Newton&#39;s method. In this case, the update step looks like</p>
<p class="math">\[
x - \frac{f(x)^2}{f(x+ f(x)) - f(x)}.
\]</p>
<h3>Problems</h3>
<h4>Question</h4>
<p>Use the secant method to find a root to <span class="math">$f(x) = \cos(x) - x^3$</span> starting with <span class="math">$x_0=1/2$</span> and <span class="math">$x_1=1$</span>.</p>


<form class="mx-2 my-3" name='WeaveQuestion' data-id='9qjbv7Po' data-controltype=''>
  <div class='form-group '>
    <div class='controls'>
      <div class="form-floating input-group" id="controls_9qjbv7Po">
        <div style="padding-top: 5px">
    <div class="row">
  <span style="width:90%">
    <input id="9qjbv7Po" type="number" class="form-control" placeholder="Numeric answer">
  </span>
  <span style="width:10%">
  </span>
</div>

    
        </div>
      </div>
      <div id='9qjbv7Po_message' style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text='text/javascript'>
document.getElementById("9qjbv7Po").addEventListener("change", function() {
  var correct = (Math.abs(this.value - 0.8654740331016144) <= 1.0e-10);
  var msgBox = document.getElementById('9qjbv7Po_message');
    if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_9qjbv7Po")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_9qjbv7Po")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

});

</script>


<h4>Question</h4>
<p>Use the secant method to find a root to <span class="math">$f(x) = x^5 + x - 1$</span> starting with <span class="math">$x_0=1/2$</span> and <span class="math">$x_1=1$</span>.</p>


<form class="mx-2 my-3" name='WeaveQuestion' data-id='TJCjwr9l' data-controltype=''>
  <div class='form-group '>
    <div class='controls'>
      <div class="form-floating input-group" id="controls_TJCjwr9l">
        <div style="padding-top: 5px">
    <div class="row">
  <span style="width:90%">
    <input id="TJCjwr9l" type="number" class="form-control" placeholder="Numeric answer">
  </span>
  <span style="width:10%">
  </span>
</div>

    
        </div>
      </div>
      <div id='TJCjwr9l_message' style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text='text/javascript'>
document.getElementById("TJCjwr9l").addEventListener("change", function() {
  var correct = (Math.abs(this.value - 0.7548776662466927) <= 1.0e-10);
  var msgBox = document.getElementById('TJCjwr9l_message');
    if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_TJCjwr9l")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_TJCjwr9l")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

});

</script>


<h2>The <code>find_zero</code> function</h2>
<p>There are also very fast algorithms which do not require a derivative. The <code>Roots</code> package provides an interface to these through the <code>find_zero</code> function.</p>
<p>The <code>find_zero</code> function has two interfaces:</p>
<ul>
<li><p>when called with a bracketing interval, as in <code>find_zero&#40;f, &#40;a,b&#41;&#41;</code>, it will use a bisection method to find a root.</p>
</li>
<li><p>when called with a starting point, as in <code>find_zero&#40;f, a&#41;</code>, it will use an iterative algorithm to search for a root.</p>
</li>
</ul>
<p>Many bracketing methods &#40;like bisection&#41; are guaranteed to converge, but can be slow. The iterative algorithm used by default with <code>find_zero</code> tries to speed the convergence up, but if along the way it finds a bracketing interval, that will guarantee convergence.</p>
<p>We focus on the simplest usage of <code>find_zero</code> where an initial guess is supplied and the default order is used. Here is an example to find <span class="math">$-\sqrt{2}$</span>:</p>


<pre class='hljl'>
<span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-oB'>^</span><span class='hljl-ni'>2</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-ni'>2</span><span class='hljl-t'>
</span><span class='hljl-nf'>find_zero</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
-1.414213562373095
</pre>


<h3>Using <code>find_zero</code> and a graph to find all roots.</h3>
<p>Let&#39;s look, again, at the task of finding all zeros to the function <span class="math">$e^x - x^4$</span>. We follow a standard approach:</p>
<ul>
<li><p>graph the function to roughly identify potential zeros</p>
</li>
<li><p>use these as starting points for <code>find_zero</code> to improve</p>
</li>
</ul>
<p>The following graph suggests, perhaps, there may be <span class="math">$3$</span> zeros, one near <span class="math">$9$</span>, one near <span class="math">$2$</span> and one near <span class="math">$-1$</span>.</p>


<pre class='hljl'>
<span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>exp</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-oB'>^</span><span class='hljl-ni'>4</span><span class='hljl-t'>
</span><span class='hljl-nf'>plot</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-ni'>5</span><span class='hljl-p'>,</span><span class='hljl-ni'>9</span><span class='hljl-p'>)</span>
</pre>



<script src="https://cdn.plot.ly/plotly-2.6.3.min.js"></script>    <div id="6a53fa72-2dca-4710-be0c-3df5639f8d09" style="width:576px;height:384px;"></div>
    <script>
    
        Plotly.newPlot('6a53fa72-2dca-4710-be0c-3df5639f8d09', [
    {
        "xaxis": "x",
        "colorbar": {
            "title": ""
        },
        "yaxis": "y",
        "x": [
            -5.0,
            -4.977213088953827,
            -4.954426177907655,
            -4.931639266861483,
            -4.90885235581531,
            -4.803503407975295,
            -4.69815446013528,
            -4.592805512295264,
            -4.487456564455249,
            -4.382107616615233,
            -4.2767586687752175,
            -4.171409720935202,
            -4.066060773095186,
            -3.9394401201082676,
            -3.8128194671213484,
            -3.6861988141344293,
            -3.5595781611475106,
            -3.345465859900182,
            -3.131353558652853,
            -2.8987675858388533,
            -2.666181613024853,
            -2.451757918684162,
            -2.2373342243434706,
            -2.007449362274783,
            -1.777564500206095,
            -1.5112203431898967,
            -1.2448761861736986,
            -0.7714856762971333,
            -0.35636485895794656,
            0.09622826211631494,
            0.5515112683595795,
            1.0548848511611064,
            1.533832113618539,
            1.7828291265289056,
            2.031826139439272,
            2.2414285868315798,
            2.451031034223888,
            2.70693186504831,
            2.9628326958727316,
            3.197254046017246,
            3.4316753961617605,
            3.648181603528976,
            3.864687810896191,
            4.084001889684814,
            4.303315968473436,
            4.426210767878793,
            4.549105567284149,
            4.672000366689506,
            4.794895166094863,
            4.906257694865642,
            5.0176202236364205,
            5.1289827524072,
            5.240345281177979,
            5.495350110695208,
            5.750354940212436,
            5.9864667351273635,
            6.222578530042291,
            6.455357092431437,
            6.688135654820583,
            6.801140014090681,
            6.914144373360779,
            7.027148732630877,
            7.140153091900976,
            7.198075050930976,
            7.255997009960975,
            7.313918968990974,
            7.371840928020974,
            7.429762887050973,
            7.487684846080972,
            7.545606805110971,
            7.603528764140971,
            7.666988994679702,
            7.730449225218434,
            7.793909455757166,
            7.857369686295899,
            7.889099801565265,
            7.920829916834631,
            7.952560032103997,
            7.984290147373363,
            8.01602026264273,
            8.047750377912095,
            8.07948049318146,
            8.111210608450827,
            8.157303804729931,
            8.203397001009037,
            8.249490197288143,
            8.295583393567249,
            8.341676589846355,
            8.387769786125459,
            8.410816384265011,
            8.433862982404563,
            8.456909580544115,
            8.479956178683668,
            8.503002776823221,
            8.526049374962774,
            8.549095973102325,
            8.572142571241878,
            8.595189169381431,
            8.618235767520982,
            8.641282365660535,
            8.664328963800088,
            8.687375561939641,
            8.710422160079194,
            8.733468758218747,
            8.7565153563583,
            8.779561954497852,
            8.802608552637405,
            8.825655150776957,
            8.84870174891651,
            8.867614030301947,
            8.886526311687383,
            8.90543859307282,
            8.924350874458256,
            8.943263155843692,
            8.962175437229128,
            8.981087718614564,
            9.0
        ],
        "showlegend": true,
        "mode": "lines",
        "name": "y1",
        "zmin": null,
        "legendgroup": "y1",
        "zmax": null,
        "line": {
            "color": "rgba(0, 154, 250, 1.000)",
            "shape": "linear",
            "dash": "solid",
            "width": 1
        },
        "y": [
            -624.9932620530009,
            -613.6773013580785,
            -602.5156940186796,
            -591.5070298242472,
            -580.6499050330475,
            -532.3848921790742,
            -487.1930012955847,
            -444.9409096479892,
            -405.4982495652575,
            -368.73760831499436,
            -334.534527964636,
            -302.7675052272255,
            -273.31799129005395,
            -240.82575134801345,
            -211.31950373626358,
            -184.61035358443723,
            -160.51556953815287,
            -125.22879472090553,
            -96.10172237116237,
            -70.55285615003082,
            -50.46160189225934,
            -36.04738426460105,
            -24.949933722498063,
            -16.105383867474767,
            -9.81487939505613,
            -4.995042165466734,
            -2.1136453474420436,
            0.10807437835932376,
            0.6840891313009364,
            1.1009246089178757,
            1.6433582565971854,
            1.6333605792942345,
            -0.8990112995071771,
            -4.156076681461426,
            -9.415001612466853,
            -15.833837133306748,
            -24.490393755731482,
            -38.7087306027469,
            -57.70719846390766,
            -80.03288792400286,
            -107.75508661146168,
            -138.73080947954085,
            -175.39009407078396,
            -218.8087861932163,
            -268.9913057773001,
            -300.20668893881304,
            -333.7087924970519,
            -369.5321821964031,
            -407.69527715433264,
            -444.29783323372345,
            -482.80538500986415,
            -523.1847788948551,
            -565.3832727311991,
            -668.4151376834445,
            -779.0966421115977,
            -886.3408974160986,
            -995.2747072825501,
            -1100.4243469812186,
            -1198.052429300475,
            -1240.7003543809394,
            -1278.9459958374719,
            -1311.6521359395513,
            -1337.5210033220458,
            -1347.6579103880626,
            -1355.3944336097766,
            -1360.496747761676,
            -1362.7153442815377,
            -1361.7840799281278,
            -1357.4191687081736,
            -1349.3181136896285,
            -1337.1585751165023,
            -1318.7698787244044,
            -1294.6144128287879,
            -1264.175455930891,
            -1226.8997278933507,
            -1205.5145856356721,
            -1182.1949692219591,
            -1156.8603325529402,
            -1129.4273617489557,
            -1099.809885135524,
            -1067.9187803269415,
            -1033.6618783143504,
            -996.9438644617267,
            -939.0177310919585,
            -875.3745968459452,
            -805.683978898965,
            -729.5990062846436,
            -646.7556417232981,
            -556.7718667423687,
            -508.97781866023706,
            -459.24682835734075,
            -407.5256997221477,
            -353.75994549991174,
            -297.89375703280984,
            -239.8699732945979,
            -179.63004920334424,
            -117.11402319537501,
            -52.26048404326957,
            14.993463099788642,
            84.71223144731721,
            156.96178813689403,
            231.80969061658016,
            309.3251238796056,
            389.578938567186,
            472.6436899596665,
            558.5936778767091,
            647.5049875077284,
            739.455531194254,
            834.5250911864377,
            914.927415304076,
            997.5311967624039,
            1082.3834689481437,
            1169.532187665929,
            1259.0262488079616,
            1350.9155063610187,
            1445.25079075726,
            1542.0839275753842
        ],
        "type": "scatter"
    }
]
, {
    "showlegend": true,
    "xaxis": {
        "showticklabels": true,
        "gridwidth": 0.5,
        "tickvals": [
            -4.0,
            -2.0,
            0.0,
            2.0,
            4.0,
            6.0,
            8.0
        ],
        "range": [
            -5.42,
            9.42
        ],
        "domain": [
            0.08399557694177116,
            0.9931649168853893
        ],
        "mirror": false,
        "tickangle": 0,
        "showline": true,
        "ticktext": [
            "−4",
            "−2",
            "0",
            "2",
            "4",
            "6",
            "8"
        ],
        "zeroline": false,
        "tickfont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 11
        },
        "zerolinecolor": "rgba(0, 0, 0, 1.000)",
        "anchor": "y",
        "visible": true,
        "ticks": "inside",
        "tickmode": "array",
        "linecolor": "rgba(0, 0, 0, 1.000)",
        "showgrid": true,
        "title": "",
        "gridcolor": "rgba(0, 0, 0, 0.100)",
        "titlefont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 15
        },
        "tickcolor": "rgb(0, 0, 0)",
        "type": "-"
    },
    "paper_bgcolor": "rgba(255, 255, 255, 1.000)",
    "annotations": [],
    "height": 384,
    "margin": {
        "l": 0,
        "b": 20,
        "r": 0,
        "t": 20
    },
    "plot_bgcolor": "rgba(255, 255, 255, 1.000)",
    "yaxis": {
        "showticklabels": true,
        "gridwidth": 0.5,
        "tickvals": [
            -1000.0,
            -500.0,
            0.0,
            500.0,
            1000.0,
            1500.0
        ],
        "range": [
            -1449.8593224372453,
            1629.2279057310918
        ],
        "domain": [
            0.0391878098571012,
            0.989747375328084
        ],
        "mirror": false,
        "tickangle": 0,
        "showline": true,
        "ticktext": [
            "−1000",
            "−500",
            "0",
            "500",
            "1000",
            "1500"
        ],
        "zeroline": false,
        "tickfont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 11
        },
        "zerolinecolor": "rgba(0, 0, 0, 1.000)",
        "anchor": "x",
        "visible": true,
        "ticks": "inside",
        "tickmode": "array",
        "linecolor": "rgba(0, 0, 0, 1.000)",
        "showgrid": true,
        "title": "",
        "gridcolor": "rgba(0, 0, 0, 0.100)",
        "titlefont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 15
        },
        "tickcolor": "rgb(0, 0, 0)",
        "type": "-"
    },
    "legend_position": {
        "yanchor": "auto",
        "xanchor": "auto",
        "bordercolor": "rgba(0, 0, 0, 1.000)",
        "bgcolor": "rgba(255, 255, 255, 1.000)",
        "borderwidth": 1,
        "tracegroupgap": 0,
        "y": 1.0,
        "font": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 11
        },
        "title": {
            "font": {
                "color": "rgba(0, 0, 0, 1.000)",
                "family": "sans-serif",
                "size": 15
            },
            "text": ""
        },
        "traceorder": "normal",
        "x": 1.0
    },
    "width": 576
}
);

    
    </script>


<p>We can improve these guesses with</p>


<pre class='hljl'>
<span class='hljl-nf'>find_zero</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>9</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-nf'>find_zero</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>2</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-nf'>find_zero</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
&#40;8.6131694564414, 1.4296118247255556, -0.8155534188089607&#41;
</pre>


<p>The above can be written without repeating <code>find_zero</code> by using a comprehension:</p>


<pre class='hljl'>
<span class='hljl-p'>[</span><span class='hljl-nf'>find_zero</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-k'>for</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-kp'>in</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-ni'>9</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>2</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-ni'>1</span><span class='hljl-p'>]]</span>
</pre>


<pre class="output">
3-element Vector&#123;Float64&#125;:
  8.6131694564414
  1.4296118247255556
 -0.8155534188089607
</pre>


<p>Or even more compactly, using the broadcast notation:</p>


<pre class='hljl'>
<span class='hljl-n'>find_zero</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-oB'>-</span><span class='hljl-ni'>1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>2</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>9</span><span class='hljl-p'>])</span>
</pre>


<pre class="output">
3-element Vector&#123;Float64&#125;:
 -0.8155534188089607
  1.4296118247255556
  8.6131694564414
</pre>


<hr />
<p>As another illustration, let <span class="math">$f(x) = \cos^2(x^2)$</span> on <span class="math">$[-1,2]$</span>. Find all the zeros of the derivative of <span class="math">$f(x)$</span>.</p>
<p>We graph the derivative to identify starting points:</p>


<pre class='hljl'>
<span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>cos</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-oB'>^</span><span class='hljl-ni'>2</span><span class='hljl-p'>)</span><span class='hljl-oB'>^</span><span class='hljl-ni'>2</span><span class='hljl-t'>
</span><span class='hljl-nf'>plot</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-oB'>&#39;</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-ni'>1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>2</span><span class='hljl-p'>)</span>
</pre>



<script src="https://cdn.plot.ly/plotly-2.6.3.min.js"></script>    <div id="2ba76c8f-7f07-4d4d-bd49-781adf388435" style="width:576px;height:384px;"></div>
    <script>
    
        Plotly.newPlot('2ba76c8f-7f07-4d4d-bd49-781adf388435', [
    {
        "xaxis": "x",
        "colorbar": {
            "title": ""
        },
        "yaxis": "y",
        "x": [
            -1.0,
            -0.9951170904901059,
            -0.9902341809802119,
            -0.9853512714703179,
            -0.9804683619604238,
            -0.9578935874232776,
            -0.9353188128861314,
            -0.9127440383489852,
            -0.890169263811839,
            -0.8675944892746928,
            -0.8450197147375467,
            -0.8224449402004006,
            -0.7998701656632544,
            -0.7727371685946289,
            -0.7456041715260033,
            -0.7184711744573777,
            -0.6913381773887523,
            -0.6454569699786104,
            -0.5995757625684686,
            -0.5497359112511828,
            -0.49989605993389713,
            -0.4769220926831088,
            -0.45394812543232044,
            -0.43097415818153206,
            -0.4080001909307437,
            -0.3833696699948128,
            -0.358739149058882,
            -0.33410862812295117,
            -0.3094781071870203,
            -0.28094123322099906,
            -0.25240435925497784,
            -0.22386748528895664,
            -0.19533061132293544,
            -0.09388978777795712,
            -0.004935326919559979,
            0.09204891331063893,
            0.1896095575056242,
            0.21657599944142028,
            0.24354244137721637,
            0.2705088833130125,
            0.29747532524880854,
            0.32313321430902814,
            0.34879110336924773,
            0.37444899242946733,
            0.4001068814896869,
            0.4267851328729405,
            0.45346338425619404,
            0.48014163563944756,
            0.5068198870227011,
            0.5292772921004484,
            0.5517346971781957,
            0.574192102255943,
            0.5966495073336903,
            0.7063212919727282,
            0.8067875848918058,
            0.8299846785382932,
            0.8531817721847805,
            0.8763788658312679,
            0.8995759594777553,
            0.9230738964908219,
            0.9465718335038886,
            0.9583208020104219,
            0.9700697705169553,
            0.9818187390234887,
            0.993567707530022,
            1.0067350074663102,
            1.0199023074025986,
            1.0330696073388868,
            1.046236907275175,
            1.0594042072114631,
            1.0725715071477513,
            1.0857388070840397,
            1.0989061070203279,
            1.1108378065314826,
            1.1227695060426375,
            1.1347012055537924,
            1.1466329050649473,
            1.1585646045761022,
            1.1704963040872571,
            1.182428003598412,
            1.194359703109567,
            1.2080206761194185,
            1.2216816491292701,
            1.2353426221391217,
            1.249003595148973,
            1.276325541168676,
            1.3036474871883792,
            1.3289451795006928,
            1.3542428718130064,
            1.3795405641253202,
            1.4048382564376338,
            1.4173085365656237,
            1.4297788166936138,
            1.4422490968216037,
            1.4547193769495936,
            1.4671896570775835,
            1.4796599372055734,
            1.4921302173335635,
            1.5046004974615534,
            1.5167081073833497,
            1.528815717305146,
            1.5409233272269423,
            1.5530309371487385,
            1.5651385470705348,
            1.577246156992331,
            1.5832999619532293,
            1.5893537669141273,
            1.5954075718750254,
            1.6014613768359236,
            1.6076673010177092,
            1.613873225199495,
            1.6200791493812805,
            1.626285073563066,
            1.6324909977448518,
            1.6386969219266374,
            1.644902846108423,
            1.6511087702902087,
            1.6573146944719943,
            1.6635206186537799,
            1.6697265428355657,
            1.6759324670173512,
            1.6883443153809226,
            1.7007561637444937,
            1.7075554741593577,
            1.714354784574222,
            1.7211540949890862,
            1.7279534054039503,
            1.7415520262336786,
            1.7551506470634068,
            1.7823478887228634,
            1.8095451303823202,
            1.8292993573590794,
            1.8490535843358389,
            1.8589306978242186,
            1.8688078113125983,
            1.878684924800978,
            1.8885620382893578,
            1.8984391517777375,
            1.9083162652661172,
            1.9181933787544967,
            1.9280704922428764,
            1.9330090489870662,
            1.9379476057312561,
            1.9428861624754459,
            1.9478247192196356,
            1.9527632759638256,
            1.9577018327080153,
            1.962640389452205,
            1.967578946196395,
            1.9716315779218456,
            1.9756842096472962,
            1.979736841372747,
            1.9837894730981975,
            1.987842104823648,
            1.9918947365490989,
            1.9959473682745494,
            2.0
        ],
        "showlegend": true,
        "mode": "lines",
        "name": "y1",
        "zmin": null,
        "legendgroup": "y1",
        "zmax": null,
        "line": {
            "color": "rgba(0, 154, 250, 1.000)",
            "shape": "linear",
            "dash": "solid",
            "width": 1
        },
        "y": [
            1.8185948536513636,
            1.8255074907316338,
            1.831503698402216,
            1.836599214837022,
            1.8408100535133547,
            1.8492506432532123,
            1.840800199277721,
            1.8171861226831896,
            1.780163900000359,
            1.7314844563167713,
            1.672866109197317,
            1.6059710170684782,
            1.5323859294518698,
            1.4371960320263928,
            1.3368985371557642,
            1.2336623306290597,
            1.129413599194958,
            0.9554143959561401,
            0.7897841405356245,
            0.6248124928405567,
            0.4791434901095381,
            0.41910091480729095,
            0.36367512744563935,
            0.31288077755522725,
            0.26667866936155643,
            0.22214730219468407,
            0.1826377140000548,
            0.1479480482097269,
            0.11783942774121517,
            0.08832858697063249,
            0.06414677004444062,
            0.04480284623243541,
            0.029781691453885983,
            0.0033104921634235884,
            4.808479501094209e-7,
            -0.0031195733574711703,
            -0.02724371791808789,
            -0.040574557623385216,
            -0.05764543318600161,
            -0.07889566942737697,
            -0.10474739397446818,
            -0.13398111655284997,
            -0.16805934338035783,
            -0.20726740526068366,
            -0.2518504028406295,
            -0.3041159925472902,
            -0.3625556072036511,
            -0.4272380962202539,
            -0.4981346314394562,
            -0.5625307352174344,
            -0.6310761398822473,
            -0.7035430269883526,
            -0.77962402332925,
            -1.1870000383685897,
            -1.5555533000151853,
            -1.6291340771352978,
            -1.6951008566344439,
            -1.751701595309327,
            -1.797107441701249,
            -1.8297615986097415,
            -1.8470169174258764,
            -1.849253079226398,
            -1.8469042577364978,
            -1.8397331075075525,
            -1.8275086486100143,
            -1.8075279954472245,
            -1.7806213649290594,
            -1.746508160059974,
            -1.704929699174946,
            -1.6556526928808462,
            -1.5984728338144472,
            -1.533218478935298,
            -1.4597544010384103,
            -1.386013458140786,
            -1.3054131066537444,
            -1.2179457314706974,
            -1.1236380001154773,
            -1.0225531015966518,
            -0.9147929159772462,
            -0.8005000923550356,
            -0.6798600116296164,
            -0.5342397691596602,
            -0.38102175582330816,
            -0.22070786349559685,
            -0.053884560526387515,
            0.296511624844487,
            0.6637336863633604,
            1.0119688296219875,
            1.3607024355139221,
            1.7018032842712985,
            2.0263685868502543,
            2.1773886110001244,
            2.320911565089381,
            2.4557461621272116,
            2.5806949544627873,
            2.6945634185852523,
            2.7961697045894116,
            2.8843550109619085,
            2.957994535004981,
            3.0145519555262807,
            3.055443332836141,
            3.0797939399757572,
            3.086801423604273,
            3.075746752048943,
            3.046005207809567,
            3.0239601168340555,
            2.997057320738826,
            2.9652500965926207,
            2.9284996296574577,
            2.8856626177172613,
            2.8375750733792326,
            2.784223131498175,
            2.7256030278723506,
            2.6617214172881756,
            2.5925956776133376,
            2.5182541985862366,
            2.4387366539348068,
            2.3540942554462787,
            2.2643899876017572,
            2.169698821385775,
            2.0701079058812875,
            1.8566372968292781,
            1.6249246636616352,
            1.490662419760057,
            1.3514821462146425,
            1.2076171995814287,
            1.059319288492618,
            0.7505223790027195,
            0.4274659753896859,
            -0.25054353651057304,
            -0.9503942830384066,
            -1.456629975741615,
            -1.9481050427367124,
            -2.1845305391682093,
            -2.4126942743330373,
            -2.6310476992418472,
            -2.838047811115071,
            -3.0321678583117304,
            -3.2119084857010303,
            -3.37580925864061,
            -3.522460496471568,
            -3.5888938586515797,
            -3.650515339292664,
            -3.7071684012482855,
            -3.7587019648110647,
            -3.8049707913087456,
            -3.845835865365859,
            -3.881164775021054,
            -3.9108320888688404,
            -3.9308649819053834,
            -3.946944310300248,
            -3.959012329957917,
            -3.9670150675378166,
            -3.9709024516800064,
            -3.9706284418394184,
            -3.966151154494449,
            -3.957432986493527
        ],
        "type": "scatter"
    }
]
, {
    "showlegend": true,
    "xaxis": {
        "showticklabels": true,
        "gridwidth": 0.5,
        "tickvals": [
            -1.0,
            0.0,
            1.0,
            2.0
        ],
        "range": [
            -1.09,
            2.09
        ],
        "domain": [
            0.03769928064547487,
            0.9931649168853894
        ],
        "mirror": false,
        "tickangle": 0,
        "showline": true,
        "ticktext": [
            "−1",
            "0",
            "1",
            "2"
        ],
        "zeroline": false,
        "tickfont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 11
        },
        "zerolinecolor": "rgba(0, 0, 0, 1.000)",
        "anchor": "y",
        "visible": true,
        "ticks": "inside",
        "tickmode": "array",
        "linecolor": "rgba(0, 0, 0, 1.000)",
        "showgrid": true,
        "title": "",
        "gridcolor": "rgba(0, 0, 0, 0.100)",
        "titlefont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 15
        },
        "tickcolor": "rgb(0, 0, 0)",
        "type": "-"
    },
    "paper_bgcolor": "rgba(255, 255, 255, 1.000)",
    "annotations": [],
    "height": 384,
    "margin": {
        "l": 0,
        "b": 20,
        "r": 0,
        "t": 20
    },
    "plot_bgcolor": "rgba(255, 255, 255, 1.000)",
    "yaxis": {
        "showticklabels": true,
        "gridwidth": 0.5,
        "tickvals": [
            -4.0,
            -2.0,
            0.0,
            2.0
        ],
        "range": [
            -4.1826335679385345,
            3.2985325398628014
        ],
        "domain": [
            0.0391878098571012,
            0.989747375328084
        ],
        "mirror": false,
        "tickangle": 0,
        "showline": true,
        "ticktext": [
            "−4",
            "−2",
            "0",
            "2"
        ],
        "zeroline": false,
        "tickfont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 11
        },
        "zerolinecolor": "rgba(0, 0, 0, 1.000)",
        "anchor": "x",
        "visible": true,
        "ticks": "inside",
        "tickmode": "array",
        "linecolor": "rgba(0, 0, 0, 1.000)",
        "showgrid": true,
        "title": "",
        "gridcolor": "rgba(0, 0, 0, 0.100)",
        "titlefont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 15
        },
        "tickcolor": "rgb(0, 0, 0)",
        "type": "-"
    },
    "legend_position": {
        "yanchor": "auto",
        "xanchor": "auto",
        "bordercolor": "rgba(0, 0, 0, 1.000)",
        "bgcolor": "rgba(255, 255, 255, 1.000)",
        "borderwidth": 1,
        "tracegroupgap": 0,
        "y": 1.0,
        "font": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 11
        },
        "title": {
            "font": {
                "color": "rgba(0, 0, 0, 1.000)",
                "family": "sans-serif",
                "size": 15
            },
            "text": ""
        },
        "traceorder": "normal",
        "x": 1.0
    },
    "width": 576
}
);

    
    </script>


<p>We see there are 3 potential zeros, one near 0, one near 1.2 and close to 1.7. Here we improve our guesses:</p>


<pre class='hljl'>
<span class='hljl-n'>xs</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>find_zero</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-oB'>&#39;</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-nfB'>1.2</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-nfB'>1.7</span><span class='hljl-p'>])</span><span class='hljl-t'>   </span><span class='hljl-cs'># or [find_zero(f&#39;, x) for x in [0, 1.2, 1.7]]</span>
</pre>


<pre class="output">
3-element Vector&#123;Float64&#125;:
 0.0
 1.2533141373155003
 1.772453850905516
</pre>


<p>The function values at these points can be found with</p>


<pre class='hljl'>
<span class='hljl-n'>f</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>xs</span><span class='hljl-p'>)</span><span class='hljl-t'>               </span><span class='hljl-cs'># or map(f, xs) or [f(x) for x in xs]</span>
</pre>


<pre class="output">
3-element Vector&#123;Float64&#125;:
 1.0
 2.5860584564030066e-32
 1.0
</pre>


<h5>find_zeros</h5>
<p>For such tasks, <code>find_zeros</code> also works well. This function looks for all zeros in the interval <code>&#91;a,b&#93;</code>:</p>


<pre class='hljl'>
<span class='hljl-nf'>find_zeros</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-ni'>1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>2</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
1-element Vector&#123;Float64&#125;:
 1.2533141373155003
</pre>


<h3>Practice</h3>
<h4>Question</h4>
<p>Let</p>
<p class="math">\[
f(x) = 4x^4 -5x^3 + 4x^2 -20x - 6
\]</p>
<p>Apply Newton&#39;s method with <span class="math">$x_0=0$</span> using an automatic derivative. What value does it converge to?</p>


<form class="mx-2 my-3" name='WeaveQuestion' data-id='kJ2HkAYg' data-controltype=''>
  <div class='form-group '>
    <div class='controls'>
      <div class="form-floating input-group" id="controls_kJ2HkAYg">
        <div style="padding-top: 5px">
    <div class="row">
  <span style="width:90%">
    <input id="kJ2HkAYg" type="number" class="form-control" placeholder="Numeric answer">
  </span>
  <span style="width:10%">
  </span>
</div>

    
        </div>
      </div>
      <div id='kJ2HkAYg_message' style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text='text/javascript'>
document.getElementById("kJ2HkAYg").addEventListener("change", function() {
  var correct = (Math.abs(this.value - -0.27798094871260326) <= 1.0e-10);
  var msgBox = document.getElementById('kJ2HkAYg_message');
    if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_kJ2HkAYg")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_kJ2HkAYg")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

});

</script>


<h4>Question</h4>
<p>Let&#39;s try with a function where the derivative is not known easily. If we set</p>
<p class="math">\[
f(x) = x^x - 2
\]</p>
<p>Can we find a root using Newton&#39;s method, where <span class="math">$x > 0$</span>?</p>
<p>We graph the function to see, using a smallish interval at first:</p>


<pre class='hljl'>
<span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-oB'>^</span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-ni'>2</span><span class='hljl-t'>
</span><span class='hljl-nf'>plot</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>2</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>plot!</span><span class='hljl-p'>(</span><span class='hljl-n'>zero</span><span class='hljl-p'>)</span>
</pre>



<script src="https://cdn.plot.ly/plotly-2.6.3.min.js"></script>    <div id="8fac4774-c889-427d-85c6-2329866fb41e" style="width:576px;height:384px;"></div>
    <script>
    
        Plotly.newPlot('8fac4774-c889-427d-85c6-2329866fb41e', [
    {
        "xaxis": "x",
        "colorbar": {
            "title": ""
        },
        "yaxis": "y",
        "x": [
            0.0,
            0.0032552730065960435,
            0.006510546013192087,
            0.009765819019788131,
            0.013021092026384174,
            0.028070941717814955,
            0.04312079140924574,
            0.058170641100676525,
            0.07322049079210731,
            0.10332019017496888,
            0.13341988955783043,
            0.15150855427024745,
            0.16959721898266447,
            0.1876858836950815,
            0.2057745484074985,
            0.23636202001425977,
            0.266949491621021,
            0.33340262671073523,
            0.39466653937950424,
            0.4603479285419865,
            0.536446259118043,
            0.6040734748146952,
            0.6633764487202933,
            0.7280326088737592,
            0.7930730383370829,
            0.8649835501658724,
            0.9334045876597913,
            0.9689755895041294,
            1.0045465913484675,
            1.034489798118797,
            1.0644330048891268,
            1.1009902664354727,
            1.1375475279818188,
            1.171036292288178,
            1.2045250565945371,
            1.2354545147898537,
            1.26638397298517,
            1.297714555669259,
            1.329045138353348,
            1.3641579381834499,
            1.3992707380135518,
            1.4310886033766317,
            1.4629064687397113,
            1.4993357300993155,
            1.5357649914589195,
            1.569495247875338,
            1.603225504291756,
            1.6364795846330624,
            1.669733664974369,
            1.7020206247658258,
            1.7343075845572824,
            1.7508567157087107,
            1.767405846860139,
            1.7839549780115673,
            1.8005041091629959,
            1.8186356036026337,
            1.8367670980422712,
            1.854898592481909,
            1.8730300869215468,
            1.8993690562238927,
            1.9257080255262384,
            1.9520469948285841,
            1.97838596413093,
            1.9837894730981975,
            1.989192982065465,
            1.9945964910327325,
            2.0
        ],
        "showlegend": true,
        "mode": "lines",
        "name": "y1",
        "zmin": null,
        "legendgroup": "y1",
        "zmax": null,
        "line": {
            "color": "rgba(0, 154, 250, 1.000)",
            "shape": "linear",
            "dash": "solid",
            "width": 1
        },
        "y": [
            -1.0,
            -1.018471774554126,
            -1.0322449292701017,
            -1.0441981677665488,
            -1.0549590002296656,
            -1.0954322247062043,
            -1.1267740949494707,
            -1.1524954645626044,
            -1.1742133752249955,
            -1.2090565624511105,
            -1.235659229181644,
            -1.248672615988137,
            -1.25986394830012,
            -1.2694778820412282,
            -1.2777068796511815,
            -1.288888735673651,
            -1.297112954220501,
            -1.3066434585010989,
            -1.3071398032837505,
            -1.3003152199742183,
            -1.284012643697211,
            -1.2624998137903805,
            -1.2383423396690278,
            -1.206327540394191,
            -1.1679527257038589,
            -1.1179101495023,
            -1.06230168331897,
            -1.0300765206816445,
            -0.9954326900236277,
            -0.9642996662370744,
            -0.931275789393776,
            -0.8882600703085095,
            -0.8421080772200686,
            -0.7969092880054272,
            -0.7487482363833415,
            -0.701482562037639,
            -0.6513874842835301,
            -0.5975923764569699,
            -0.5405477881705487,
            -0.47251593215256116,
            -0.3998671087285015,
            -0.32978420182632595,
            -0.2553979647012805,
            -0.16459677024700348,
            -0.06735962284197661,
            0.028824111984929512,
            0.1313392943996048,
            0.23903208181968294,
            0.3537564927489627,
            0.4723325383679753,
            0.5984732446333179,
            0.6662259907876233,
            0.7361732986063494,
            0.808390799743131,
            0.8829569472087226,
            0.9674455447022519,
            1.0549623830371897,
            1.1456232690951276,
            1.2395487781314207,
            1.3820653426722784,
            1.5321415130448366,
            1.6902063896934387,
            1.856715181285932,
            1.891962101398427,
            1.9275889536518056,
            1.9636001109974774,
            2.0
        ],
        "type": "scatter"
    },
    {
        "xaxis": "x",
        "colorbar": {
            "title": ""
        },
        "yaxis": "y",
        "x": [
            0.0,
            0.013021092026384174,
            0.13341988955783043,
            0.2057745484074985,
            0.266949491621021,
            0.33340262671073523,
            0.39466653937950424,
            0.4603479285419865,
            0.536446259118043,
            0.6040734748146952,
            0.6633764487202933,
            0.7280326088737592,
            0.7930730383370829,
            0.8649835501658724,
            0.9334045876597913,
            1.0045465913484675,
            1.0644330048891268,
            1.1375475279818188,
            1.2045250565945371,
            1.26638397298517,
            1.329045138353348,
            1.3992707380135518,
            1.4629064687397113,
            1.5357649914589195,
            1.603225504291756,
            1.669733664974369,
            1.7343075845572824,
            1.8005041091629959,
            1.8730300869215468,
            1.97838596413093,
            2.0
        ],
        "showlegend": true,
        "mode": "lines",
        "name": "y2",
        "zmin": null,
        "legendgroup": "y2",
        "zmax": null,
        "line": {
            "color": "rgba(227, 111, 71, 1.000)",
            "shape": "linear",
            "dash": "solid",
            "width": 1
        },
        "y": [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
        ],
        "type": "scatter"
    }
]
, {
    "showlegend": true,
    "xaxis": {
        "showticklabels": true,
        "gridwidth": 0.5,
        "tickvals": [
            0.0,
            0.5,
            1.0,
            1.5,
            2.0
        ],
        "range": [
            -0.06,
            2.06
        ],
        "domain": [
            0.03769928064547487,
            0.9931649168853894
        ],
        "mirror": false,
        "tickangle": 0,
        "showline": true,
        "ticktext": [
            "0.0",
            "0.5",
            "1.0",
            "1.5",
            "2.0"
        ],
        "zeroline": false,
        "tickfont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 11
        },
        "zerolinecolor": "rgba(0, 0, 0, 1.000)",
        "anchor": "y",
        "visible": true,
        "ticks": "inside",
        "tickmode": "array",
        "linecolor": "rgba(0, 0, 0, 1.000)",
        "showgrid": true,
        "title": "",
        "gridcolor": "rgba(0, 0, 0, 0.100)",
        "titlefont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 15
        },
        "tickcolor": "rgb(0, 0, 0)",
        "type": "-"
    },
    "paper_bgcolor": "rgba(255, 255, 255, 1.000)",
    "annotations": [],
    "height": 384,
    "margin": {
        "l": 0,
        "b": 20,
        "r": 0,
        "t": 20
    },
    "plot_bgcolor": "rgba(255, 255, 255, 1.000)",
    "yaxis": {
        "showticklabels": true,
        "gridwidth": 0.5,
        "tickvals": [
            -1.0,
            0.0,
            1.0,
            2.0
        ],
        "range": [
            -1.406353997382263,
            2.0992141940985123
        ],
        "domain": [
            0.0391878098571012,
            0.989747375328084
        ],
        "mirror": false,
        "tickangle": 0,
        "showline": true,
        "ticktext": [
            "−1",
            "0",
            "1",
            "2"
        ],
        "zeroline": false,
        "tickfont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 11
        },
        "zerolinecolor": "rgba(0, 0, 0, 1.000)",
        "anchor": "x",
        "visible": true,
        "ticks": "inside",
        "tickmode": "array",
        "linecolor": "rgba(0, 0, 0, 1.000)",
        "showgrid": true,
        "title": "",
        "gridcolor": "rgba(0, 0, 0, 0.100)",
        "titlefont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 15
        },
        "tickcolor": "rgb(0, 0, 0)",
        "type": "-"
    },
    "legend_position": {
        "yanchor": "auto",
        "xanchor": "auto",
        "bordercolor": "rgba(0, 0, 0, 1.000)",
        "bgcolor": "rgba(255, 255, 255, 1.000)",
        "borderwidth": 1,
        "tracegroupgap": 0,
        "y": 1.0,
        "font": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 11
        },
        "title": {
            "font": {
                "color": "rgba(0, 0, 0, 1.000)",
                "family": "sans-serif",
                "size": 15
            },
            "text": ""
        },
        "traceorder": "normal",
        "x": 1.0
    },
    "width": 576
}
);

    
    </script>


<p>Eyeing this, we pick an initial point, <span class="math">$1$</span>, for Newton&#39;s method &#40;<code>newton&#40;f, 1&#41;</code>&#41; to the right of the minimum, which appears to be around <span class="math">$x=0.35$</span>.</p>
<p>What is the value of the approximate zero?</p>


<form class="mx-2 my-3" name='WeaveQuestion' data-id='ACHFNtME' data-controltype=''>
  <div class='form-group '>
    <div class='controls'>
      <div class="form-floating input-group" id="controls_ACHFNtME">
        <div style="padding-top: 5px">
    <div class="row">
  <span style="width:90%">
    <input id="ACHFNtME" type="number" class="form-control" placeholder="Numeric answer">
  </span>
  <span style="width:10%">
  </span>
</div>

    
        </div>
      </div>
      <div id='ACHFNtME_message' style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text='text/javascript'>
document.getElementById("ACHFNtME").addEventListener("change", function() {
  var correct = (Math.abs(this.value - 1.5596104694623694) <= 1.0e-8);
  var msgBox = document.getElementById('ACHFNtME_message');
    if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_ACHFNtME")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_ACHFNtME")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

});

</script>


<h4>Question</h4>
<p>Use <code>find_zero</code> to find the one root of <code>x^5 &#43; x - 1</code>. First plot to get an estimate.</p>


<form class="mx-2 my-3" name='WeaveQuestion' data-id='8K0104yD' data-controltype=''>
  <div class='form-group '>
    <div class='controls'>
      <div class="form-floating input-group" id="controls_8K0104yD">
        <div style="padding-top: 5px">
    <div class="row">
  <span style="width:90%">
    <input id="8K0104yD" type="number" class="form-control" placeholder="Numeric answer">
  </span>
  <span style="width:10%">
  </span>
</div>

    
        </div>
      </div>
      <div id='8K0104yD_message' style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text='text/javascript'>
document.getElementById("8K0104yD").addEventListener("change", function() {
  var correct = (Math.abs(this.value - 1.1673039782614187) <= 1.0e-8);
  var msgBox = document.getElementById('8K0104yD_message');
    if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_8K0104yD")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_8K0104yD")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

});

</script>


<h4>Question</h4>
<p>Let <span class="math">$f(x) = 5/\sin(x) + 8/\cos(x)$</span>, Starting at <span class="math">$x=\pi/4$</span>, use <code>find_zero</code> to find a root of the derivative of <span class="math">$f(x)$</span> given by <code>f&#39;</code>.</p>


<form class="mx-2 my-3" name='WeaveQuestion' data-id='qjxlnW6y' data-controltype=''>
  <div class='form-group '>
    <div class='controls'>
      <div class="form-floating input-group" id="controls_qjxlnW6y">
        <div style="padding-top: 5px">
    <div class="row">
  <span style="width:90%">
    <input id="qjxlnW6y" type="number" class="form-control" placeholder="Numeric answer">
  </span>
  <span style="width:10%">
  </span>
</div>

    
        </div>
      </div>
      <div id='qjxlnW6y_message' style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text='text/javascript'>
document.getElementById("qjxlnW6y").addEventListener("change", function() {
  var correct = (Math.abs(this.value - 0.7073827215431158) <= 1.0e-8);
  var msgBox = document.getElementById('qjxlnW6y_message');
    if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_qjxlnW6y")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_qjxlnW6y")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

});

</script>


<h4>Question</h4>
<p>The tangent line of <code>f</code> at <code>c</code> can be computed by</p>


<pre class='hljl'>
<span class='hljl-nf'>tangent</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>c</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>-&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>c</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-oB'>&#39;</span><span class='hljl-p'>(</span><span class='hljl-n'>c</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-n'>c</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
tangent &#40;generic function with 1 method&#41;
</pre>


<p>Let <span class="math">$f(x) = x^2 - 3x + 5$</span>. Use <code>find_zero</code> to find the intersection point of the tangent line at <span class="math">$1$</span> and the tangent line at <span class="math">$3$</span>. Where does this happen?</p>
<p>&#40;Hint, apply <code>find_zero</code> to <code>h&#40;x&#41; &#61; tangent&#40;f, 1&#41;&#40;x&#41; -  tangent&#40;f, 3&#41;&#40;x&#41;</code> starting at 1.&#41;</p>


<form class="mx-2 my-3" name='WeaveQuestion' data-id='qMjjXskd' data-controltype=''>
  <div class='form-group '>
    <div class='controls'>
      <div class="form-floating input-group" id="controls_qMjjXskd">
        <div style="padding-top: 5px">
    <div class="row">
  <span style="width:90%">
    <input id="qMjjXskd" type="number" class="form-control" placeholder="Numeric answer">
  </span>
  <span style="width:10%">
  </span>
</div>

    
        </div>
      </div>
      <div id='qMjjXskd_message' style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text='text/javascript'>
document.getElementById("qMjjXskd").addEventListener("change", function() {
  var correct = (Math.abs(this.value - 2.0) <= 1.0e-8);
  var msgBox = document.getElementById('qMjjXskd_message');
    if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_qMjjXskd")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_qMjjXskd")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

});

</script>


<h2>Various issues with Newton&#39;s method</h2>
<p>As great as Newton&#39;s method is, it won&#39;t always work for various reasons, some of which are described in the following. Here is what you need to keep in mind. Newton&#39;s method works well if</p>
<ul>
<li><p>The zero is a simple root – that is of multiplicity 1</p>
</li>
<li><p>The magnitude, <span class="math">$|f'(x)|$</span>, is not too small &#40;If the tangent line is nearly flat, the next guess is far from the previous&#41;</p>
</li>
<li><p>The magnitude, <span class="math">$|f''(x)|$</span>, is not too big &#40;function doesn&#39;t have so much curve that the tangent line is a poor approximation&#41;</p>
</li>
<li><p>The initial guess is not to far from a zero</p>
</li>
</ul>
<p>The above points come from the following formula which you can find in many texts.</p>
<p class="math">\[
\Delta x_{i+1} = \frac{f' '(\alpha)}{f'(\alpha)}(\Delta x_i)^2 + \text{error}
\]</p>
<p>which is valid when <span class="math">$f(x)$</span> satisfies <span class="math">$f(\alpha) = 0$</span>, the third derivative exists near <span class="math">$\alpha$</span>, and <span class="math">$\Delta x_i = x_i - \alpha$</span> is the error between the zero and the <span class="math">$i$</span> th estimate.  When the derivative at <span class="math">$\alpha$</span> is non-zero, the error is basically a constant times <span class="math">$\Delta x_i^2$</span>. This is interpreted as saying there is quadratic convergence in the error, as the next one is related to the previous one squared.</p>
<p>Now we look at some cases where the above three points do not hold.</p>
<h3>The initial guess is no where near the end results</h3>
<p>Let <span class="math">$f(x) = \sin(x) - x/4$</span> and <span class="math">$x_0 = 2\pi$</span>. This value is deliberately a poor choice:</p>


<pre class='hljl'>
<span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>sin</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-oB'>/</span><span class='hljl-ni'>4</span><span class='hljl-t'>
</span><span class='hljl-nf'>fp</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>cos</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-oB'>/</span><span class='hljl-ni'>4</span><span class='hljl-t'>
</span><span class='hljl-nf'>newton</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>fp</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>2</span><span class='hljl-n'>pi</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>verbose</span><span class='hljl-oB'>=</span><span class='hljl-kc'>true</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
Results of univariate zero finding:

* Converged to: -2.4745767873698292
* Algorithm: Roots.Newton&#40;&#41;
* iterations: 22
* function evaluations ≈ 44
* stopped as |f&#40;x_n&#41;| ≤ max&#40;δ, |x|⋅ϵ&#41; using δ &#61; atol, ϵ &#61; rtol

Trace:
x₁ &#61; 6.2831853071795862,	 fx₁ &#61; -1.5707963267948968
x₂ &#61; 8.3775804095727828,	 fx₂ &#61; -1.2283696986087573
x₃ &#61; 6.7397541447611076,	 fx₃ &#61; -1.2440675381169748
x₄ &#61; 8.6608848638032576,	 fx₄ &#61; -1.4734831418043957
x₅ &#61; 7.145187249669843,	 fx₅ &#61; -1.0271496267351363
x₆ &#61; 9.7071751202999792,	 fx₆ &#61; -2.7054524356150202
x₇ &#61; 7.471984835940221,	 fx₇ &#61; -0.94007407756685935
x₈ &#61; 15.128927112593999,	 fx₈ &#61; -3.2350143158338276
x₉ &#61; 12.152806896784888,	 fx₉ &#61; -3.4400768736735046
x₁₀ &#61; 17.320458159488304,	 fx₁₀ &#61; -5.3292452806856589
x₁₁ &#61; -8.262352431213138,	 fx₁₁ &#61; 1.1478190870135017
x₁₂ &#61; -6.4886031684043539,	 fx₁₂ &#61; 1.4181745383583302
x₁₃ &#61; -8.4340373897987018,	 fx₁₃ &#61; 1.2720772543609207
x₁₄ &#61; -6.8400965825145015,	 fx₁₄ &#61; 1.1814574151203185
x₁₅ &#61; -8.8128360727706223,	 fx₁₅ &#61; 1.6287509745643769
x₁₆ &#61; -7.2885505274866542,	 fx₁₆ &#61; 0.97777993115770767
x₁₇ &#61; -10.709994864744841,	 fx₁₇ &#61; 3.6369972987156078
x₁₈ &#61; -3.8698495348738184,	 fx₁₈ &#61; 1.6330320788034982
x₁₉ &#61; -2.230811533392838,	 fx₁₉ &#61; -0.23228002463635777
x₂₀ &#61; -2.499925490828641,	 fx₂₀ &#61; 0.026449537717568972
x₂₁ &#61; -2.4747617934295065,	 fx₂₁ &#61; 0.00019161604875239657
x₂₂ &#61; -2.474576797589688,	 fx₂₂ &#61; 1.058441445600522e-08
x₂₃ &#61; -2.4745767873698292,	 fx₂₃ &#61; 2.2204460492503131e-16


-2.4745767873698292
</pre>


<p>Though <code>julia</code> makes this happen fast, it will take more than  20 steps before converging and the answer is no where near the guess. This trace might show why</p>
<p><img src="figures/newton/newton-way-off.png" alt="Newton, way off" /></p>
<h4>Question</h4>
<p>When <span class="math">$|f'(x)|$</span> is too close to <span class="math">$0$</span>, the path can jump alot. In the figure, what was the longest jump?</p>


<form class="mx-2 my-3" name='WeaveQuestion' data-id='D1UZcQRM' data-controltype=''>
  <div class='form-group '>
    <div class='controls'>
      <div class="form-floating input-group" id="controls_D1UZcQRM">
        <div style="padding-top: 5px">
    <div class="form-check">
  <label>
    <input class="form-check-input" type="radio" name="radio_D1UZcQRM"
              id="radio_D1UZcQRM_1" value="1">
      <span = class="label-body">
        From about -12 to -3
      </span>
    </input>
  </label>
</div>
<div class="form-check">
  <label>
    <input class="form-check-input" type="radio" name="radio_D1UZcQRM"
              id="radio_D1UZcQRM_2" value="2">
      <span = class="label-body">
        From about 0 to -5
      </span>
    </input>
  </label>
</div>
<div class="form-check">
  <label>
    <input class="form-check-input" type="radio" name="radio_D1UZcQRM"
              id="radio_D1UZcQRM_3" value="3">
      <span = class="label-body">
        From about 17 to -10
      </span>
    </input>
  </label>
</div>

    
        </div>
      </div>
      <div id='D1UZcQRM_message' style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text='text/javascript'>
document.querySelectorAll('input[name="radio_D1UZcQRM"]').forEach(function(rb) {
rb.addEventListener("change", function() {
    var correct = rb.value == 3;
    var msgBox = document.getElementById('D1UZcQRM_message');
      if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_D1UZcQRM")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_D1UZcQRM")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

})});

</script>


<h4>Question</h4>
<p>The method did find a zero, but the initial guess was nowhere near the final zero. How close was the closest zero to the initial guess?</p>


<form class="mx-2 my-3" name='WeaveQuestion' data-id='IQcFi7Fm' data-controltype=''>
  <div class='form-group '>
    <div class='controls'>
      <div class="form-floating input-group" id="controls_IQcFi7Fm">
        <div style="padding-top: 5px">
    <div class="form-check">
  <label>
    <input class="form-check-input" type="radio" name="radio_IQcFi7Fm"
              id="radio_IQcFi7Fm_1" value="1">
      <span = class="label-body">
        <code>2pi</code>
      </span>
    </input>
  </label>
</div>
<div class="form-check">
  <label>
    <input class="form-check-input" type="radio" name="radio_IQcFi7Fm"
              id="radio_IQcFi7Fm_2" value="2">
      <span = class="label-body">
        <code>8.75</code>
      </span>
    </input>
  </label>
</div>
<div class="form-check">
  <label>
    <input class="form-check-input" type="radio" name="radio_IQcFi7Fm"
              id="radio_IQcFi7Fm_3" value="3">
      <span = class="label-body">
        <code>3.8</code>
      </span>
    </input>
  </label>
</div>

    
        </div>
      </div>
      <div id='IQcFi7Fm_message' style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text='text/javascript'>
document.querySelectorAll('input[name="radio_IQcFi7Fm"]').forEach(function(rb) {
rb.addEventListener("change", function() {
    var correct = rb.value == 3;
    var msgBox = document.getElementById('IQcFi7Fm_message');
      if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_IQcFi7Fm")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_IQcFi7Fm")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

})});

</script>


<h3>Function has a poor shape</h3>
<p>Let <span class="math">$f(x) = x^{1/3}$</span>. We know the root is 0. Let&#39;s see what happens if we use Newton&#39;s method. We have to be careful though as <code>julia</code> thinks that cube roots of negative numbers &#40;via <code>x^&#40;1/3&#41;</code> are <code>NaN</code>, not a number. &#40;You can avoid this, by making your number complex, e.g. <code>x &#43; 0*im</code>, but then the real answer is not given as an answer. It is just one of three and not the chosen one.&#41;</p>
<p>So we define our function using <code>julia</code>&#39;s <code>cbrt</code> function, which works as we desire for negative numbers, as follows:</p>


<pre class='hljl'>
<span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>cbrt</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>xstar</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>newton</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>2</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
Roots.ConvergenceFailed&#40;&quot;Algorithm failed to converge&quot;&#41;
</pre>


<p>Still an issue. Why?</p>
<h4>Question</h4>
<p>Despite all our care with the derivative, the method did not converge in <span class="math">$200$</span> steps. Can you see why from this trace?</p>
<p><img src="figures/newton/newton-cubic.png" alt="Newton, cubic" /> &#96;&#96;&#96;</p>


<form class="mx-2 my-3" name='WeaveQuestion' data-id='aFw8Evyb' data-controltype=''>
  <div class='form-group '>
    <div class='controls'>
      <div class="form-floating input-group" id="controls_aFw8Evyb">
        <div style="padding-top: 5px">
    <div class="form-check">
  <label>
    <input class="form-check-input" type="radio" name="radio_aFw8Evyb"
              id="radio_aFw8Evyb_1" value="1">
      <span = class="label-body">
        <code>|f&#39;&#40;x&#41;|</code> gets too small
      </span>
    </input>
  </label>
</div>
<div class="form-check">
  <label>
    <input class="form-check-input" type="radio" name="radio_aFw8Evyb"
              id="radio_aFw8Evyb_2" value="2">
      <span = class="label-body">
        <code>|f&#39;&#39;&#40;x&#41;|</code> gets too big at 0
      </span>
    </input>
  </label>
</div>
<div class="form-check">
  <label>
    <input class="form-check-input" type="radio" name="radio_aFw8Evyb"
              id="radio_aFw8Evyb_3" value="3">
      <span = class="label-body">
        Initial guess is too far from a zero.
      </span>
    </input>
  </label>
</div>

    
        </div>
      </div>
      <div id='aFw8Evyb_message' style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text='text/javascript'>
document.querySelectorAll('input[name="radio_aFw8Evyb"]').forEach(function(rb) {
rb.addEventListener("change", function() {
    var correct = rb.value == 2;
    var msgBox = document.getElementById('aFw8Evyb_message');
      if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_aFw8Evyb")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_aFw8Evyb")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

})});

</script>


<h4>Questions &lt;small&gt;Solve by hand&lt;/small&gt;</h4>
<p>For <span class="math">$f(x) = x^{1/3}$</span>, simplify the expression by hand:</p>
<p class="math">\[
x - f(x)/f'(x)
\]</p>
<p>What do you get?</p>


<form class="mx-2 my-3" name='WeaveQuestion' data-id='g0Ym9tqC' data-controltype=''>
  <div class='form-group '>
    <div class='controls'>
      <div class="form-floating input-group" id="controls_g0Ym9tqC">
        <div style="padding-top: 5px">
    <div class="form-check">
  <label>
    <input class="form-check-input" type="radio" name="radio_g0Ym9tqC"
              id="radio_g0Ym9tqC_1" value="1">
      <span = class="label-body">
        <code>x - 3/x</code>
      </span>
    </input>
  </label>
</div>
<div class="form-check">
  <label>
    <input class="form-check-input" type="radio" name="radio_g0Ym9tqC"
              id="radio_g0Ym9tqC_2" value="2">
      <span = class="label-body">
        <code>-2x</code>
      </span>
    </input>
  </label>
</div>
<div class="form-check">
  <label>
    <input class="form-check-input" type="radio" name="radio_g0Ym9tqC"
              id="radio_g0Ym9tqC_3" value="3">
      <span = class="label-body">
        <code>x - &#40;1/3&#41;x^&#123;-1/3&#125;</code>
      </span>
    </input>
  </label>
</div>

    
        </div>
      </div>
      <div id='g0Ym9tqC_message' style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text='text/javascript'>
document.querySelectorAll('input[name="radio_g0Ym9tqC"]').forEach(function(rb) {
rb.addEventListener("change", function() {
    var correct = rb.value == 2;
    var msgBox = document.getElementById('g0Ym9tqC_message');
      if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_g0Ym9tqC")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_g0Ym9tqC")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

})});

</script>


<h4>Question</h4>
<p>Apply Newton&#39;s method to <span class="math">$f(x) = (x-2)^7 \cdot (x-3) \cdot (x-4)$</span> starting at 1.9981. The algorithm does not converge to 2 – an obvious root. From a plot of <span class="math">$f(x)$</span> explain why not:</p>


<form class="mx-2 my-3" name='WeaveQuestion' data-id='7oVwkxgI' data-controltype=''>
  <div class='form-group '>
    <div class='controls'>
      <div class="form-floating input-group" id="controls_7oVwkxgI">
        <div style="padding-top: 5px">
    <div class="form-check">
  <label>
    <input class="form-check-input" type="radio" name="radio_7oVwkxgI"
              id="radio_7oVwkxgI_1" value="1">
      <span = class="label-body">
        <code>|f&#39;&#40;x&#41;|</code> gets too small
      </span>
    </input>
  </label>
</div>
<div class="form-check">
  <label>
    <input class="form-check-input" type="radio" name="radio_7oVwkxgI"
              id="radio_7oVwkxgI_2" value="2">
      <span = class="label-body">
        <code>|f&#39;&#39;&#40;x&#41;|</code> gets too big at 0
      </span>
    </input>
  </label>
</div>
<div class="form-check">
  <label>
    <input class="form-check-input" type="radio" name="radio_7oVwkxgI"
              id="radio_7oVwkxgI_3" value="3">
      <span = class="label-body">
        Initial guess is to far from a zero.
      </span>
    </input>
  </label>
</div>

    
        </div>
      </div>
      <div id='7oVwkxgI_message' style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text='text/javascript'>
document.querySelectorAll('input[name="radio_7oVwkxgI"]').forEach(function(rb) {
rb.addEventListener("change", function() {
    var correct = rb.value == 1;
    var msgBox = document.getElementById('7oVwkxgI_message');
      if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_7oVwkxgI")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_7oVwkxgI")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

})});

</script>


<h4>Question</h4>
<p>The function <code>f&#40;x&#41; &#61; atan&#40;x&#41;</code> is a strictly increasing function with one zero, <span class="math">$0$</span>. Yet it can pose problems with Newton&#39;s method. For which values of <span class="math">$x$</span> does Newton&#39;s method converge:</p>


<form class="mx-2 my-3" name='WeaveQuestion' data-id='KHkWzPDE' data-controltype=''>
  <div class='form-group '>
    <div class='controls'>
      <div class="form-floating input-group" id="controls_KHkWzPDE">
        <div style="padding-top: 5px">
    <div class="form-check">
  <label>
    <input class="form-check-input" type="radio" name="radio_KHkWzPDE"
              id="radio_KHkWzPDE_1" value="1">
      <span = class="label-body">
        For each of &#36;1&#36;, &#36;2&#36; and &#36;\pi&#36;
      </span>
    </input>
  </label>
</div>
<div class="form-check">
  <label>
    <input class="form-check-input" type="radio" name="radio_KHkWzPDE"
              id="radio_KHkWzPDE_2" value="2">
      <span = class="label-body">
        For &#36;1&#36; and &#36;2&#36; but not &#36;\pi&#36;
      </span>
    </input>
  </label>
</div>
<div class="form-check">
  <label>
    <input class="form-check-input" type="radio" name="radio_KHkWzPDE"
              id="radio_KHkWzPDE_3" value="3">
      <span = class="label-body">
        For &#36;1&#36; but not &#36;2&#36; or &#36;\pi&#36;
      </span>
    </input>
  </label>
</div>
<div class="form-check">
  <label>
    <input class="form-check-input" type="radio" name="radio_KHkWzPDE"
              id="radio_KHkWzPDE_4" value="4">
      <span = class="label-body">
        For none of  &#36;1&#36;, &#36;2&#36; and &#36;\pi&#36;
      </span>
    </input>
  </label>
</div>

    
        </div>
      </div>
      <div id='KHkWzPDE_message' style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text='text/javascript'>
document.querySelectorAll('input[name="radio_KHkWzPDE"]').forEach(function(rb) {
rb.addEventListener("change", function() {
    var correct = rb.value == 3;
    var msgBox = document.getElementById('KHkWzPDE_message');
      if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_KHkWzPDE")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_KHkWzPDE")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

})});

</script>


<h3>Cycles</h3>
<p>Sometimes, the process can cycle even for reasonable functions.</p>
<h4>Question</h4>
<p>Let <span class="math">$f(x) = x^3 - 5x$</span>. Starting with <span class="math">$x_0=1$</span>, compute three steps of Newton&#39;s method. What are the terms in the series produced?</p>


<form class="mx-2 my-3" name='WeaveQuestion' data-id='1Pjd1rzR' data-controltype=''>
  <div class='form-group '>
    <div class='controls'>
      <div class="form-floating input-group" id="controls_1Pjd1rzR">
        <div style="padding-top: 5px">
    <div class="form-check">
  <label>
    <input class="form-check-input" type="radio" name="radio_1Pjd1rzR"
              id="radio_1Pjd1rzR_1" value="1">
      <span = class="label-body">
        &#36;-1.0, 0.6666666666666667, -0.2850952524822228, ...&#36;
      </span>
    </input>
  </label>
</div>
<div class="form-check">
  <label>
    <input class="form-check-input" type="radio" name="radio_1Pjd1rzR"
              id="radio_1Pjd1rzR_2" value="2">
      <span = class="label-body">
        &#36;1, -2, -4,  ...&#36;
      </span>
    </input>
  </label>
</div>
<div class="form-check">
  <label>
    <input class="form-check-input" type="radio" name="radio_1Pjd1rzR"
              id="radio_1Pjd1rzR_3" value="3">
      <span = class="label-body">
        &#36;-1.0, 1.0, -1.0, ...&#36;
      </span>
    </input>
  </label>
</div>

    
        </div>
      </div>
      <div id='1Pjd1rzR_message' style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text='text/javascript'>
document.querySelectorAll('input[name="radio_1Pjd1rzR"]').forEach(function(rb) {
rb.addEventListener("change", function() {
    var correct = rb.value == 3;
    var msgBox = document.getElementById('1Pjd1rzR_message');
      if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_1Pjd1rzR")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_1Pjd1rzR")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

})});

</script>


<h4>Question &lt;small&gt;Always cycles...&lt;/small&gt;</h4>
<p>Here is a pathological example where the value always cycles no matter where you start unless you start at <span class="math">$0$</span>.</p>
<p>Let <span class="math">$f(x) = \sqrt{|x|}$</span>. This is the one-sided square root function turned into an even function. We could also have defined it by:</p>


<pre class='hljl'>
<span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>&gt;=</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-t'> </span><span class='hljl-oB'>?</span><span class='hljl-t'> </span><span class='hljl-nf'>sqrt</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>:</span><span class='hljl-t'> </span><span class='hljl-nf'>sqrt</span><span class='hljl-p'>(</span><span class='hljl-oB'>-</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
f &#40;generic function with 1 method&#41;
</pre>


<p>where the ternary operator <code>a ? b : c</code> looks at <code>a</code> and if true will execute <code>b</code> otherwise <code>c</code>.</p>
<p>This makes it easier to write the derivative of the function in <code>Julia</code>:</p>
<pre><code>fp&#40;x&#41; &#61; x &gt;&#61;0 ? &#40;1/2&#41;*sqrt&#40;x&#41;/x : -&#40;1/2&#41;*sqrt&#40;-x&#41;/&#40;-x&#41;</code></pre>
<p>To see what happens when using Newton&#39;s method, lets start at <span class="math">$x=2$</span></p>


<pre class='hljl'>
<span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>2</span><span class='hljl-t'>
</span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-oB'>/</span><span class='hljl-nf'>fp</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-oB'>/</span><span class='hljl-nf'>fp</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-oB'>/</span><span class='hljl-nf'>fp</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
2.886111254399766
</pre>


<p>Try again with <span class="math">$x=3.0$</span> What sequence do you get:</p>


<form class="mx-2 my-3" name='WeaveQuestion' data-id='A9cvwLXe' data-controltype=''>
  <div class='form-group '>
    <div class='controls'>
      <div class="form-floating input-group" id="controls_A9cvwLXe">
        <div style="padding-top: 5px">
    <div class="form-check">
  <label>
    <input class="form-check-input" type="radio" name="radio_A9cvwLXe"
              id="radio_A9cvwLXe_1" value="1">
      <span = class="label-body">
        &#36;2, -2.0, 2.0, -2.0&#36;
      </span>
    </input>
  </label>
</div>
<div class="form-check">
  <label>
    <input class="form-check-input" type="radio" name="radio_A9cvwLXe"
              id="radio_A9cvwLXe_2" value="2">
      <span = class="label-body">
        &#36;3, -3.0, 3.0, -3.0, ...&#36;
      </span>
    </input>
  </label>
</div>
<div class="form-check">
  <label>
    <input class="form-check-input" type="radio" name="radio_A9cvwLXe"
              id="radio_A9cvwLXe_3" value="3">
      <span = class="label-body">
        &#36;3, 2.0, 1.0, 0.0, -1.0, ...&#36;
      </span>
    </input>
  </label>
</div>

    
        </div>
      </div>
      <div id='A9cvwLXe_message' style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text='text/javascript'>
document.querySelectorAll('input[name="radio_A9cvwLXe"]').forEach(function(rb) {
rb.addEventListener("change", function() {
    var correct = rb.value == 2;
    var msgBox = document.getElementById('A9cvwLXe_message');
      if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_A9cvwLXe")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_A9cvwLXe")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

})});

</script>



        <HR/>
        <div class="footer">
          <p>
            Published from <a href="newton.jmd">newton.jmd</a>
            using <a href="http://github.com/JunoLab/Weave.jl">Weave.jl</a> v0.10.10 on 2022-06-21.
          </p>
        </div>
      </div>
    </div>
  </div>
</BODY>

</HTML>
